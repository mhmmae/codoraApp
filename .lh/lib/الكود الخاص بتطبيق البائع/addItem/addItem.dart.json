{
    "sourceFile": "lib/الكود الخاص بتطبيق البائع/addItem/addItem.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1753181638995,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1753181638995,
            "name": "Commit-0",
            "content": "import 'dart:typed_data';\nimport 'package:flutter/material.dart';\nimport 'package:flutter_screenutil/flutter_screenutil.dart';\nimport 'package:get/get.dart';\nimport 'package:image_picker/image_picker.dart';\n\nimport 'addNewItem/addNewItem.dart';\nimport 'addQuantity/search_existing_product_page.dart';\nimport 'barcodeOperations/barcode_operations_page.dart';\nimport 'editProducts/products_list_for_edit_page.dart';\n\nclass ImageController extends GetxController {\n  Rx<Uint8List?> selectedImage = Rx<Uint8List?>(\n    null,\n  ); // الصورة القابلة للمراقبة\n  RxBool isAnimating = false.obs; // للتحكم بالانميشن\n  void handleImage(ImageSource source, String type) async {\n    final ImagePicker imagePicker = ImagePicker();\n    final XFile? imageX = await imagePicker.pickImage(source: source);\n\n    if (imageX != null) {\n      selectedImage.value = await imageX.readAsBytes(); // تعيين الصورة المختارة\n      isAnimating.value = true; // تفعيل الانميشن\n\n      // الانتقال إلى الصفحة الجديدة مع الصورة\n      Get.to(() => ViewImage(uint8list: selectedImage.value!, TypeItem: type));\n    } else {\n      Get.snackbar(\n        \"خطأ\",\n        \"لم يتم اختيار صورة!\",\n        backgroundColor: Colors.red,\n        colorText: Colors.white,\n      );\n    }\n  }\n\n  void resetSelection() {\n    selectedImage.value = null; // إعادة تعيين الصورة\n    isAnimating.value = false; // إيقاف الانميشن\n  }\n}\n\nclass AddItem extends StatelessWidget {\n  const AddItem({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    final ImageController controller = Get.put(ImageController());\n\n    return Scaffold(\n      appBar: AppBar(\n        title: const Text('إضافة المنتجات'),\n        leading: GestureDetector(\n          onTap: () => resetImageOnBack(context),\n          child: const Icon(Icons.arrow_back),\n        ),\n        backgroundColor: Colors.blueAccent,\n        foregroundColor: Colors.black12,\n        elevation: 2,\n      ),\n      body: Container(\n        decoration: BoxDecoration(\n          gradient: LinearGradient(\n            begin: Alignment.topCenter,\n            end: Alignment.bottomCenter,\n            colors: [Colors.blueAccent.withOpacity(0.1), Colors.white],\n          ),\n        ),\n        child: SingleChildScrollView(\n          padding: EdgeInsets.all(24.w),\n          child: Column(\n            crossAxisAlignment: CrossAxisAlignment.start,\n            children: [\n              SizedBox(height: 20.h),\n\n              // البطاقات\n              LayoutBuilder(\n                builder: (context, constraints) {\n                  // تحديد عدد الأعمدة بناءً على عرض الشاشة\n                  final crossAxisCount = constraints.maxWidth > 600 ? 3 : 2;\n\n                  return GridView.count(\n                    shrinkWrap: true,\n                    physics: const NeverScrollableScrollPhysics(),\n                    crossAxisCount: crossAxisCount,\n                    crossAxisSpacing: 16.w,\n                    mainAxisSpacing: 16.h,\n                    childAspectRatio: 0.9,\n                    children: [\n                      // بطاقة إضافة منتج عادي\n                      _buildProductCard(\n                        context: context,\n                        icon: Icons.add_shopping_cart,\n                        title: 'إضافة منتج جديد',\n                        subtitle: 'أضف منتج عادي إلى المتجر',\n                        color: Colors.blueAccent,\n                        onTap: () => _showImagePickerSheet(controller, \"Item\"),\n                      ),\n\n                      // بطاقة إضافة كمية لمنتج موجود\n                      _buildProductCard(\n                        context: context,\n                        icon: Icons.add_circle_outline,\n                        title: 'إضافة كمية منتج موجود',\n                        subtitle: 'أضف كمية لمنتج موجود في المخزن',\n                        color: Colors.green,\n                        onTap: () => _navigateToAddQuantity(),\n                      ),\n\n                      // بطاقة طباعة الباركود الجديدة\n                      _buildProductCard(\n                        context: context,\n                        icon: Icons.qr_code,\n                        title: 'طباعة وإدارة الباركود',\n                        subtitle: 'طباعة أو إضافة باركودات للمنتجات',\n                        color: Colors.purple,\n                        onTap: () => _navigateToBarcodeOperations(),\n                      ),\n\n                      // بطاقة تعديل المنتجات\n                      _buildProductCard(\n                        context: context,\n                        icon: Icons.edit,\n                        title: 'تعديل المنتجات',\n                        subtitle: 'تعديل معلومات المنتجات الموجودة',\n                        color: Colors.amber,\n                        onTap: () => _navigateToEditProducts(),\n                      ),\n\n                      // بطاقة إضافية للمستقبل\n                      _buildProductCard(\n                        context: context,\n                        icon: Icons.analytics,\n                        title: 'تقارير المنتجات',\n                        subtitle: 'عرض تقارير وإحصائيات المنتجات',\n                        color: Colors.orange,\n                        onTap: () => _showComingSoon(),\n                      ),\n                    ],\n                  );\n                },\n              ),\n            ],\n          ),\n        ),\n      ),\n    );\n  }\n\n  // بناء بطاقة المنتج الجميلة\n  Widget _buildProductCard({\n    required BuildContext context,\n    required IconData icon,\n    required String title,\n    required String subtitle,\n    required Color color,\n    required VoidCallback onTap,\n  }) {\n    return Card(\n      elevation: 8,\n      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16.r)),\n      child: InkWell(\n        onTap: onTap,\n        borderRadius: BorderRadius.circular(16.r),\n        child: Container(\n          decoration: BoxDecoration(\n            borderRadius: BorderRadius.circular(16.r),\n            gradient: LinearGradient(\n              begin: Alignment.topLeft,\n              end: Alignment.bottomRight,\n              colors: [color.withOpacity(0.1), Colors.white],\n            ),\n          ),\n          child: Padding(\n            padding: EdgeInsets.all(10.w), // تقليل المسافة الداخلية أكثر\n            child: Column(\n              mainAxisAlignment: MainAxisAlignment.center,\n              children: [\n                // أيقونة مع تأثير دائري - حجم أصغر\n                Container(\n                  width: 50.w,\n                  height: 45.h,\n                  decoration: BoxDecoration(\n                    color: color.withOpacity(0.2),\n                    shape: BoxShape.circle,\n                    boxShadow: [\n                      BoxShadow(\n                        color: color.withOpacity(0.3),\n                        blurRadius: 8.r,\n                        spreadRadius: 1.r,\n                        offset: Offset(0, 3.h),\n                      ),\n                    ],\n                  ),\n                  child: Icon(icon, size: 20.sp, color: color),\n                ),\n                SizedBox(height: 6.h),\n\n                // العنوان - حجم خط أصغر\n                Text(\n                  title,\n                  style: TextStyle(\n                    fontSize: 12.sp,\n                    fontWeight: FontWeight.bold,\n                    color: Colors.grey[800],\n                  ),\n                  textAlign: TextAlign.center,\n                  maxLines: 2,\n                  overflow: TextOverflow.ellipsis,\n                ),\n                SizedBox(height: 4.h),\n\n                // النص الفرعي - حجم خط أصغر\n                Text(\n                  subtitle,\n                  style: TextStyle(fontSize: 10.sp, color: Colors.grey[600]),\n                  textAlign: TextAlign.center,\n                  maxLines: 2,\n                  overflow: TextOverflow.ellipsis,\n                ),\n                SizedBox(height: 8.h),\n\n                // مؤشر النقر - حجم أصغر\n                Container(\n                  padding: EdgeInsets.symmetric(\n                    horizontal: 10.w,\n                    vertical: 4.h,\n                  ),\n                  decoration: BoxDecoration(\n                    gradient: LinearGradient(\n                      colors: [color, color.withOpacity(0.8)],\n                    ),\n                    borderRadius: BorderRadius.circular(12.r),\n                    boxShadow: [\n                      BoxShadow(\n                        color: color.withOpacity(0.4),\n                        blurRadius: 4.r,\n                        offset: Offset(0, 1.h),\n                      ),\n                    ],\n                  ),\n                  child: Text(\n                    'ابدأ الآن',\n                    style: TextStyle(\n                      color: Colors.white,\n                      fontWeight: FontWeight.w600,\n                      fontSize: 10.sp,\n                    ),\n                  ),\n                ),\n              ],\n            ),\n          ),\n        ),\n      ),\n    );\n  }\n\n  void resetImageOnBack(BuildContext context) {\n    Navigator.pop(context);\n    Get.find<ImageController>().resetSelection();\n  }\n\n  void _navigateToAddQuantity() {\n    Get.to(() => const SearchExistingProductPage());\n  }\n\n  void _navigateToBarcodeOperations() {\n    Get.to(() => const BarcodeOperationsPage());\n  }\n\n  void _navigateToEditProducts() {\n    Get.to(() => const ProductsListForEditPage());\n  }\n\n  void _showImagePickerSheet(ImageController controller, String type) {\n    showModalBottomSheet(\n      context: Get.context!,\n      shape: RoundedRectangleBorder(\n        borderRadius: BorderRadius.vertical(top: Radius.circular(20.r)),\n      ),\n      builder: (context) {\n        return Container(\n          height: 300.h,\n          decoration: BoxDecoration(\n            borderRadius: BorderRadius.vertical(top: Radius.circular(20.r)),\n          ),\n          child: Column(\n            children: [\n              // مقبض الإغلاق\n              Container(\n                width: 50.w,\n                height: 5.h,\n                margin: EdgeInsets.symmetric(vertical: 10.h),\n                decoration: BoxDecoration(\n                  color: Colors.grey[300],\n                  borderRadius: BorderRadius.circular(10.r),\n                ),\n              ),\n\n              Text(\n                'اختر مصدر الصورة',\n                style: TextStyle(fontSize: 18.sp, fontWeight: FontWeight.bold),\n              ),\n              SizedBox(height: 20.h),\n\n              ListTile(\n                leading: Container(\n                  padding: EdgeInsets.all(8.w),\n                  decoration: BoxDecoration(\n                    color: Colors.blue.withOpacity(0.1),\n                    borderRadius: BorderRadius.circular(8.r),\n                  ),\n                  child: Icon(Icons.camera, color: Colors.blue, size: 24.sp),\n                ),\n                title: Text(\"التقاط صورة\", style: TextStyle(fontSize: 16.sp)),\n                subtitle: Text(\n                  \"استخدام الكاميرا\",\n                  style: TextStyle(fontSize: 12.sp),\n                ),\n                onTap: () {\n                  Navigator.pop(context);\n                  controller.handleImage(ImageSource.camera, type);\n                },\n              ),\n\n              ListTile(\n                leading: Container(\n                  padding: EdgeInsets.all(8.w),\n                  decoration: BoxDecoration(\n                    color: Colors.green.withOpacity(0.1),\n                    borderRadius: BorderRadius.circular(8.r),\n                  ),\n                  child: Icon(Icons.photo, color: Colors.green, size: 24.sp),\n                ),\n                title: Text(\n                  \"اختيار من المعرض\",\n                  style: TextStyle(fontSize: 16.sp),\n                ),\n                subtitle: Text(\n                  \"من الصور المحفوظة\",\n                  style: TextStyle(fontSize: 12.sp),\n                ),\n                onTap: () {\n                  Navigator.pop(context);\n                  controller.handleImage(ImageSource.gallery, type);\n                },\n              ),\n            ],\n          ),\n        );\n      },\n    );\n  }\n\n  void _showComingSoon() {\n    Get.snackbar(\n      \"قريباً\",\n      \"هذه الميزة قريباً\",\n      backgroundColor: Colors.grey,\n      colorText: Colors.white,\n    );\n  }\n}\n"
        }
    ]
}