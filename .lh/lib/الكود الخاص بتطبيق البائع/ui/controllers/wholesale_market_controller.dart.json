{
    "sourceFile": "lib/Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø®Ø§Øµ Ø¨ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø§Ø¦Ø¹/ui/controllers/wholesale_market_controller.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1752570376680,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1752662835578,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -108,8 +108,11 @@\n           if (store.shopName.isNotEmpty && store.sellerType == 'wholesale') {\n             stores.add(store);\n             if (store.shopCategories.isNotEmpty) {\n               categoriesSet.addAll(store.shopCategories);\n+              debugPrint(\n+                'ğŸ“¦ ÙØ¦Ø§Øª Ù…ØªØ¬Ø± \"${store.shopName}\": ${store.shopCategories}',\n+              );\n             }\n             debugPrint('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…ØªØ¬Ø±: ${store.shopName}');\n           }\n         } catch (e) {\n@@ -123,8 +126,10 @@\n       allStores.value = stores;\n       filteredStores.value = stores;\n       categories.value = categoriesSet.toList()..sort();\n \n+      debugPrint('ğŸ·ï¸ Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©: ${categoriesSet.toList()}');\n+\n       // Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ù†ÙŠÙ…ÙŠØ´Ù†\n       animationController.forward();\n \n       debugPrint('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${stores.length} Ù…ØªØ¬Ø± Ø¬Ù…Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­');\n@@ -137,8 +142,14 @@\n   }\n \n   /// ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©\n   void applyFilters() {\n+    debugPrint('ğŸ” Ø¨Ø¯Ø¡ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ±...');\n+    debugPrint('ğŸ“Š Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØªØ§Ø¬Ø± Ø§Ù„ÙƒÙ„ÙŠ: ${allStores.length}');\n+    debugPrint('ğŸ”¤ Ù†Øµ Ø§Ù„Ø¨Ø­Ø«: \"${searchText.value}\"');\n+    debugPrint('ğŸ·ï¸ Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©: \"${selectedCategory.value}\"');\n+    debugPrint('ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø®ØªØ§Ø±: \"${selectedLocation.value}\"');\n+\n     List<SellerModel> filtered = List.from(allStores);\n \n     // ÙÙ„ØªØ± Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù†ØµÙŠ\n     if (searchText.value.isNotEmpty) {\n@@ -153,16 +164,26 @@\n                 (store.shopDescription?.toLowerCase().contains(query) ??\n                     false) ||\n                 (store.shopAddressText?.toLowerCase().contains(query) ?? false);\n           }).toList();\n+      debugPrint('ğŸ“ Ø¨Ø¹Ø¯ ÙÙ„ØªØ± Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù†ØµÙŠ: ${filtered.length} Ù…ØªØ¬Ø±');\n     }\n \n     // ÙÙ„ØªØ± Ø§Ù„ÙØ¦Ø©\n     if (selectedCategory.value.isNotEmpty) {\n       filtered =\n-          filtered\n-              .where((store) => store.shopCategories == selectedCategory.value)\n-              .toList();\n+          filtered.where((store) {\n+            bool matches = store.shopCategories.contains(\n+              selectedCategory.value,\n+            );\n+            if (matches) {\n+              debugPrint(\n+                'âœ… Ù…ØªØ¬Ø± \"${store.shopName}\" ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙØ¦Ø© \"${selectedCategory.value}\"',\n+              );\n+            }\n+            return matches;\n+          }).toList();\n+      debugPrint('ğŸ·ï¸ Ø¨Ø¹Ø¯ ÙÙ„ØªØ± Ø§Ù„ÙØ¦Ø©: ${filtered.length} Ù…ØªØ¬Ø±');\n     }\n \n     // ÙÙ„ØªØ± Ø§Ù„Ù…ÙˆÙ‚Ø¹\n     if (selectedLocation.value.isNotEmpty) {\n@@ -173,16 +194,17 @@\n                     store.shopAddressText?.contains(selectedLocation.value) ??\n                     false,\n               )\n               .toList();\n+      debugPrint('ğŸ“ Ø¨Ø¹Ø¯ ÙÙ„ØªØ± Ø§Ù„Ù…ÙˆÙ‚Ø¹: ${filtered.length} Ù…ØªØ¬Ø±');\n     }\n \n     // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù†ØªØ§Ø¦Ø¬\n     _sortStores(filtered);\n \n     filteredStores.value = filtered;\n \n-    debugPrint('ğŸ” ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ± - Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ${filtered.length}');\n+    debugPrint('ğŸ” Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: ${filtered.length} Ù…ØªØ¬Ø±');\n   }\n \n   void _sortStores(List<SellerModel> stores) {\n     switch (sortBy.value) {\n@@ -209,9 +231,15 @@\n     showFilters.value = !showFilters.value;\n   }\n \n   void selectCategory(String category) {\n+    debugPrint('ğŸ·ï¸ ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ÙØ¦Ø©: \"$category\"');\n+    debugPrint('ğŸ·ï¸ Ø§Ù„ÙØ¦Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©: \"${selectedCategory.value}\"');\n+\n     selectedCategory.value = category == selectedCategory.value ? '' : category;\n+\n+    debugPrint('ğŸ·ï¸ Ø§Ù„ÙØ¦Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©: \"${selectedCategory.value}\"');\n+\n     applyFilters();\n   }\n \n   void setSortBy(String sort) {\n"
                }
            ],
            "date": 1752570376680,
            "name": "Commit-0",
            "content": "import 'package:get/get.dart';\nimport 'package:cloud_firestore/cloud_firestore.dart';\nimport 'package:flutter/material.dart';\nimport 'dart:async';\nimport '../../../Model/SellerModel.dart';\nimport 'package:url_launcher/url_launcher.dart';\n\nclass WholesaleMarketController extends GetxController\n    with GetSingleTickerProviderStateMixin {\n  final FirebaseFirestore _firestore = FirebaseFirestore.instance;\n\n  // Animation Controllers\n  late AnimationController animationController;\n  late Animation<double> fadeAnimation;\n  late Animation<Offset> slideAnimation;\n\n  // Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…ØªØ§Ø¬Ø±\n  final RxList<SellerModel> allStores = <SellerModel>[].obs;\n  final RxList<SellerModel> filteredStores = <SellerModel>[].obs;\n  final RxList<String> categories = <String>[].obs;\n\n  // Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙˆØ§Ù„Ø§Ù†ÙŠÙ…ÙŠØ´Ù†\n  final RxBool isLoading = false.obs;\n  final RxBool isSearching = false.obs;\n  final RxBool showFilters = false.obs;\n\n  // Ù†Øµ Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ÙÙ„Ø§ØªØ±\n  final RxString searchText = ''.obs;\n  final RxString selectedCategory = ''.obs;\n  final RxString selectedLocation = ''.obs;\n  final RxString sortBy = 'name'.obs; // name, rating, newest\n\n  // Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ø±Ø¶\n  final RxBool isGridView = false.obs;\n  final RxInt selectedStoreIndex = (-1).obs;\n\n  // Ù…ÙØ§ØªÙŠØ­ Ø§Ù„ØªØ­ÙƒÙ…\n  final TextEditingController searchController = TextEditingController();\n  final FocusNode searchFocusNode = FocusNode();\n\n  @override\n  void onInit() {\n    super.onInit();\n    _initializeAnimations();\n    loadWholesaleStores();\n    _setupSearchListener();\n  }\n\n  void _initializeAnimations() {\n    animationController = AnimationController(\n      duration: const Duration(milliseconds: 800),\n      vsync: this,\n    );\n\n    fadeAnimation = Tween<double>(begin: 0.0, end: 1.0).animate(\n      CurvedAnimation(parent: animationController, curve: Curves.easeInOut),\n    );\n\n    slideAnimation = Tween<Offset>(\n      begin: const Offset(0, 0.3),\n      end: Offset.zero,\n    ).animate(\n      CurvedAnimation(parent: animationController, curve: Curves.easeOutBack),\n    );\n  }\n\n  void _setupSearchListener() {\n    searchController.addListener(() {\n      if (searchController.text != searchText.value) {\n        searchText.value = searchController.text;\n        _debounceSearch();\n      }\n    });\n  }\n\n  Timer? _debounceTimer;\n  void _debounceSearch() {\n    _debounceTimer?.cancel();\n    _debounceTimer = Timer(const Duration(milliseconds: 300), () {\n      applyFilters();\n    });\n  }\n\n  /// ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ù…ØªØ§Ø¬Ø± Ø§Ù„Ø¬Ù…Ù„Ø© Ù…Ù† Firebase\n  Future<void> loadWholesaleStores() async {\n    try {\n      isLoading.value = true;\n\n      debugPrint('ğŸ”„ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ù…ØªØ§Ø¬Ø± Ø§Ù„Ø¬Ù…Ù„Ø©...');\n\n      final QuerySnapshot querySnapshot =\n          await _firestore\n              .collection('Sellercodora')\n              .where('sellerType', isEqualTo: 'wholesale')\n              .where('isActiveBySeller', isEqualTo: true)\n              .get();\n\n      debugPrint('ğŸ“Š ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${querySnapshot.docs.length} Ù…ØªØ¬Ø± Ø¬Ù…Ù„Ø©');\n\n      final List<SellerModel> stores = [];\n      final Set<String> categoriesSet = <String>{};\n\n      for (var doc in querySnapshot.docs) {\n        try {\n          final data = doc.data() as Map<String, dynamic>;\n          final store = SellerModel.fromMap(data, doc.id);\n\n          if (store.shopName.isNotEmpty && store.sellerType == 'wholesale') {\n            stores.add(store);\n            if (store.shopCategories.isNotEmpty) {\n              categoriesSet.addAll(store.shopCategories);\n            }\n            debugPrint('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…ØªØ¬Ø±: ${store.shopName}');\n          }\n        } catch (e) {\n          debugPrint('âŒ Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© ÙˆØ«ÙŠÙ‚Ø© ${doc.id}: $e');\n        }\n      }\n\n      // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…ØªØ§Ø¬Ø±\n      _sortStores(stores);\n\n      allStores.value = stores;\n      filteredStores.value = stores;\n      categories.value = categoriesSet.toList()..sort();\n\n      // Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ù†ÙŠÙ…ÙŠØ´Ù†\n      animationController.forward();\n\n      debugPrint('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${stores.length} Ù…ØªØ¬Ø± Ø¬Ù…Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­');\n    } catch (e) {\n      debugPrint('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…ØªØ§Ø¬Ø± Ø§Ù„Ø¬Ù…Ù„Ø©: $e');\n      _showErrorSnackbar('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ØªØ§Ø¬Ø±');\n    } finally {\n      isLoading.value = false;\n    }\n  }\n\n  /// ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©\n  void applyFilters() {\n    List<SellerModel> filtered = List.from(allStores);\n\n    // ÙÙ„ØªØ± Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù†ØµÙŠ\n    if (searchText.value.isNotEmpty) {\n      filtered =\n          filtered.where((store) {\n            final query = searchText.value.toLowerCase();\n            return store.shopName.toLowerCase().contains(query) ||\n                store.sellerName.toLowerCase().contains(query) ||\n                store.shopCategories.any(\n                  (category) => category.toLowerCase().contains(query),\n                ) ||\n                (store.shopDescription?.toLowerCase().contains(query) ??\n                    false) ||\n                (store.shopAddressText?.toLowerCase().contains(query) ?? false);\n          }).toList();\n    }\n\n    // ÙÙ„ØªØ± Ø§Ù„ÙØ¦Ø©\n    if (selectedCategory.value.isNotEmpty) {\n      filtered =\n          filtered\n              .where((store) => store.shopCategories == selectedCategory.value)\n              .toList();\n    }\n\n    // ÙÙ„ØªØ± Ø§Ù„Ù…ÙˆÙ‚Ø¹\n    if (selectedLocation.value.isNotEmpty) {\n      filtered =\n          filtered\n              .where(\n                (store) =>\n                    store.shopAddressText?.contains(selectedLocation.value) ??\n                    false,\n              )\n              .toList();\n    }\n\n    // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù†ØªØ§Ø¦Ø¬\n    _sortStores(filtered);\n\n    filteredStores.value = filtered;\n\n    debugPrint('ğŸ” ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ± - Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ${filtered.length}');\n  }\n\n  void _sortStores(List<SellerModel> stores) {\n    switch (sortBy.value) {\n      case 'name':\n        stores.sort((a, b) => a.shopName.compareTo(b.shopName));\n        break;\n      case 'category':\n        stores.sort((a, b) {\n          final categoryA =\n              a.shopCategories.isNotEmpty ? a.shopCategories.first : '';\n          final categoryB =\n              b.shopCategories.isNotEmpty ? b.shopCategories.first : '';\n          return categoryA.compareTo(categoryB);\n        });\n        break;\n      case 'newest':\n        // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªÙˆÙØ±Ø§Ù‹\n        break;\n    }\n  }\n\n  // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ÙÙ„Ø§ØªØ±\n  void toggleFilters() {\n    showFilters.value = !showFilters.value;\n  }\n\n  void selectCategory(String category) {\n    selectedCategory.value = category == selectedCategory.value ? '' : category;\n    applyFilters();\n  }\n\n  void setSortBy(String sort) {\n    sortBy.value = sort;\n    applyFilters();\n  }\n\n  void toggleViewMode() {\n    isGridView.value = !isGridView.value;\n  }\n\n  void clearFilters() {\n    searchController.clear();\n    searchText.value = '';\n    selectedCategory.value = '';\n    selectedLocation.value = '';\n    sortBy.value = 'name';\n    applyFilters();\n  }\n\n  // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø§Ù„Ù…ØªØ§Ø¬Ø±\n  void selectStore(int index) {\n    selectedStoreIndex.value = index;\n  }\n\n  Future<void> callStore(String phoneNumber) async {\n    final url = Uri.parse('tel:$phoneNumber');\n    if (await canLaunchUrl(url)) {\n      await launchUrl(url);\n    } else {\n      _showErrorSnackbar('Ù„Ø§ ÙŠÙ…ÙƒÙ† ÙØªØ­ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù‡Ø§ØªÙ');\n    }\n  }\n\n  Future<void> openLocation(String? address) async {\n    if (address == null || address.isEmpty) {\n      _showErrorSnackbar('Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ØºÙŠØ± Ù…ØªÙˆÙØ±');\n      return;\n    }\n\n    final url = Uri.parse(\n      'https://maps.google.com/?q=${Uri.encodeComponent(address)}',\n    );\n    if (await canLaunchUrl(url)) {\n      await launchUrl(url, mode: LaunchMode.externalApplication);\n    } else {\n      _showErrorSnackbar('Ù„Ø§ ÙŠÙ…ÙƒÙ† ÙØªØ­ Ø§Ù„Ø®Ø±Ø§Ø¦Ø·');\n    }\n  }\n\n  void _showErrorSnackbar(String message) {\n    Get.snackbar(\n      'Ø®Ø·Ø£',\n      message,\n      snackPosition: SnackPosition.BOTTOM,\n      backgroundColor: Colors.red.withOpacity(0.1),\n      colorText: Colors.red[800],\n      duration: const Duration(seconds: 3),\n      margin: const EdgeInsets.all(16),\n      borderRadius: 12,\n    );\n  }\n\n  // Getters\n  int get storesCount => allStores.length;\n  int get filteredStoresCount => filteredStores.length;\n  bool get hasFilters =>\n      searchText.value.isNotEmpty ||\n      selectedCategory.value.isNotEmpty ||\n      selectedLocation.value.isNotEmpty;\n\n  @override\n  Future<void> refresh() async {\n    await loadWholesaleStores();\n  }\n\n  @override\n  void onClose() {\n    animationController.dispose();\n    searchController.dispose();\n    searchFocusNode.dispose();\n    _debounceTimer?.cancel();\n    super.onClose();\n    debugPrint('ğŸ§¹ ØªÙ… ØªÙ†Ø¸ÙŠÙ WholesaleMarketController');\n  }\n}\n"
        }
    ]
}