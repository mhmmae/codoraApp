{
    "sourceFile": "lib/الكود الخاص بتطبيق البائع/ui/pages/sales_details_page.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1752704601213,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1752706986350,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,19 +12,21 @@\n   const SalesDetailsPage({super.key});\n \n   @override\n   Widget build(BuildContext context) {\n-    final SalesAnalyticsController controller = Get.put(SalesAnalyticsController());\n+    final SalesAnalyticsController controller = Get.put(\n+      SalesAnalyticsController(),\n+    );\n     \n+    // متغير لحالة إظهار/إخفاء ملخص المبيعات والفلاتر\n+    final RxBool showSummaryAndFilters = false.obs;\n+\n     return Scaffold(\n       backgroundColor: const Color(0xFFF8F9FA),\n       appBar: AppBar(\n         title: const Text(\n           'تفاصيل المبيعات',\n-          style: TextStyle(\n-            fontWeight: FontWeight.bold,\n-            color: Colors.white,\n-          ),\n+          style: TextStyle(fontWeight: FontWeight.bold, color: Colors.white),\n         ),\n         backgroundColor: const Color(0xFF2E7D32),\n         elevation: 0,\n         actions: [\n@@ -32,12 +34,16 @@\n             icon: const Icon(Icons.people, color: Colors.white),\n             onPressed: () => Get.to(() => const TopCustomersPage()),\n             tooltip: 'أفضل العملاء',\n           ),\n-          IconButton(\n-            icon: const Icon(Icons.refresh, color: Colors.white),\n-            onPressed: () => controller.refreshSalesData(),\n-          ),\n+          Obx(() => IconButton(\n+            icon: Icon(\n+              showSummaryAndFilters.value ? Icons.visibility_off : Icons.analytics,\n+              color: Colors.white,\n+            ),\n+            onPressed: () => showSummaryAndFilters.toggle(),\n+            tooltip: showSummaryAndFilters.value ? 'إخفاء الملخص' : 'إظهار الملخص',\n+          )),\n         ],\n       ),\n       body: Obx(() {\n         if (controller.isLoading.value) {\n@@ -52,25 +58,18 @@\n           return Center(\n             child: Column(\n               mainAxisAlignment: MainAxisAlignment.center,\n               children: [\n-                Icon(\n-                  Icons.error_outline,\n-                  size: 64.sp,\n-                  color: Colors.red,\n-                ),\n+                Icon(Icons.error_outline, size: 64.sp, color: Colors.red),\n                 SizedBox(height: 16.h),\n                 Text(\n                   controller.errorMessage.value,\n-                  style: TextStyle(\n-                    fontSize: 16.sp,\n-                    color: Colors.red,\n-                  ),\n+                  style: TextStyle(fontSize: 16.sp, color: Colors.red),\n                   textAlign: TextAlign.center,\n                 ),\n                 SizedBox(height: 16.h),\n                 ElevatedButton(\n-                  onPressed: () => controller.refreshSalesData(),\n+                  onPressed: () => controller.loadSalesForPeriod(controller.selectedPeriod.value),\n                   child: const Text('إعادة المحاولة'),\n                 ),\n               ],\n             ),\n@@ -82,16 +81,26 @@\n             padding: EdgeInsets.all(16.w),\n             child: Column(\n               crossAxisAlignment: CrossAxisAlignment.start,\n               children: [\n-                // ملخص المبيعات\n-                _buildSalesSummaryCard(controller),\n-                SizedBox(height: 20.h),\n-                \n-                // فلاتر الفترة الزمنية\n-                _buildPeriodFilters(controller),\n-                SizedBox(height: 20.h),\n-                \n+                // ملخص المبيعات وفلاتر الفترة الزمنية (مخفية افتراضياً)\n+                Obx(() {\n+                  if (!showSummaryAndFilters.value) {\n+                    return const SizedBox.shrink();\n+                  }\n+                  return Column(\n+                    children: [\n+                      // ملخص المبيعات\n+                      _buildSalesSummaryCard(controller),\n+                      SizedBox(height: 20.h),\n+                      \n+                      // فلاتر الفترة الزمنية\n+                      _buildPeriodFilters(controller),\n+                      SizedBox(height: 20.h),\n+                    ],\n+                  );\n+                }),\n+\n                 // قائمة المبيعات التفصيلية\n                 _buildSalesDetailsList(controller),\n               ],\n             ),\n@@ -120,13 +129,9 @@\n           crossAxisAlignment: CrossAxisAlignment.start,\n           children: [\n             Row(\n               children: [\n-                Icon(\n-                  Icons.trending_up,\n-                  color: Colors.white,\n-                  size: 24.sp,\n-                ),\n+                Icon(Icons.trending_up, color: Colors.white, size: 24.sp),\n                 SizedBox(width: 8.w),\n                 Text(\n                   'ملخص المبيعات - ${_getPeriodTitle(controller.selectedPeriod.value)}',\n                   style: TextStyle(\n@@ -253,44 +258,67 @@\n             SizedBox(height: 12.h),\n             Wrap(\n               spacing: 8.w,\n               runSpacing: 8.h,\n-              children: periods.map((period) {\n-                final isSelected = controller.selectedPeriod.value == period['key'];\n-                return GestureDetector(\n-                  onTap: () => controller.loadSalesForPeriod(period['key'] as String),\n-                  child: Container(\n-                    padding: EdgeInsets.symmetric(horizontal: 16.w, vertical: 8.h),\n-                    decoration: BoxDecoration(\n-                      color: isSelected ? const Color(0xFF2E7D32) : Colors.grey[100],\n-                      borderRadius: BorderRadius.circular(20.r),\n-                      border: Border.all(\n-                        color: isSelected ? const Color(0xFF2E7D32) : Colors.grey[300]!,\n-                        width: 1,\n-                      ),\n-                    ),\n-                    child: Row(\n-                      mainAxisSize: MainAxisSize.min,\n-                      children: [\n-                        Icon(\n-                          period['icon'] as IconData,\n-                          size: 16.sp,\n-                          color: isSelected ? Colors.white : const Color(0xFF2E7D32),\n+              children:\n+                  periods.map((period) {\n+                    final isSelected =\n+                        controller.selectedPeriod.value == period['key'];\n+                    return GestureDetector(\n+                      onTap:\n+                          () => controller.loadSalesForPeriod(\n+                            period['key'] as String,\n+                          ),\n+                      child: Container(\n+                        padding: EdgeInsets.symmetric(\n+                          horizontal: 16.w,\n+                          vertical: 8.h,\n                         ),\n-                        SizedBox(width: 4.w),\n-                        Text(\n-                          period['title'] as String,\n-                          style: TextStyle(\n-                            fontSize: 12.sp,\n-                            fontWeight: isSelected ? FontWeight.bold : FontWeight.normal,\n-                            color: isSelected ? Colors.white : const Color(0xFF2E7D32),\n+                        decoration: BoxDecoration(\n+                          color:\n+                              isSelected\n+                                  ? const Color(0xFF2E7D32)\n+                                  : Colors.grey[100],\n+                          borderRadius: BorderRadius.circular(20.r),\n+                          border: Border.all(\n+                            color:\n+                                isSelected\n+                                    ? const Color(0xFF2E7D32)\n+                                    : Colors.grey[300]!,\n+                            width: 1,\n                           ),\n                         ),\n-                      ],\n-                    ),\n-                  ),\n-                );\n-              }).toList(),\n+                        child: Row(\n+                          mainAxisSize: MainAxisSize.min,\n+                          children: [\n+                            Icon(\n+                              period['icon'] as IconData,\n+                              size: 16.sp,\n+                              color:\n+                                  isSelected\n+                                      ? Colors.white\n+                                      : const Color(0xFF2E7D32),\n+                            ),\n+                            SizedBox(width: 4.w),\n+                            Text(\n+                              period['title'] as String,\n+                              style: TextStyle(\n+                                fontSize: 12.sp,\n+                                fontWeight:\n+                                    isSelected\n+                                        ? FontWeight.bold\n+                                        : FontWeight.normal,\n+                                color:\n+                                    isSelected\n+                                        ? Colors.white\n+                                        : const Color(0xFF2E7D32),\n+                              ),\n+                            ),\n+                          ],\n+                        ),\n+                      ),\n+                    );\n+                  }).toList(),\n             ),\n           ],\n         ),\n       ),\n@@ -303,18 +331,16 @@\n \n     if (sales.isEmpty) {\n       return Card(\n         elevation: 4,\n-        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12.r)),\n+        shape: RoundedRectangleBorder(\n+          borderRadius: BorderRadius.circular(12.r),\n+        ),\n         child: Container(\n           padding: EdgeInsets.all(40.w),\n           child: Column(\n             children: [\n-              Icon(\n-                Icons.inbox_outlined,\n-                size: 64.sp,\n-                color: Colors.grey[400],\n-              ),\n+              Icon(Icons.inbox_outlined, size: 64.sp, color: Colors.grey[400]),\n               SizedBox(height: 16.h),\n               Text(\n                 'لا توجد مبيعات في الفترة المحددة',\n                 style: TextStyle(\n@@ -325,12 +351,9 @@\n               ),\n               SizedBox(height: 8.h),\n               Text(\n                 'ابدأ ببيع منتجاتك لرؤية التفاصيل هنا',\n-                style: TextStyle(\n-                  fontSize: 14.sp,\n-                  color: Colors.grey[500],\n-                ),\n+                style: TextStyle(fontSize: 14.sp, color: Colors.grey[500]),\n                 textAlign: TextAlign.center,\n               ),\n             ],\n           ),\n@@ -381,32 +404,42 @@\n               Row(\n                 children: [\n                   GestureDetector(\n                     onTap: () {\n-                      Get.to(() => CustomerDetailsPage(\n-                        customerId: sale.buyerId,\n-                        customerName: sale.buyerName,\n-                      ));\n+                      Get.to(\n+                        () => CustomerDetailsPage(\n+                          customerId: sale.buyerId,\n+                          customerName: sale.buyerName,\n+                        ),\n+                      );\n                     },\n                     child: CircleAvatar(\n                       radius: 24.r,\n-                      backgroundImage: sale.buyerImageUrl != null\n-                          ? NetworkImage(sale.buyerImageUrl!)\n-                          : null,\n+                      backgroundImage:\n+                          sale.buyerImageUrl != null\n+                              ? NetworkImage(sale.buyerImageUrl!)\n+                              : null,\n                       backgroundColor: const Color(0xFF2E7D32),\n-                      child: sale.buyerImageUrl == null\n-                          ? Icon(Icons.person, color: Colors.white, size: 24.sp)\n-                          : null,\n+                      child:\n+                          sale.buyerImageUrl == null\n+                              ? Icon(\n+                                Icons.person,\n+                                color: Colors.white,\n+                                size: 24.sp,\n+                              )\n+                              : null,\n                     ),\n                   ),\n                   SizedBox(width: 12.w),\n                   Expanded(\n                     child: GestureDetector(\n                       onTap: () {\n-                        Get.to(() => CustomerDetailsPage(\n-                          customerId: sale.buyerId,\n-                          customerName: sale.buyerName,\n-                        ));\n+                        Get.to(\n+                          () => CustomerDetailsPage(\n+                            customerId: sale.buyerId,\n+                            customerName: sale.buyerName,\n+                          ),\n+                        );\n                       },\n                       child: Column(\n                         crossAxisAlignment: CrossAxisAlignment.start,\n                         children: [\n@@ -462,9 +495,9 @@\n                   ),\n                 ],\n               ),\n               SizedBox(height: 12.h),\n-              \n+\n               // معلومات المبيعات\n               Row(\n                 children: [\n                   Expanded(\n@@ -486,9 +519,9 @@\n                   ),\n                 ],\n               ),\n               SizedBox(height: 8.h),\n-              \n+\n               Row(\n                 children: [\n                   Expanded(\n                     child: _buildInfoChip(\n@@ -503,9 +536,9 @@\n                     child: _buildDeliveryStatusChip(sale.deliveryStatus),\n                   ),\n                 ],\n               ),\n-              \n+\n               // معلومات التوصيل إذا وجدت\n               if (sale.driverName != null) ...[\n                 SizedBox(height: 8.h),\n                 Container(\n@@ -515,9 +548,13 @@\n                     borderRadius: BorderRadius.circular(8.r),\n                   ),\n                   child: Row(\n                     children: [\n-                      Icon(Icons.delivery_dining, color: Colors.blue, size: 16.sp),\n+                      Icon(\n+                        Icons.delivery_dining,\n+                        color: Colors.blue,\n+                        size: 16.sp,\n+                      ),\n                       SizedBox(width: 4.w),\n                       Text(\n                         'عامل التوصيل: ${sale.driverName}',\n                         style: TextStyle(\n@@ -536,9 +573,14 @@\n     );\n   }\n \n   /// بناء شريحة المعلومات\n-  Widget _buildInfoChip(String title, String value, IconData icon, Color color) {\n+  Widget _buildInfoChip(\n+    String title,\n+    String value,\n+    IconData icon,\n+    Color color,\n+  ) {\n     return Container(\n       padding: EdgeInsets.symmetric(horizontal: 8.w, vertical: 6.h),\n       decoration: BoxDecoration(\n         color: color.withOpacity(0.1),\n@@ -554,12 +596,9 @@\n               SizedBox(width: 4.w),\n               Flexible(\n                 child: Text(\n                   title,\n-                  style: TextStyle(\n-                    fontSize: 10.sp,\n-                    color: color,\n-                  ),\n+                  style: TextStyle(fontSize: 10.sp, color: color),\n                   maxLines: 1,\n                   overflow: TextOverflow.ellipsis,\n                 ),\n               ),\n@@ -619,12 +658,9 @@\n               Icon(icon, color: color, size: 14.sp),\n               SizedBox(width: 4.w),\n               Text(\n                 'حالة التوصيل',\n-                style: TextStyle(\n-                  fontSize: 10.sp,\n-                  color: color,\n-                ),\n+                style: TextStyle(fontSize: 10.sp, color: color),\n               ),\n             ],\n           ),\n           SizedBox(height: 2.h),\n@@ -644,11 +680,9 @@\n   /// عرض تفاصيل المبيعة\n   void _showSaleDetails(SalesAnalyticsModel sale) {\n     Get.bottomSheet(\n       Container(\n-        constraints: BoxConstraints(\n-          maxHeight: Get.height * 0.8,\n-        ),\n+        constraints: BoxConstraints(maxHeight: Get.height * 0.8),\n         decoration: BoxDecoration(\n           color: Colors.white,\n           borderRadius: BorderRadius.only(\n             topLeft: Radius.circular(20.r),\n@@ -666,9 +700,9 @@\n                 color: Colors.grey[300],\n                 borderRadius: BorderRadius.circular(2.r),\n               ),\n             ),\n-            \n+\n             // العنوان\n             Padding(\n               padding: EdgeInsets.all(20.w),\n               child: Row(\n@@ -689,68 +723,91 @@\n                   ),\n                 ],\n               ),\n             ),\n-            \n+\n             // المحتوى\n             Expanded(\n               child: SingleChildScrollView(\n                 padding: EdgeInsets.symmetric(horizontal: 20.w),\n                 child: Column(\n                   crossAxisAlignment: CrossAxisAlignment.start,\n                   children: [\n                     // معلومات المشتري\n-                    _buildDetailSection(\n-                      'معلومات المشتري',\n-                      [\n-                        _buildDetailRow('الاسم', sale.buyerName),\n-                        if (sale.buyerPhoneNumber != null)\n-                          _buildDetailRow('رقم الهاتف', sale.buyerPhoneNumber!),\n-                        _buildDetailRow('تاريخ الطلب', DateFormat('dd/MM/yyyy HH:mm').format(sale.orderDate)),\n-                      ],\n-                    ),\n-                    \n+                    _buildDetailSection('معلومات المشتري', [\n+                      _buildDetailRow('الاسم', sale.buyerName),\n+                      if (sale.buyerPhoneNumber != null)\n+                        _buildDetailRow('رقم الهاتف', sale.buyerPhoneNumber!),\n+                      _buildDetailRow(\n+                        'تاريخ الطلب',\n+                        DateFormat('dd/MM/yyyy HH:mm').format(sale.orderDate),\n+                      ),\n+                    ]),\n+\n                     SizedBox(height: 20.h),\n-                    \n+\n                     // معلومات المالية\n-                    _buildDetailSection(\n-                      'المعلومات المالية',\n-                      [\n-                        _buildDetailRow('إجمالي المبلغ', '${NumberFormat('#,###').format(sale.totalAmount)} د.ع'),\n-                        _buildDetailRow('ربح البائع', '${NumberFormat('#,###').format(sale.sellerProfit)} د.ع'),\n-                        _buildDetailRow('هامش الربح', '${sale.profitMargin.toStringAsFixed(1)}%'),\n-                        if (sale.deliveryFee != null)\n-                          _buildDetailRow('رسوم التوصيل', '${NumberFormat('#,###').format(sale.deliveryFee)} د.ع'),\n-                        _buildDetailRow('صافي الربح', '${NumberFormat('#,###').format(sale.netProfit)} د.ع'),\n-                      ],\n-                    ),\n-                    \n+                    _buildDetailSection('المعلومات المالية', [\n+                      _buildDetailRow(\n+                        'إجمالي المبلغ',\n+                        '${NumberFormat('#,###').format(sale.totalAmount)} د.ع',\n+                      ),\n+                      _buildDetailRow(\n+                        'ربح البائع',\n+                        '${NumberFormat('#,###').format(sale.sellerProfit)} د.ع',\n+                      ),\n+                      _buildDetailRow(\n+                        'هامش الربح',\n+                        '${sale.profitMargin.toStringAsFixed(1)}%',\n+                      ),\n+                      if (sale.deliveryFee != null)\n+                        _buildDetailRow(\n+                          'رسوم التوصيل',\n+                          '${NumberFormat('#,###').format(sale.deliveryFee)} د.ع',\n+                        ),\n+                      _buildDetailRow(\n+                        'صافي الربح',\n+                        '${NumberFormat('#,###').format(sale.netProfit)} د.ع',\n+                      ),\n+                    ]),\n+\n                     SizedBox(height: 20.h),\n-                    \n+\n                     // معلومات التوصيل\n                     if (sale.driverName != null)\n-                      _buildDetailSection(\n-                        'معلومات التوصيل',\n-                        [\n-                          _buildDetailRow('حالة التوصيل', _getDeliveryStatusText(sale.deliveryStatus)),\n-                          _buildDetailRow('عامل التوصيل', sale.driverName!),\n-                          if (sale.driverPhoneNumber != null)\n-                            _buildDetailRow('هاتف السائق', sale.driverPhoneNumber!),\n-                          if (sale.deliveryDate != null)\n-                            _buildDetailRow('تاريخ التوصيل', DateFormat('dd/MM/yyyy HH:mm').format(sale.deliveryDate!)),\n-                          if (sale.deliveryAddress != null)\n-                            _buildDetailRow('عنوان التوصيل', sale.deliveryAddress!),\n-                        ],\n-                      ),\n-                    \n+                      _buildDetailSection('معلومات التوصيل', [\n+                        _buildDetailRow(\n+                          'حالة التوصيل',\n+                          _getDeliveryStatusText(sale.deliveryStatus),\n+                        ),\n+                        _buildDetailRow('عامل التوصيل', sale.driverName!),\n+                        if (sale.driverPhoneNumber != null)\n+                          _buildDetailRow(\n+                            'هاتف السائق',\n+                            sale.driverPhoneNumber!,\n+                          ),\n+                        if (sale.deliveryDate != null)\n+                          _buildDetailRow(\n+                            'تاريخ التوصيل',\n+                            DateFormat(\n+                              'dd/MM/yyyy HH:mm',\n+                            ).format(sale.deliveryDate!),\n+                          ),\n+                        if (sale.deliveryAddress != null)\n+                          _buildDetailRow(\n+                            'عنوان التوصيل',\n+                            sale.deliveryAddress!,\n+                          ),\n+                      ]),\n+\n                     SizedBox(height: 20.h),\n-                    \n+\n                     // قائمة المنتجات\n                     _buildDetailSection(\n                       'المنتجات (${sale.items.length})',\n                       sale.items.map((item) => _buildProductRow(item)).toList(),\n                     ),\n-                    \n+\n                     SizedBox(height: 20.h),\n                   ],\n                 ),\n               ),\n@@ -782,11 +839,9 @@\n             color: Colors.grey[50],\n             borderRadius: BorderRadius.circular(12.r),\n             border: Border.all(color: Colors.grey[200]!),\n           ),\n-          child: Column(\n-            children: children,\n-          ),\n+          child: Column(children: children),\n         ),\n       ],\n     );\n   }\n@@ -801,12 +856,9 @@\n           SizedBox(\n             width: 100.w,\n             child: Text(\n               '$label:',\n-              style: TextStyle(\n-                fontSize: 14.sp,\n-                color: Colors.grey[600],\n-              ),\n+              style: TextStyle(fontSize: 14.sp, color: Colors.grey[600]),\n             ),\n           ),\n           Expanded(\n             child: Text(\n@@ -841,21 +893,27 @@\n             height: 50.h,\n             decoration: BoxDecoration(\n               borderRadius: BorderRadius.circular(8.r),\n               color: Colors.grey[200],\n-              image: item.itemImageUrl != null\n-                  ? DecorationImage(\n-                      image: NetworkImage(item.itemImageUrl!),\n-                      fit: BoxFit.cover,\n+              image:\n+                  item.itemImageUrl != null\n+                      ? DecorationImage(\n+                        image: NetworkImage(item.itemImageUrl!),\n+                        fit: BoxFit.cover,\n+                      )\n+                      : null,\n+            ),\n+            child:\n+                item.itemImageUrl == null\n+                    ? Icon(\n+                      Icons.shopping_bag,\n+                      color: Colors.grey[400],\n+                      size: 24.sp,\n                     )\n-                  : null,\n-            ),\n-            child: item.itemImageUrl == null\n-                ? Icon(Icons.shopping_bag, color: Colors.grey[400], size: 24.sp)\n-                : null,\n+                    : null,\n           ),\n           SizedBox(width: 12.w),\n-          \n+\n           // تفاصيل المنتج\n           Expanded(\n             child: Column(\n               crossAxisAlignment: CrossAxisAlignment.start,\n"
                }
            ],
            "date": 1752704601213,
            "name": "Commit-0",
            "content": "import 'package:flutter/material.dart';\nimport 'package:flutter_screenutil/flutter_screenutil.dart';\nimport 'package:get/get.dart';\nimport 'package:intl/intl.dart';\nimport '../../controllers/sales_analytics_controller.dart';\nimport '../../../Model/sales_analytics_model.dart';\nimport 'customer_details_page.dart';\nimport 'top_customers_page.dart';\n\n/// صفحة تفاصيل المبيعات للبائع\nclass SalesDetailsPage extends StatelessWidget {\n  const SalesDetailsPage({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    final SalesAnalyticsController controller = Get.put(SalesAnalyticsController());\n    \n    return Scaffold(\n      backgroundColor: const Color(0xFFF8F9FA),\n      appBar: AppBar(\n        title: const Text(\n          'تفاصيل المبيعات',\n          style: TextStyle(\n            fontWeight: FontWeight.bold,\n            color: Colors.white,\n          ),\n        ),\n        backgroundColor: const Color(0xFF2E7D32),\n        elevation: 0,\n        actions: [\n          IconButton(\n            icon: const Icon(Icons.people, color: Colors.white),\n            onPressed: () => Get.to(() => const TopCustomersPage()),\n            tooltip: 'أفضل العملاء',\n          ),\n          IconButton(\n            icon: const Icon(Icons.refresh, color: Colors.white),\n            onPressed: () => controller.refreshSalesData(),\n          ),\n        ],\n      ),\n      body: Obx(() {\n        if (controller.isLoading.value) {\n          return const Center(\n            child: CircularProgressIndicator(\n              valueColor: AlwaysStoppedAnimation<Color>(Color(0xFF2E7D32)),\n            ),\n          );\n        }\n\n        if (controller.errorMessage.value.isNotEmpty) {\n          return Center(\n            child: Column(\n              mainAxisAlignment: MainAxisAlignment.center,\n              children: [\n                Icon(\n                  Icons.error_outline,\n                  size: 64.sp,\n                  color: Colors.red,\n                ),\n                SizedBox(height: 16.h),\n                Text(\n                  controller.errorMessage.value,\n                  style: TextStyle(\n                    fontSize: 16.sp,\n                    color: Colors.red,\n                  ),\n                  textAlign: TextAlign.center,\n                ),\n                SizedBox(height: 16.h),\n                ElevatedButton(\n                  onPressed: () => controller.refreshSalesData(),\n                  child: const Text('إعادة المحاولة'),\n                ),\n              ],\n            ),\n          );\n        }\n\n        return SingleChildScrollView(\n          child: Padding(\n            padding: EdgeInsets.all(16.w),\n            child: Column(\n              crossAxisAlignment: CrossAxisAlignment.start,\n              children: [\n                // ملخص المبيعات\n                _buildSalesSummaryCard(controller),\n                SizedBox(height: 20.h),\n                \n                // فلاتر الفترة الزمنية\n                _buildPeriodFilters(controller),\n                SizedBox(height: 20.h),\n                \n                // قائمة المبيعات التفصيلية\n                _buildSalesDetailsList(controller),\n              ],\n            ),\n          ),\n        );\n      }),\n    );\n  }\n\n  /// بناء بطاقة ملخص المبيعات\n  Widget _buildSalesSummaryCard(SalesAnalyticsController controller) {\n    return Card(\n      elevation: 8,\n      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16.r)),\n      child: Container(\n        padding: EdgeInsets.all(20.w),\n        decoration: BoxDecoration(\n          borderRadius: BorderRadius.circular(16.r),\n          gradient: const LinearGradient(\n            colors: [Color(0xFF2E7D32), Color(0xFF4CAF50)],\n            begin: Alignment.topLeft,\n            end: Alignment.bottomRight,\n          ),\n        ),\n        child: Column(\n          crossAxisAlignment: CrossAxisAlignment.start,\n          children: [\n            Row(\n              children: [\n                Icon(\n                  Icons.trending_up,\n                  color: Colors.white,\n                  size: 24.sp,\n                ),\n                SizedBox(width: 8.w),\n                Text(\n                  'ملخص المبيعات - ${_getPeriodTitle(controller.selectedPeriod.value)}',\n                  style: TextStyle(\n                    fontSize: 18.sp,\n                    fontWeight: FontWeight.bold,\n                    color: Colors.white,\n                  ),\n                ),\n              ],\n            ),\n            SizedBox(height: 20.h),\n            Row(\n              children: [\n                Expanded(\n                  child: _buildSummaryItem(\n                    'إجمالي المبيعات',\n                    '${NumberFormat('#,###').format(controller.currentPeriodRevenue)} د.ع',\n                    Icons.attach_money,\n                  ),\n                ),\n                SizedBox(width: 16.w),\n                Expanded(\n                  child: _buildSummaryItem(\n                    'صافي الربح',\n                    '${NumberFormat('#,###').format(controller.currentPeriodProfit)} د.ع',\n                    Icons.account_balance_wallet,\n                  ),\n                ),\n              ],\n            ),\n            SizedBox(height: 16.h),\n            Row(\n              children: [\n                Expanded(\n                  child: _buildSummaryItem(\n                    'عدد الطلبات',\n                    '${controller.currentSales.length}',\n                    Icons.shopping_cart,\n                  ),\n                ),\n                SizedBox(width: 16.w),\n                Expanded(\n                  child: _buildSummaryItem(\n                    'متوسط الطلب',\n                    '${NumberFormat('#,###').format(controller.averageOrderValue)} د.ع',\n                    Icons.calculate,\n                  ),\n                ),\n              ],\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n\n  /// بناء عنصر ملخص المبيعات\n  Widget _buildSummaryItem(String title, String value, IconData icon) {\n    return Container(\n      padding: EdgeInsets.all(12.w),\n      decoration: BoxDecoration(\n        color: Colors.white.withOpacity(0.2),\n        borderRadius: BorderRadius.circular(12.r),\n      ),\n      child: Column(\n        crossAxisAlignment: CrossAxisAlignment.start,\n        children: [\n          Row(\n            children: [\n              Icon(icon, color: Colors.white, size: 16.sp),\n              SizedBox(width: 4.w),\n              Expanded(\n                child: Text(\n                  title,\n                  style: TextStyle(\n                    fontSize: 12.sp,\n                    color: Colors.white.withOpacity(0.9),\n                  ),\n                  maxLines: 1,\n                  overflow: TextOverflow.ellipsis,\n                ),\n              ),\n            ],\n          ),\n          SizedBox(height: 4.h),\n          Text(\n            value,\n            style: TextStyle(\n              fontSize: 14.sp,\n              fontWeight: FontWeight.bold,\n              color: Colors.white,\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n\n  /// بناء فلاتر الفترة الزمنية\n  Widget _buildPeriodFilters(SalesAnalyticsController controller) {\n    final periods = [\n      {'key': 'today', 'title': 'اليوم', 'icon': Icons.today},\n      {'key': 'week', 'title': 'هذا الأسبوع', 'icon': Icons.date_range},\n      {'key': 'month', 'title': 'هذا الشهر', 'icon': Icons.calendar_month},\n      {'key': 'year', 'title': 'هذا العام', 'icon': Icons.calendar_today},\n    ];\n\n    return Card(\n      elevation: 4,\n      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12.r)),\n      child: Container(\n        padding: EdgeInsets.all(16.w),\n        child: Column(\n          crossAxisAlignment: CrossAxisAlignment.start,\n          children: [\n            Text(\n              'اختر الفترة الزمنية',\n              style: TextStyle(\n                fontSize: 16.sp,\n                fontWeight: FontWeight.bold,\n                color: const Color(0xFF2E7D32),\n              ),\n            ),\n            SizedBox(height: 12.h),\n            Wrap(\n              spacing: 8.w,\n              runSpacing: 8.h,\n              children: periods.map((period) {\n                final isSelected = controller.selectedPeriod.value == period['key'];\n                return GestureDetector(\n                  onTap: () => controller.loadSalesForPeriod(period['key'] as String),\n                  child: Container(\n                    padding: EdgeInsets.symmetric(horizontal: 16.w, vertical: 8.h),\n                    decoration: BoxDecoration(\n                      color: isSelected ? const Color(0xFF2E7D32) : Colors.grey[100],\n                      borderRadius: BorderRadius.circular(20.r),\n                      border: Border.all(\n                        color: isSelected ? const Color(0xFF2E7D32) : Colors.grey[300]!,\n                        width: 1,\n                      ),\n                    ),\n                    child: Row(\n                      mainAxisSize: MainAxisSize.min,\n                      children: [\n                        Icon(\n                          period['icon'] as IconData,\n                          size: 16.sp,\n                          color: isSelected ? Colors.white : const Color(0xFF2E7D32),\n                        ),\n                        SizedBox(width: 4.w),\n                        Text(\n                          period['title'] as String,\n                          style: TextStyle(\n                            fontSize: 12.sp,\n                            fontWeight: isSelected ? FontWeight.bold : FontWeight.normal,\n                            color: isSelected ? Colors.white : const Color(0xFF2E7D32),\n                          ),\n                        ),\n                      ],\n                    ),\n                  ),\n                );\n              }).toList(),\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n\n  /// بناء قائمة تفاصيل المبيعات\n  Widget _buildSalesDetailsList(SalesAnalyticsController controller) {\n    final sales = controller.currentSales;\n\n    if (sales.isEmpty) {\n      return Card(\n        elevation: 4,\n        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12.r)),\n        child: Container(\n          padding: EdgeInsets.all(40.w),\n          child: Column(\n            children: [\n              Icon(\n                Icons.inbox_outlined,\n                size: 64.sp,\n                color: Colors.grey[400],\n              ),\n              SizedBox(height: 16.h),\n              Text(\n                'لا توجد مبيعات في الفترة المحددة',\n                style: TextStyle(\n                  fontSize: 16.sp,\n                  color: Colors.grey[600],\n                  fontWeight: FontWeight.w500,\n                ),\n              ),\n              SizedBox(height: 8.h),\n              Text(\n                'ابدأ ببيع منتجاتك لرؤية التفاصيل هنا',\n                style: TextStyle(\n                  fontSize: 14.sp,\n                  color: Colors.grey[500],\n                ),\n                textAlign: TextAlign.center,\n              ),\n            ],\n          ),\n        ),\n      );\n    }\n\n    return Column(\n      crossAxisAlignment: CrossAxisAlignment.start,\n      children: [\n        Text(\n          'تفاصيل المبيعات (${sales.length} طلب)',\n          style: TextStyle(\n            fontSize: 18.sp,\n            fontWeight: FontWeight.bold,\n            color: const Color(0xFF2E7D32),\n          ),\n        ),\n        SizedBox(height: 12.h),\n        ListView.separated(\n          shrinkWrap: true,\n          physics: const NeverScrollableScrollPhysics(),\n          itemCount: sales.length,\n          separatorBuilder: (context, index) => SizedBox(height: 12.h),\n          itemBuilder: (context, index) {\n            final sale = sales[index];\n            return _buildSaleCard(sale);\n          },\n        ),\n      ],\n    );\n  }\n\n  /// بناء بطاقة مبيعة واحدة\n  Widget _buildSaleCard(SalesAnalyticsModel sale) {\n    return Card(\n      elevation: 4,\n      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12.r)),\n      child: InkWell(\n        onTap: () => _showSaleDetails(sale),\n        borderRadius: BorderRadius.circular(12.r),\n        child: Container(\n          padding: EdgeInsets.all(16.w),\n          child: Column(\n            crossAxisAlignment: CrossAxisAlignment.start,\n            children: [\n              // معلومات المشتري\n              Row(\n                children: [\n                  GestureDetector(\n                    onTap: () {\n                      Get.to(() => CustomerDetailsPage(\n                        customerId: sale.buyerId,\n                        customerName: sale.buyerName,\n                      ));\n                    },\n                    child: CircleAvatar(\n                      radius: 24.r,\n                      backgroundImage: sale.buyerImageUrl != null\n                          ? NetworkImage(sale.buyerImageUrl!)\n                          : null,\n                      backgroundColor: const Color(0xFF2E7D32),\n                      child: sale.buyerImageUrl == null\n                          ? Icon(Icons.person, color: Colors.white, size: 24.sp)\n                          : null,\n                    ),\n                  ),\n                  SizedBox(width: 12.w),\n                  Expanded(\n                    child: GestureDetector(\n                      onTap: () {\n                        Get.to(() => CustomerDetailsPage(\n                          customerId: sale.buyerId,\n                          customerName: sale.buyerName,\n                        ));\n                      },\n                      child: Column(\n                        crossAxisAlignment: CrossAxisAlignment.start,\n                        children: [\n                          Row(\n                            children: [\n                              Expanded(\n                                child: Text(\n                                  sale.buyerName,\n                                  style: TextStyle(\n                                    fontSize: 16.sp,\n                                    fontWeight: FontWeight.bold,\n                                    color: const Color(0xFF2E7D32),\n                                  ),\n                                ),\n                              ),\n                              Icon(\n                                Icons.arrow_forward_ios,\n                                size: 12.sp,\n                                color: Colors.grey[400],\n                              ),\n                            ],\n                          ),\n                          if (sale.buyerPhoneNumber != null)\n                            Text(\n                              sale.buyerPhoneNumber!,\n                              style: TextStyle(\n                                fontSize: 12.sp,\n                                color: Colors.grey[600],\n                              ),\n                            ),\n                        ],\n                      ),\n                    ),\n                  ),\n                  Column(\n                    crossAxisAlignment: CrossAxisAlignment.end,\n                    children: [\n                      Text(\n                        DateFormat('dd/MM/yyyy').format(sale.orderDate),\n                        style: TextStyle(\n                          fontSize: 12.sp,\n                          color: Colors.grey[600],\n                        ),\n                      ),\n                      Text(\n                        DateFormat('HH:mm').format(sale.orderDate),\n                        style: TextStyle(\n                          fontSize: 12.sp,\n                          color: Colors.grey[600],\n                        ),\n                      ),\n                    ],\n                  ),\n                ],\n              ),\n              SizedBox(height: 12.h),\n              \n              // معلومات المبيعات\n              Row(\n                children: [\n                  Expanded(\n                    child: _buildInfoChip(\n                      'إجمالي المبلغ',\n                      '${NumberFormat('#,###').format(sale.totalAmount)} د.ع',\n                      Icons.attach_money,\n                      const Color(0xFF1976D2),\n                    ),\n                  ),\n                  SizedBox(width: 8.w),\n                  Expanded(\n                    child: _buildInfoChip(\n                      'الربح',\n                      '${NumberFormat('#,###').format(sale.sellerProfit)} د.ع',\n                      Icons.trending_up,\n                      const Color(0xFF388E3C),\n                    ),\n                  ),\n                ],\n              ),\n              SizedBox(height: 8.h),\n              \n              Row(\n                children: [\n                  Expanded(\n                    child: _buildInfoChip(\n                      'عدد المنتجات',\n                      '${sale.items.length} منتج',\n                      Icons.inventory_2,\n                      const Color(0xFF7B1FA2),\n                    ),\n                  ),\n                  SizedBox(width: 8.w),\n                  Expanded(\n                    child: _buildDeliveryStatusChip(sale.deliveryStatus),\n                  ),\n                ],\n              ),\n              \n              // معلومات التوصيل إذا وجدت\n              if (sale.driverName != null) ...[\n                SizedBox(height: 8.h),\n                Container(\n                  padding: EdgeInsets.all(8.w),\n                  decoration: BoxDecoration(\n                    color: Colors.blue[50],\n                    borderRadius: BorderRadius.circular(8.r),\n                  ),\n                  child: Row(\n                    children: [\n                      Icon(Icons.delivery_dining, color: Colors.blue, size: 16.sp),\n                      SizedBox(width: 4.w),\n                      Text(\n                        'عامل التوصيل: ${sale.driverName}',\n                        style: TextStyle(\n                          fontSize: 12.sp,\n                          color: Colors.blue[800],\n                        ),\n                      ),\n                    ],\n                  ),\n                ),\n              ],\n            ],\n          ),\n        ),\n      ),\n    );\n  }\n\n  /// بناء شريحة المعلومات\n  Widget _buildInfoChip(String title, String value, IconData icon, Color color) {\n    return Container(\n      padding: EdgeInsets.symmetric(horizontal: 8.w, vertical: 6.h),\n      decoration: BoxDecoration(\n        color: color.withOpacity(0.1),\n        borderRadius: BorderRadius.circular(8.r),\n      ),\n      child: Column(\n        crossAxisAlignment: CrossAxisAlignment.center,\n        children: [\n          Row(\n            mainAxisAlignment: MainAxisAlignment.center,\n            children: [\n              Icon(icon, color: color, size: 14.sp),\n              SizedBox(width: 4.w),\n              Flexible(\n                child: Text(\n                  title,\n                  style: TextStyle(\n                    fontSize: 10.sp,\n                    color: color,\n                  ),\n                  maxLines: 1,\n                  overflow: TextOverflow.ellipsis,\n                ),\n              ),\n            ],\n          ),\n          SizedBox(height: 2.h),\n          Text(\n            value,\n            style: TextStyle(\n              fontSize: 12.sp,\n              fontWeight: FontWeight.bold,\n              color: color,\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n\n  /// بناء شريحة حالة التوصيل\n  Widget _buildDeliveryStatusChip(String status) {\n    Color color;\n    String statusText;\n    IconData icon;\n\n    switch (status) {\n      case 'delivered':\n        color = const Color(0xFF388E3C);\n        statusText = 'تم التوصيل';\n        icon = Icons.check_circle;\n        break;\n      case 'pending':\n      case 'company_pickup_request':\n        color = const Color(0xFFFF9800);\n        statusText = 'في الانتظار';\n        icon = Icons.hourglass_empty;\n        break;\n      default:\n        color = const Color(0xFF1976D2);\n        statusText = 'قيد التوصيل';\n        icon = Icons.local_shipping;\n        break;\n    }\n\n    return Container(\n      padding: EdgeInsets.symmetric(horizontal: 8.w, vertical: 6.h),\n      decoration: BoxDecoration(\n        color: color.withOpacity(0.1),\n        borderRadius: BorderRadius.circular(8.r),\n      ),\n      child: Column(\n        crossAxisAlignment: CrossAxisAlignment.center,\n        children: [\n          Row(\n            mainAxisAlignment: MainAxisAlignment.center,\n            children: [\n              Icon(icon, color: color, size: 14.sp),\n              SizedBox(width: 4.w),\n              Text(\n                'حالة التوصيل',\n                style: TextStyle(\n                  fontSize: 10.sp,\n                  color: color,\n                ),\n              ),\n            ],\n          ),\n          SizedBox(height: 2.h),\n          Text(\n            statusText,\n            style: TextStyle(\n              fontSize: 12.sp,\n              fontWeight: FontWeight.bold,\n              color: color,\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n\n  /// عرض تفاصيل المبيعة\n  void _showSaleDetails(SalesAnalyticsModel sale) {\n    Get.bottomSheet(\n      Container(\n        constraints: BoxConstraints(\n          maxHeight: Get.height * 0.8,\n        ),\n        decoration: BoxDecoration(\n          color: Colors.white,\n          borderRadius: BorderRadius.only(\n            topLeft: Radius.circular(20.r),\n            topRight: Radius.circular(20.r),\n          ),\n        ),\n        child: Column(\n          children: [\n            // مقبض السحب\n            Container(\n              margin: EdgeInsets.only(top: 12.h),\n              width: 40.w,\n              height: 4.h,\n              decoration: BoxDecoration(\n                color: Colors.grey[300],\n                borderRadius: BorderRadius.circular(2.r),\n              ),\n            ),\n            \n            // العنوان\n            Padding(\n              padding: EdgeInsets.all(20.w),\n              child: Row(\n                children: [\n                  Expanded(\n                    child: Text(\n                      'تفاصيل الطلب',\n                      style: TextStyle(\n                        fontSize: 20.sp,\n                        fontWeight: FontWeight.bold,\n                        color: const Color(0xFF2E7D32),\n                      ),\n                    ),\n                  ),\n                  IconButton(\n                    onPressed: () => Get.back(),\n                    icon: const Icon(Icons.close),\n                  ),\n                ],\n              ),\n            ),\n            \n            // المحتوى\n            Expanded(\n              child: SingleChildScrollView(\n                padding: EdgeInsets.symmetric(horizontal: 20.w),\n                child: Column(\n                  crossAxisAlignment: CrossAxisAlignment.start,\n                  children: [\n                    // معلومات المشتري\n                    _buildDetailSection(\n                      'معلومات المشتري',\n                      [\n                        _buildDetailRow('الاسم', sale.buyerName),\n                        if (sale.buyerPhoneNumber != null)\n                          _buildDetailRow('رقم الهاتف', sale.buyerPhoneNumber!),\n                        _buildDetailRow('تاريخ الطلب', DateFormat('dd/MM/yyyy HH:mm').format(sale.orderDate)),\n                      ],\n                    ),\n                    \n                    SizedBox(height: 20.h),\n                    \n                    // معلومات المالية\n                    _buildDetailSection(\n                      'المعلومات المالية',\n                      [\n                        _buildDetailRow('إجمالي المبلغ', '${NumberFormat('#,###').format(sale.totalAmount)} د.ع'),\n                        _buildDetailRow('ربح البائع', '${NumberFormat('#,###').format(sale.sellerProfit)} د.ع'),\n                        _buildDetailRow('هامش الربح', '${sale.profitMargin.toStringAsFixed(1)}%'),\n                        if (sale.deliveryFee != null)\n                          _buildDetailRow('رسوم التوصيل', '${NumberFormat('#,###').format(sale.deliveryFee)} د.ع'),\n                        _buildDetailRow('صافي الربح', '${NumberFormat('#,###').format(sale.netProfit)} د.ع'),\n                      ],\n                    ),\n                    \n                    SizedBox(height: 20.h),\n                    \n                    // معلومات التوصيل\n                    if (sale.driverName != null)\n                      _buildDetailSection(\n                        'معلومات التوصيل',\n                        [\n                          _buildDetailRow('حالة التوصيل', _getDeliveryStatusText(sale.deliveryStatus)),\n                          _buildDetailRow('عامل التوصيل', sale.driverName!),\n                          if (sale.driverPhoneNumber != null)\n                            _buildDetailRow('هاتف السائق', sale.driverPhoneNumber!),\n                          if (sale.deliveryDate != null)\n                            _buildDetailRow('تاريخ التوصيل', DateFormat('dd/MM/yyyy HH:mm').format(sale.deliveryDate!)),\n                          if (sale.deliveryAddress != null)\n                            _buildDetailRow('عنوان التوصيل', sale.deliveryAddress!),\n                        ],\n                      ),\n                    \n                    SizedBox(height: 20.h),\n                    \n                    // قائمة المنتجات\n                    _buildDetailSection(\n                      'المنتجات (${sale.items.length})',\n                      sale.items.map((item) => _buildProductRow(item)).toList(),\n                    ),\n                    \n                    SizedBox(height: 20.h),\n                  ],\n                ),\n              ),\n            ),\n          ],\n        ),\n      ),\n      isScrollControlled: true,\n    );\n  }\n\n  /// بناء قسم التفاصيل\n  Widget _buildDetailSection(String title, List<Widget> children) {\n    return Column(\n      crossAxisAlignment: CrossAxisAlignment.start,\n      children: [\n        Text(\n          title,\n          style: TextStyle(\n            fontSize: 16.sp,\n            fontWeight: FontWeight.bold,\n            color: const Color(0xFF2E7D32),\n          ),\n        ),\n        SizedBox(height: 12.h),\n        Container(\n          padding: EdgeInsets.all(16.w),\n          decoration: BoxDecoration(\n            color: Colors.grey[50],\n            borderRadius: BorderRadius.circular(12.r),\n            border: Border.all(color: Colors.grey[200]!),\n          ),\n          child: Column(\n            children: children,\n          ),\n        ),\n      ],\n    );\n  }\n\n  /// بناء صف التفاصيل\n  Widget _buildDetailRow(String label, String value) {\n    return Padding(\n      padding: EdgeInsets.symmetric(vertical: 4.h),\n      child: Row(\n        crossAxisAlignment: CrossAxisAlignment.start,\n        children: [\n          SizedBox(\n            width: 100.w,\n            child: Text(\n              '$label:',\n              style: TextStyle(\n                fontSize: 14.sp,\n                color: Colors.grey[600],\n              ),\n            ),\n          ),\n          Expanded(\n            child: Text(\n              value,\n              style: TextStyle(\n                fontSize: 14.sp,\n                fontWeight: FontWeight.w500,\n                color: Colors.black87,\n              ),\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n\n  /// بناء صف المنتج\n  Widget _buildProductRow(OrderItemAnalytics item) {\n    return Container(\n      margin: EdgeInsets.only(bottom: 8.h),\n      padding: EdgeInsets.all(12.w),\n      decoration: BoxDecoration(\n        color: Colors.white,\n        borderRadius: BorderRadius.circular(8.r),\n        border: Border.all(color: Colors.grey[300]!),\n      ),\n      child: Row(\n        children: [\n          // صورة المنتج\n          Container(\n            width: 50.w,\n            height: 50.h,\n            decoration: BoxDecoration(\n              borderRadius: BorderRadius.circular(8.r),\n              color: Colors.grey[200],\n              image: item.itemImageUrl != null\n                  ? DecorationImage(\n                      image: NetworkImage(item.itemImageUrl!),\n                      fit: BoxFit.cover,\n                    )\n                  : null,\n            ),\n            child: item.itemImageUrl == null\n                ? Icon(Icons.shopping_bag, color: Colors.grey[400], size: 24.sp)\n                : null,\n          ),\n          SizedBox(width: 12.w),\n          \n          // تفاصيل المنتج\n          Expanded(\n            child: Column(\n              crossAxisAlignment: CrossAxisAlignment.start,\n              children: [\n                Text(\n                  item.itemName,\n                  style: TextStyle(\n                    fontSize: 14.sp,\n                    fontWeight: FontWeight.w500,\n                  ),\n                  maxLines: 2,\n                  overflow: TextOverflow.ellipsis,\n                ),\n                SizedBox(height: 4.h),\n                Row(\n                  children: [\n                    Text(\n                      'الكمية: ${item.quantity}',\n                      style: TextStyle(\n                        fontSize: 12.sp,\n                        color: Colors.grey[600],\n                      ),\n                    ),\n                    SizedBox(width: 12.w),\n                    Text(\n                      'السعر: ${NumberFormat('#,###').format(item.unitPrice)} د.ع',\n                      style: TextStyle(\n                        fontSize: 12.sp,\n                        color: Colors.grey[600],\n                      ),\n                    ),\n                  ],\n                ),\n                SizedBox(height: 2.h),\n                Text(\n                  'الربح: ${NumberFormat('#,###').format(item.itemProfit)} د.ع',\n                  style: TextStyle(\n                    fontSize: 12.sp,\n                    color: const Color(0xFF388E3C),\n                    fontWeight: FontWeight.w500,\n                  ),\n                ),\n              ],\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n\n  /// الحصول على عنوان الفترة\n  String _getPeriodTitle(String period) {\n    switch (period) {\n      case 'today':\n        return 'اليوم';\n      case 'week':\n        return 'هذا الأسبوع';\n      case 'month':\n        return 'هذا الشهر';\n      case 'year':\n        return 'هذا العام';\n      default:\n        return 'اليوم';\n    }\n  }\n\n  /// الحصول على نص حالة التوصيل\n  String _getDeliveryStatusText(String status) {\n    switch (status) {\n      case 'delivered':\n        return 'تم التوصيل';\n      case 'pending':\n      case 'company_pickup_request':\n        return 'في انتظار التوصيل';\n      case 'driver_assigned':\n        return 'تم تعيين سائق';\n      case 'en_route_to_pickup':\n        return 'في الطريق للاستلام';\n      case 'picked_up_from_seller':\n        return 'تم الاستلام من البائع';\n      case 'out_for_delivery_to_buyer':\n        return 'في الطريق للتوصيل';\n      default:\n        return 'غير محدد';\n    }\n  }\n}\n"
        }
    ]
}