{
    "sourceFile": "lib/الكود الخاص بتطبيق العميل /HomePage/class/FilteredProductsScreen.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1753068346584,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1753149650079,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,8 +2,9 @@\n import 'package:flutter_screenutil/flutter_screenutil.dart';\n \n import '../controllers/filters_display_controller.dart';\n import 'ProductGridWidget.dart';\n+import '../../../XXX/xxx_firebase.dart';\n \n /// صفحة عرض المنتجات المفلترة حسب الفلتر المحدد\n class FilteredProductsScreen extends StatelessWidget {\n   final String filterKey;\n"
                }
            ],
            "date": 1753068346584,
            "name": "Commit-0",
            "content": "import 'package:flutter/material.dart';\nimport 'package:flutter_screenutil/flutter_screenutil.dart';\n\nimport '../controllers/filters_display_controller.dart';\nimport 'ProductGridWidget.dart';\n\n/// صفحة عرض المنتجات المفلترة حسب الفلتر المحدد\nclass FilteredProductsScreen extends StatelessWidget {\n  final String filterKey;\n  final String filterTitle;\n  final String filterSubtitle;\n  final FilterType filterType;\n\n  const FilteredProductsScreen({\n    super.key,\n    required this.filterKey,\n    required this.filterTitle,\n    required this.filterSubtitle,\n    required this.filterType,\n  });\n\n  @override\n  Widget build(BuildContext context) {\n    final theme = Theme.of(context);\n\n    return Scaffold(\n      backgroundColor: theme.scaffoldBackgroundColor,\n      appBar: AppBar(\n        title: Column(\n          crossAxisAlignment: CrossAxisAlignment.start,\n          children: [\n            Text(\n              filterTitle,\n              style: TextStyle(fontSize: 18.sp, fontWeight: FontWeight.bold),\n            ),\n            Text(\n              filterSubtitle,\n              style: TextStyle(\n                fontSize: 12.sp,\n                color: theme.appBarTheme.foregroundColor?.withOpacity(0.7),\n                fontWeight: FontWeight.normal,\n              ),\n            ),\n          ],\n        ),\n        backgroundColor: theme.appBarTheme.backgroundColor,\n        foregroundColor: theme.appBarTheme.foregroundColor,\n        elevation: 0,\n        actions: [\n          // مؤشر نوع الفلتر\n          Container(\n            margin: EdgeInsets.only(right: 16.w, top: 8.h, bottom: 8.h),\n            padding: EdgeInsets.symmetric(horizontal: 12.w, vertical: 6.h),\n            decoration: BoxDecoration(\n              color: filterType.color.withOpacity(0.1),\n              borderRadius: BorderRadius.circular(12.r),\n              border: Border.all(\n                color: filterType.color.withOpacity(0.3),\n                width: 1.w,\n              ),\n            ),\n            child: Row(\n              mainAxisSize: MainAxisSize.min,\n              children: [\n                Icon(filterType.icon, color: filterType.color, size: 16.sp),\n                SizedBox(width: 6.w),\n                Text(\n                  filterType.displayName,\n                  style: TextStyle(\n                    color: filterType.color,\n                    fontSize: 12.sp,\n                    fontWeight: FontWeight.w600,\n                  ),\n                ),\n              ],\n            ),\n          ),\n        ],\n      ),\n      body: RefreshIndicator(\n        onRefresh: () async {\n          // يمكن إضافة منطق إعادة التحميل هنا\n          await Future.delayed(const Duration(seconds: 1));\n        },\n        child: ListView(\n          children: [\n            // معلومات الفلتر\n            Container(\n              margin: EdgeInsets.all(16.w),\n              padding: EdgeInsets.all(16.w),\n              decoration: BoxDecoration(\n                color: theme.cardColor,\n                borderRadius: BorderRadius.circular(16.r),\n                border: Border.all(\n                  color: filterType.color.withOpacity(0.2),\n                  width: 1.w,\n                ),\n                boxShadow: [\n                  BoxShadow(\n                    color: filterType.color.withOpacity(0.1),\n                    blurRadius: 10.r,\n                    offset: Offset(0, 4.h),\n                  ),\n                ],\n              ),\n              child: Row(\n                children: [\n                  Container(\n                    width: 48.w,\n                    height: 48.h,\n                    decoration: BoxDecoration(\n                      color: filterType.color.withOpacity(0.1),\n                      borderRadius: BorderRadius.circular(12.r),\n                    ),\n                    child: Icon(\n                      filterType.icon,\n                      color: filterType.color,\n                      size: 24.sp,\n                    ),\n                  ),\n                  SizedBox(width: 16.w),\n                  Expanded(\n                    child: Column(\n                      crossAxisAlignment: CrossAxisAlignment.start,\n                      children: [\n                        Text(\n                          'عرض منتجات: $filterTitle',\n                          style: TextStyle(\n                            fontSize: 16.sp,\n                            fontWeight: FontWeight.bold,\n                            color: theme.textTheme.titleMedium?.color,\n                          ),\n                        ),\n                        SizedBox(height: 4.h),\n                        Text(\n                          'الفئة: $filterSubtitle',\n                          style: TextStyle(\n                            fontSize: 14.sp,\n                            color: theme.textTheme.bodySmall?.color\n                                ?.withOpacity(0.7),\n                          ),\n                        ),\n                      ],\n                    ),\n                  ),\n                ],\n              ),\n            ),\n\n            SizedBox(height: 8.h),\n\n            // ويدجت المنتجات مع الفلتر المحدد\n            ProductGridWidgetOption(\n              selectedSubtypeKey: _convertFilterKeyForProductGrid(),\n            ),\n\n            SizedBox(height: 24.h),\n          ],\n        ),\n      ),\n    );\n  }\n\n  /// تحويل مفتاح الفلتر لتناسب ProductGridWidget\n  String _convertFilterKeyForProductGrid() {\n    // إرجاع نفس مفتاح الفلتر، حيث أن ProductGridWidget يدعم بالفعل:\n    // - sub_categoryId للأقسام الفرعية\n    // - original_company_companyId للشركات\n    // - original_product_productId للمنتجات\n    return filterKey;\n  }\n}\n"
        }
    ]
}