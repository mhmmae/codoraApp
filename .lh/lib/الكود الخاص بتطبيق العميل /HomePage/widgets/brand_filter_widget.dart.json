{
    "sourceFile": "lib/Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø®Ø§Øµ Ø¨ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ù…ÙŠÙ„ /HomePage/widgets/brand_filter_widget.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1752862376170,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1752865517059,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1102,10 +1102,13 @@\n   ) {\n     return _CompanyCardTappable(\n       key: ValueKey(company.id), // Ù…ÙØªØ§Ø­ Ù„Ø¶Ù…Ø§Ù† Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„ØµØ­ÙŠØ­Ø©\n       company: company,\n+      isSelected: isSelected,\n       theme: theme,\n-      controller: controller,\n+      onTap: () {\n+        controller.selectCompany(company);\n+      },\n     );\n   }\n \n   /// Ù…Ø­ØªÙˆÙ‰ ÙƒÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª\n@@ -1187,24 +1190,30 @@\n   }\n }\n \n /// ÙˆÙŠØ¯Ø¬Øª Ù…Ø®ØµØµ Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø´Ø±ÙƒØ© Ù…Ø¹ ØªØ£Ø«ÙŠØ±Ø§Øª Ø¨ØµØ±ÙŠØ© Ù…Ø­Ø³Ù†Ø©\n-class _CompanyCardTappable extends StatelessWidget {\n+class _CompanyCardTappable extends StatefulWidget {\n   final CompanyModel company;\n+  final bool isSelected;\n   final ThemeData theme;\n-  final BrandFilterController controller;\n+  final VoidCallback onTap;\n \n   const _CompanyCardTappable({\n     super.key,\n     required this.company,\n+    required this.isSelected,\n     required this.theme,\n-    required this.controller,\n+    required this.onTap,\n   });\n \n   @override\n+  State<_CompanyCardTappable> createState() => _CompanyCardTappableState();\n+}\n+\n+class _CompanyCardTappableState extends State<_CompanyCardTappable> {\n+  @override\n   Widget build(BuildContext context) {\n-    return Obx(() {\n-      final bool showAsSelected = controller.selectedCompany.value?.id == company.id;\n+    final bool showAsSelected = widget.isSelected;\n \n     return GestureDetector(\n       onTap: () {\n         HapticFeedback.mediumImpact();\n"
                }
            ],
            "date": 1752862376170,
            "name": "Commit-0",
            "content": "import 'package:cached_network_image/cached_network_image.dart';\nimport 'package:flutter/material.dart';\nimport 'package:flutter/services.dart';\nimport 'package:flutter_screenutil/flutter_screenutil.dart';\nimport 'package:get/get.dart';\nimport '../../../Model/company_model.dart';\nimport '../controllers/brand_filter_controller.dart';\nimport '../controllers/barcode_filter_controller.dart';\nimport 'barcode_search_widget.dart';\n\n/// Ø±Ø³Ø§Ù… Ù…Ø®ØµØµ Ù„Ù†Ù…Ø· Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯\nclass BarcodePainter extends CustomPainter {\n  @override\n  void paint(Canvas canvas, Size size) {\n    final paint = Paint()\n      ..color = Colors.white.withValues(alpha: 0.1)\n      ..strokeWidth = 1.5;\n\n    final spacing = size.width / 20;\n    \n    for (int i = 0; i < 20; i++) {\n      final x = i * spacing;\n      final height = (i % 3 == 0) ? size.height * 0.6 : \n                   (i % 2 == 0) ? size.height * 0.4 : size.height * 0.8;\n      final startY = (size.height - height) / 2;\n      \n      canvas.drawLine(\n        Offset(x, startY),\n        Offset(x, startY + height),\n        paint,\n      );\n    }\n  }\n\n  @override\n  bool shouldRepaint(covariant CustomPainter oldDelegate) => false;\n}\n\n/// ÙˆÙŠØ¯Ø¬Øª Ø§Ù„Ø¨Ø­Ø« Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯ Ù…Ø¹ Ø§Ù„Ø§Ù†ÙŠÙ…ÙŠØ´Ù† Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ\nclass BrandFilterWidget extends StatelessWidget {\n  const BrandFilterWidget({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    final BrandFilterController controller = Get.put(BrandFilterController());\n    final BarcodeFilterController barcodeController = Get.put(BarcodeFilterController());\n    final theme = Theme.of(context);\n\n    return Container(\n      padding: EdgeInsets.symmetric(horizontal: 16.w, vertical: 8.h),\n      child: Column(\n        children: [\n          // Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© Ù„Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ù†Ù…Ø§Ø·\n          _buildAnimatedToggleButton(controller, barcodeController, theme),\n          \n          SizedBox(height: 12.h),\n          \n          // Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…ØªØ­Ø±Ùƒ\n          AnimatedBuilder(\n            animation: controller.animationController,\n            builder: (context, child) {\n              return Obx(() {\n                if (barcodeController.isBarcodeSearchActive.value) {\n                  return _buildBarcodeSearchContent(barcodeController, theme);\n                } else if (controller.isBrandModeActive.value) {\n                  return _buildBrandFilterContent(controller, theme);\n                } else {\n                  return _buildAllProductsButton(controller, barcodeController, theme);\n                }\n              });\n            },\n          ),\n          \n          // Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ Ø§Ù„Ù…Ø­ÙÙˆØ¸ Ù„Ù„Ø¨Ø­Ø«\n          Obx(() => barcodeController.currentSearchBarcode.value.isNotEmpty\n              ? _buildCurrentBarcodeDisplay(barcodeController, theme)\n              : const SizedBox.shrink()),\n        ],\n      ),\n    );\n  }\n\n  /// Ø¨Ù†Ø§Ø¡ Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ Ø§Ù„Ù…Ø­ÙÙˆØ¸ - ØªØµÙ…ÙŠÙ… Ø§Ø­ØªØ±Ø§ÙÙŠ\n  Widget _buildCurrentBarcodeDisplay(BarcodeFilterController barcodeController, ThemeData theme) {\n    return Container(\n      margin: EdgeInsets.only(top: 12.h),\n      child: Material(\n        elevation: 12.r,\n        borderRadius: BorderRadius.circular(16.r),\n        shadowColor: theme.primaryColor.withValues(alpha: 0.3),\n        child: Container(\n          padding: EdgeInsets.all(16.r),\n          decoration: BoxDecoration(\n            borderRadius: BorderRadius.circular(16.r),\n            gradient: LinearGradient(\n              colors: [\n                theme.primaryColor.withValues(alpha: 0.1),\n                theme.primaryColor.withValues(alpha: 0.05),\n                Colors.white,\n              ],\n              begin: Alignment.topLeft,\n              end: Alignment.bottomRight,\n            ),\n            border: Border.all(\n              color: theme.primaryColor.withValues(alpha: 0.3),\n              width: 1.5.w,\n            ),\n            boxShadow: [\n              BoxShadow(\n                color: theme.primaryColor.withValues(alpha: 0.2),\n                blurRadius: 15.r,\n                offset: Offset(0, 8.h),\n                spreadRadius: 1.r,\n              ),\n            ],\n          ),\n          child: Column(\n            children: [\n              // Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù…Ø¹ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©\n              Row(\n                children: [\n                  Container(\n                    padding: EdgeInsets.all(10.r),\n                    decoration: BoxDecoration(\n                      gradient: LinearGradient(\n                        colors: [\n                          theme.primaryColor,\n                          theme.primaryColor.withValues(alpha: 0.8),\n                        ],\n                      ),\n                      borderRadius: BorderRadius.circular(12.r),\n                      boxShadow: [\n                        BoxShadow(\n                          color: theme.primaryColor.withValues(alpha: 0.3),\n                          blurRadius: 8.r,\n                          offset: Offset(0, 4.h),\n                        ),\n                      ],\n                    ),\n                    child: Icon(\n                      Icons.qr_code,\n                      color: Colors.white,\n                      size: 22.sp,\n                    ),\n                  ),\n                  SizedBox(width: 12.w),\n                  Expanded(\n                    child: Column(\n                      crossAxisAlignment: CrossAxisAlignment.start,\n                      children: [\n                        Text(\n                          'Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ Ø§Ù„Ù…Ø­ÙÙˆØ¸',\n                          style: TextStyle(\n                            fontSize: 15.sp,\n                            color: theme.primaryColor,\n                            fontWeight: FontWeight.bold,\n                            shadows: [\n                              Shadow(\n                                color: Colors.black.withValues(alpha: 0.1),\n                                offset: Offset(0, 1.h),\n                                blurRadius: 2.r,\n                              ),\n                            ],\n                          ),\n                        ),\n                        SizedBox(height: 2.h),\n                        Text(\n                          'Ø§Ø¶ØºØ· Ù„Ù…Ø³Ø­ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯',\n                          style: TextStyle(\n                            fontSize: 12.sp,\n                            color: theme.primaryColor.withValues(alpha: 0.7),\n                            fontWeight: FontWeight.w500,\n                          ),\n                        ),\n                      ],\n                    ),\n                  ),\n                  // Ø²Ø± Ø§Ù„Ù…Ø³Ø­ Ù…Ø¹ ØªØµÙ…ÙŠÙ… Ù…Ø­Ø³Ù†\n                  Material(\n                    color: Colors.transparent,\n                    child: InkWell(\n                      onTap: () {\n                        HapticFeedback.lightImpact();\n                        barcodeController.clearCurrentBarcode();\n                      },\n                      borderRadius: BorderRadius.circular(10.r),\n                      child: Container(\n                        padding: EdgeInsets.all(8.r),\n                        decoration: BoxDecoration(\n                          color: Colors.red.withValues(alpha: 0.1),\n                          borderRadius: BorderRadius.circular(10.r),\n                          border: Border.all(\n                            color: Colors.red.withValues(alpha: 0.3),\n                            width: 1.w,\n                          ),\n                        ),\n                        child: Icon(\n                          Icons.close,\n                          color: Colors.red,\n                          size: 18.sp,\n                        ),\n                      ),\n                    ),\n                  ),\n                ],\n              ),\n              \n              SizedBox(height: 12.h),\n              \n              // Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ Ù…Ø¹ ØªØµÙ…ÙŠÙ… Ø§Ø­ØªØ±Ø§ÙÙŠ\n              Container(\n                width: double.infinity,\n                padding: EdgeInsets.all(12.r),\n                decoration: BoxDecoration(\n                  color: Colors.grey.shade50,\n                  borderRadius: BorderRadius.circular(10.r),\n                  border: Border.all(\n                    color: Colors.grey.shade300,\n                    width: 1.w,\n                  ),\n                  boxShadow: [\n                    BoxShadow(\n                      color: Colors.black.withValues(alpha: 0.05),\n                      blurRadius: 6.r,\n                      offset: Offset(0, 3.h),\n                    ),\n                  ],\n                ),\n                child: Row(\n                  children: [\n                    // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯\n                    Container(\n                      padding: EdgeInsets.all(6.r),\n                      decoration: BoxDecoration(\n                        color: theme.primaryColor.withValues(alpha: 0.1),\n                        borderRadius: BorderRadius.circular(6.r),\n                      ),\n                      child: Icon(\n                        Icons.qr_code_scanner,\n                        color: theme.primaryColor,\n                        size: 16.sp,\n                      ),\n                    ),\n                    SizedBox(width: 10.w),\n                    // Ø§Ù„Ù†Øµ\n                    Expanded(\n                      child: Text(\n                        barcodeController.currentSearchBarcode.value,\n                        style: TextStyle(\n                          fontSize: 13.sp,\n                          color: Colors.black87,\n                          fontWeight: FontWeight.bold,\n                          fontFamily: 'monospace',\n                          letterSpacing: 1.0.w,\n                        ),\n                        maxLines: 1,\n                        overflow: TextOverflow.ellipsis,\n                      ),\n                    ),\n                    // Ø²Ø± Ø§Ù„Ù†Ø³Ø®\n                    InkWell(\n                      onTap: () {\n                        Clipboard.setData(\n                          ClipboardData(text: barcodeController.currentSearchBarcode.value),\n                        );\n                        HapticFeedback.selectionClick();\n                        Get.snackbar(\n                          'ØªÙ… Ø§Ù„Ù†Ø³Ø®',\n                          'ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©',\n                          snackPosition: SnackPosition.TOP,\n                          backgroundColor: Colors.green.withValues(alpha: 0.8),\n                          colorText: Colors.white,\n                          duration: const Duration(seconds: 2),\n                        );\n                      },\n                      borderRadius: BorderRadius.circular(6.r),\n                      child: Container(\n                        padding: EdgeInsets.all(6.r),\n                        child: Icon(\n                          Icons.copy,\n                          color: theme.primaryColor,\n                          size: 15.sp,\n                        ),\n                      ),\n                    ),\n                  ],\n                ),\n              ),\n            ],\n          ),\n        ),\n      ),\n    );\n  }\n\n  /// Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø²Ø± Ø§Ù„Ù…ØªØ­Ø±Ùƒ Ù„Ù„ØªØ¨Ø¯ÙŠÙ„\n  Widget _buildAnimatedToggleButton(BrandFilterController controller, BarcodeFilterController barcodeController, ThemeData theme) {\n    return AnimatedBuilder(\n      animation: controller.animationController,\n      builder: (context, child) {\n        return Obx(() {\n          final isBrandActive = controller.isBrandModeActive.value;\n          final isBarcodeActive = barcodeController.isBarcodeSearchActive.value;\n          final isAllActive = !isBrandActive && !isBarcodeActive;\n          \n          return SizedBox(\n            height: 72.h, // Ù…Ù‚Ù„Ù„ Ø¨Ù†Ø³Ø¨Ø© 40% Ù…Ù† 120 Ù„ÙŠØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±\n            child: isAllActive \n                ? Row(\n                    children: [\n                      // Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø«Ù„Ø§Ø«Ø© Ø¬Ù†Ø¨Ø§Ù‹ Ø¥Ù„Ù‰ Ø¬Ù†Ø¨ ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø§Ø¯ÙŠ\n                      Expanded(\n                        child: AnimatedOpacity(\n                          duration: const Duration(milliseconds: 600),\n                          opacity: 1.0,\n                          child: _buildBrandSearchButton(controller, barcodeController, theme),\n                        ),\n                      ),\n                      const SizedBox(width: 8),\n                      Expanded(\n                        child: AnimatedOpacity(\n                          duration: const Duration(milliseconds: 600),\n                          opacity: 1.0,\n                          child: _buildBarcodeSearchButton(controller, barcodeController, theme),\n                        ),\n                      ),\n                    ],\n                  )\n                : Stack(\n                    children: [\n                      // ÙˆØ¶Ø¹ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„ÙØ±Ø¯ÙŠ Ù…Ø¹ Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø©\n                      AnimatedPositioned(\n                        duration: const Duration(milliseconds: 800),\n                        curve: Curves.easeInOutCubic,\n                        left: 0,\n                        top: 0,\n                        bottom: 0,\n                        right: 48.w, // ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø­Ø³Ø¨ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙŠØ¯\n                        child: Transform.scale(\n                          scale: 1.0,\n                          child: AnimatedOpacity(\n                            duration: const Duration(milliseconds: 400),\n                            opacity: 1.0,\n                            child: isBrandActive \n                                ? _buildBrandSearchButton(controller, barcodeController, theme)\n                                : _buildBarcodeSearchButton(controller, barcodeController, theme),\n                          ),\n                        ),\n                      ),\n                      \n                      // Ø²Ø± \"ÙƒÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª\" Ù„Ù„Ø¹ÙˆØ¯Ø©\n                      AnimatedPositioned(\n                        duration: const Duration(milliseconds: 800),\n                        curve: Curves.easeInOutCubic,\n                        right: 0,\n                        top: 0,\n                        bottom: 0,\n                        width: 42.w, // Ù…Ù‚Ù„Ù„ Ø¨Ù†Ø³Ø¨Ø© 40% Ù…Ù† 70\n                        child: Transform.scale(\n                          scale: 1.0,\n                          child: AnimatedOpacity(\n                            duration: const Duration(milliseconds: 400),\n                            opacity: 1.0,\n                            child: _buildAllProductsToggleButton(controller, barcodeController, theme),\n                          ),\n                        ),\n                      ),\n                    ],\n                  ),\n          );\n        });\n      },\n    );\n  }\n\n  /// Ø²Ø± \"Ø§Ù„Ø¨Ø­Ø« Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯\" - ØªØµÙ…ÙŠÙ… Ø§Ø­ØªØ±Ø§ÙÙŠ Ø¬Ù†ÙˆÙ†ÙŠ\n  Widget _buildBrandSearchButton(BrandFilterController controller, BarcodeFilterController barcodeController, ThemeData theme) {\n    return Material(\n      elevation: 12.r,\n      borderRadius: BorderRadius.circular(18.r),\n      shadowColor: Colors.purple.withValues(alpha: 0.4),\n      child: InkWell(\n        onTap: () {\n          HapticFeedback.mediumImpact();\n          debugPrint('ğŸ–±ï¸ ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¨Ø­Ø« Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯');\n          \n          if (barcodeController.isBarcodeSearchActive.value) {\n            barcodeController.deactivateBarcodeSearch();\n          }\n          controller.activateBrandMode();\n        },\n        borderRadius: BorderRadius.circular(18.r),\n        splashColor: Colors.white.withValues(alpha: 0.3),\n        highlightColor: Colors.white.withValues(alpha: 0.1),\n        child: Container(\n          height: 72.h, // Ù…Ù‚Ù„Ù„ Ø¨Ù†Ø³Ø¨Ø© 40% Ù…Ù† 120\n          decoration: BoxDecoration(\n            borderRadius: BorderRadius.circular(18.r),\n            boxShadow: [\n              BoxShadow(\n                color: Colors.purple.withValues(alpha: 0.4),\n                blurRadius: 15.r,\n                offset: Offset(0, 9.h),\n                spreadRadius: 3.r,\n              ),\n              BoxShadow(\n                color: Colors.blue.withValues(alpha: 0.3),\n                blurRadius: 9.r,\n                offset: Offset(0, 5.h),\n              ),\n            ],\n          ),\n          child: Stack(\n            children: [\n              // Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø®Ù„ÙÙŠØ© ØªØ£Ø®Ø° ÙƒØ§Ù…Ù„ Ø§Ù„Ù…Ø³Ø§Ø­Ø©\n              Positioned.fill(\n                child: ClipRRect(\n                  borderRadius: BorderRadius.circular(18.r),\n                  child: CachedNetworkImage(\n                    imageUrl: 'https://img.youm7.com/ArticleImgs/2020/5/14/73940-3.jpg',\n                    fit: BoxFit.cover,\n                    placeholder: (context, url) => Container(\n                      decoration: BoxDecoration(\n                        gradient: LinearGradient(\n                          colors: [\n                            Colors.purple.shade600,\n                            Colors.blue.shade600,\n                            Colors.teal.shade500,\n                          ],\n                          begin: Alignment.topLeft,\n                          end: Alignment.bottomRight,\n                        ),\n                      ),\n                      child: Center(\n                        child: Icon(Icons.business, color: Colors.white, size: 24.sp),\n                      ),\n                    ),\n                    errorWidget: (context, url, error) => Container(\n                      decoration: BoxDecoration(\n                        gradient: LinearGradient(\n                          colors: [\n                            Colors.purple.shade600,\n                            Colors.blue.shade600,\n                            Colors.teal.shade500,\n                          ],\n                          begin: Alignment.topLeft,\n                          end: Alignment.bottomRight,\n                        ),\n                      ),\n                      child: Center(\n                        child: Icon(Icons.business, color: Colors.white, size: 24.sp),\n                      ),\n                    ),\n                  ),\n                ),\n              ),\n              \n              // Ø·Ø¨Ù‚Ø© Ø§Ù„ØªØ¯Ø±Ø¬ Ø§Ù„Ø¯Ø§ÙƒÙ† Ù„Ù„Ù†Øµ\n              Positioned.fill(\n                child: Container(\n                  decoration: BoxDecoration(\n                    borderRadius: BorderRadius.circular(18.r),\n                    gradient: LinearGradient(\n                      colors: [\n                        Colors.black.withValues(alpha: 0.7),\n                        Colors.black.withValues(alpha: 0.3),\n                        Colors.transparent,\n                        Colors.black.withValues(alpha: 0.4),\n                      ],\n                      begin: Alignment.bottomLeft,\n                      end: Alignment.topRight,\n                      stops: const [0.0, 0.3, 0.7, 1.0],\n                    ),\n                  ),\n                ),\n              ),\n              \n              // Ø§Ù„Ù†Øµ ÙˆØ§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª ÙÙˆÙ‚ Ø§Ù„ØµÙˆØ±Ø©\n              Positioned.fill(\n                child: Padding(\n                  padding: EdgeInsets.all(12.r),\n                  child: Column(\n                    crossAxisAlignment: CrossAxisAlignment.start,\n                    mainAxisSize: MainAxisSize.min,\n                    children: [\n                      // Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ\n                      Row(\n                        children: [\n                          Container(\n                            padding: EdgeInsets.all(3.r),\n                            decoration: BoxDecoration(\n                              color: Colors.white.withValues(alpha: 0.2),\n                              borderRadius: BorderRadius.circular(6.r),\n                              border: Border.all(\n                                color: Colors.white.withValues(alpha: 0.3),\n                                width: 0.6.w,\n                              ),\n                            ),\n                            child: Icon(\n                              Icons.business_center,\n                              color: Colors.white,\n                              size: 8.sp, // Ù…Ù‚Ù„Ù„ Ø¨Ù†Ø³Ø¨Ø© 40% Ù…Ù† 14sp\n                            ),\n                          ),\n                          const Spacer(),\n                          Container(\n                            padding: EdgeInsets.all(2.5.r),\n                            decoration: BoxDecoration(\n                              color: Colors.white.withValues(alpha: 0.2),\n                              borderRadius: BorderRadius.circular(8.r),\n                            ),\n                            child: Icon(\n                              Icons.arrow_forward_ios,\n                              color: Colors.white,\n                              size: 6.sp, // Ù…Ù‚Ù„Ù„ Ø¨Ù†Ø³Ø¨Ø© 40% Ù…Ù† 10sp\n                            ),\n                          ),\n                        ],\n                      ),\n                      \n                      const Spacer(),\n                      \n                      // Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ\n                      Flexible(\n                        child: Text(\n                          'Ø§Ù„Ø¨Ø­Ø« Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯',\n                          style: TextStyle(\n                            color: Colors.white,\n                            fontSize: 7.8.sp, // Ù…Ù‚Ù„Ù„ Ø¨Ù†Ø³Ø¨Ø© 40% Ù…Ù† 13sp\n                            fontWeight: FontWeight.bold,\n                            letterSpacing: 0.2.w,\n                            height: 1.0,\n                            shadows: [\n                              Shadow(\n                                color: Colors.black.withValues(alpha: 0.8),\n                                offset: Offset(0.8.w, 0.8.h),\n                                blurRadius: 3.r,\n                              ),\n                            ],\n                          ),\n                          maxLines: 2,\n                          overflow: TextOverflow.ellipsis,\n                        ),\n                      ),\n                      \n                      SizedBox(height: 1.h),\n                      \n                      // Ø§Ù„Ù†Øµ Ø§Ù„ÙØ±Ø¹ÙŠ\n                      Flexible(\n                        child: Text(\n                          'Ø§Ø®ØªØ± Ù…Ù† Ù…Ø¦Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ§Øª ÙˆØ§Ù„Ù…Ø§Ø±ÙƒØ§Øª',\n                          style: TextStyle(\n                            color: Colors.white.withValues(alpha: 0.9),\n                            fontSize: 5.4.sp, // Ù…Ù‚Ù„Ù„ Ø¨Ù†Ø³Ø¨Ø© 40% Ù…Ù† 9sp\n                            fontWeight: FontWeight.w500,\n                            height: 1.0,\n                            shadows: [\n                              Shadow(\n                                color: Colors.black.withValues(alpha: 0.6),\n                                offset: Offset(0.3.w, 0.3.h),\n                                blurRadius: 1.5.r,\n                              ),\n                            ],\n                          ),\n                          maxLines: 1,\n                          overflow: TextOverflow.ellipsis,\n                        ),\n                      ),\n                    ],\n                  ),\n                ),\n              ),\n              \n              // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© ÙÙŠ Ø§Ù„Ø²Ø§ÙˆÙŠØ©\n              Positioned(\n                top: -12.h,\n                right: -12.w,\n                child: Container(\n                  width: 48.w,\n                  height: 48.h,\n                  decoration: BoxDecoration(\n                    shape: BoxShape.circle,\n                    gradient: RadialGradient(\n                      colors: [\n                        Colors.white.withValues(alpha: 0.3),\n                        Colors.white.withValues(alpha: 0.1),\n                        Colors.transparent,\n                      ],\n                    ),\n                  ),\n                ),\n              ),\n            ],\n          ),\n        ),\n      ),\n    );\n  }\n\n  /// Ø²Ø± \"Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯\" - ØªØµÙ…ÙŠÙ… Ø§Ø­ØªØ±Ø§ÙÙŠ Ø¬Ù†ÙˆÙ†ÙŠ\n  Widget _buildBarcodeSearchButton(BrandFilterController controller, BarcodeFilterController barcodeController, ThemeData theme) {\n    return Material(\n      elevation: 12.r,\n      borderRadius: BorderRadius.circular(18.r),\n      shadowColor: Colors.deepPurple.withValues(alpha: 0.4),\n      child: InkWell(\n        onTap: () {\n          HapticFeedback.mediumImpact();\n          debugPrint('ğŸ–±ï¸ ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯');\n          \n          if (controller.isBrandModeActive.value) {\n            controller.deactivateBrandModeAndClearMemory();\n          }\n          barcodeController.activateBarcodeSearch();\n        },\n        borderRadius: BorderRadius.circular(18.r),\n        splashColor: Colors.white.withValues(alpha: 0.3),\n        highlightColor: Colors.white.withValues(alpha: 0.1),\n        child: Container(\n          height: 72.h, // Ù…Ù‚Ù„Ù„ Ø¨Ù†Ø³Ø¨Ø© 40% Ù…Ù† 120\n          decoration: BoxDecoration(\n            borderRadius: BorderRadius.circular(18.r),\n            boxShadow: [\n              BoxShadow(\n                color: Colors.deepPurple.withValues(alpha: 0.4),\n                blurRadius: 15.r,\n                offset: Offset(0, 9.h),\n                spreadRadius: 3.r,\n              ),\n              BoxShadow(\n                color: Colors.indigo.withValues(alpha: 0.3),\n                blurRadius: 9.r,\n                offset: Offset(0, 5.h),\n              ),\n            ],\n          ),\n          child: Stack(\n            children: [\n              // Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…ØªØ¯Ø±Ø¬Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©\n              Positioned.fill(\n                child: Container(\n                  decoration: BoxDecoration(\n                    borderRadius: BorderRadius.circular(18.r),\n                    gradient: LinearGradient(\n                      colors: [\n                        Colors.deepPurple.shade600,\n                        Colors.indigo.shade600,\n                        Colors.blue.shade600,\n                        Colors.cyan.shade500,\n                      ],\n                      begin: Alignment.topLeft,\n                      end: Alignment.bottomRight,\n                      stops: const [0.0, 0.3, 0.7, 1.0],\n                    ),\n                  ),\n                ),\n              ),\n              \n              // Ù†Ù…Ø· Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©\n              Positioned.fill(\n                child: Container(\n                  decoration: BoxDecoration(\n                    borderRadius: BorderRadius.circular(18.r),\n                  ),\n                  child: CustomPaint(\n                    painter: BarcodePainter(),\n                  ),\n                ),\n              ),\n              \n              // Ø·Ø¨Ù‚Ø© Ø§Ù„ØªØ¯Ø±Ø¬ Ù„Ù„Ù†Øµ\n              Positioned.fill(\n                child: Container(\n                  decoration: BoxDecoration(\n                    borderRadius: BorderRadius.circular(18.r),\n                    gradient: LinearGradient(\n                      colors: [\n                        Colors.black.withValues(alpha: 0.6),\n                        Colors.black.withValues(alpha: 0.2),\n                        Colors.transparent,\n                        Colors.black.withValues(alpha: 0.3),\n                      ],\n                      begin: Alignment.bottomLeft,\n                      end: Alignment.topRight,\n                      stops: const [0.0, 0.3, 0.7, 1.0],\n                    ),\n                  ),\n                ),\n              ),\n              \n              // Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù†ØµÙŠ ÙˆØ§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª\n              Positioned.fill(\n                child: Padding(\n                  padding: EdgeInsets.all(12.r),\n                  child: Column(\n                    crossAxisAlignment: CrossAxisAlignment.start,\n                    mainAxisSize: MainAxisSize.min,\n                    children: [\n                      // Ø§Ù„ØµÙ Ø§Ù„Ø¹Ù„ÙˆÙŠ Ù…Ø¹ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©\n                      Row(\n                        children: [\n                          Container(\n                            padding: EdgeInsets.all(3.6.r),\n                            decoration: BoxDecoration(\n                              color: Colors.white.withValues(alpha: 0.25),\n                              borderRadius: BorderRadius.circular(7.r),\n                              border: Border.all(\n                                color: Colors.white.withValues(alpha: 0.4),\n                                width: 0.7.w,\n                              ),\n                              boxShadow: [\n                                BoxShadow(\n                                  color: Colors.black.withValues(alpha: 0.2),\n                                  blurRadius: 3.r,\n                                  offset: Offset(0, 1.5.h),\n                                ),\n                              ],\n                            ),\n                            child: Icon(\n                              Icons.qr_code_scanner,\n                              color: Colors.white,\n                              size: 8.sp, // Ù…Ù‚Ù„Ù„ Ø¨Ù†Ø³Ø¨Ø© 40% Ù…Ù† 14sp\n                            ),\n                          ),\n                          const Spacer(),\n                          Container(\n                            padding: EdgeInsets.all(2.5.r),\n                            decoration: BoxDecoration(\n                              color: Colors.white.withValues(alpha: 0.2),\n                              borderRadius: BorderRadius.circular(8.r),\n                            ),\n                            child: Icon(\n                              Icons.arrow_forward_ios,\n                              color: Colors.white,\n                              size: 6.sp, // Ù…Ù‚Ù„Ù„ Ø¨Ù†Ø³Ø¨Ø© 40% Ù…Ù† 10sp\n                            ),\n                          ),\n                        ],\n                      ),\n                      \n                      const Spacer(),\n                      \n                      // Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ\n                      Flexible(\n                        child: Text(\n                          'Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯',\n                          style: TextStyle(\n                            color: Colors.white,\n                            fontSize: 7.8.sp, // Ù…Ù‚Ù„Ù„ Ø¨Ù†Ø³Ø¨Ø© 40% Ù…Ù† 13sp\n                            fontWeight: FontWeight.bold,\n                            letterSpacing: 0.2.w,\n                            height: 1.0,\n                            shadows: [\n                              Shadow(\n                                color: Colors.black.withValues(alpha: 0.8),\n                                offset: Offset(0.8.w, 0.8.h),\n                                blurRadius: 3.r,\n                              ),\n                            ],\n                          ),\n                          maxLines: 2,\n                          overflow: TextOverflow.ellipsis,\n                        ),\n                      ),\n                      \n                      SizedBox(height: 1.h),\n                      \n                      // Ø§Ù„Ù†Øµ Ø§Ù„ÙØ±Ø¹ÙŠ\n                      Flexible(\n                        child: Text(\n                          'Ø§Ù…Ø³Ø­ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø±ÙŠØ¹',\n                          style: TextStyle(\n                            color: Colors.white.withValues(alpha: 0.9),\n                            fontSize: 5.4.sp, // Ù…Ù‚Ù„Ù„ Ø¨Ù†Ø³Ø¨Ø© 40% Ù…Ù† 9sp\n                            fontWeight: FontWeight.w500,\n                            height: 1.0,\n                            shadows: [\n                              Shadow(\n                                color: Colors.black.withValues(alpha: 0.6),\n                                offset: Offset(0.3.w, 0.3.h),\n                                blurRadius: 1.5.r,\n                              ),\n                            ],\n                          ),\n                          maxLines: 1,\n                          overflow: TextOverflow.ellipsis,\n                        ),\n                      ),\n                    ],\n                  ),\n                ),\n              ),\n              \n              // ØªØ£Ø«ÙŠØ±Ø§Øª Ø¨ØµØ±ÙŠØ© Ø¥Ø¶Ø§ÙÙŠØ©\n              Positioned(\n                top: -12.h,\n                right: -12.w,\n                child: Container(\n                  width: 48.w,\n                  height: 48.h,\n                  decoration: BoxDecoration(\n                    shape: BoxShape.circle,\n                    gradient: RadialGradient(\n                      colors: [\n                        Colors.white.withValues(alpha: 0.3),\n                        Colors.white.withValues(alpha: 0.1),\n                        Colors.transparent,\n                      ],\n                    ),\n                  ),\n                ),\n              ),\n            ],\n          ),\n        ),\n      ),\n    );\n  }\n\n  /// Ø²Ø± \"ÙƒÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª\" Ù„Ù„Ø¹ÙˆØ¯Ø©\n  Widget _buildAllProductsToggleButton(BrandFilterController controller, BarcodeFilterController barcodeController, ThemeData theme) {\n    return Material(\n      elevation: 4.r,\n      borderRadius: BorderRadius.circular(11.r),\n      shadowColor: theme.primaryColor.withValues(alpha: 0.25),\n      child: InkWell(\n        onTap: () {\n          // Ø¥Ø¶Ø§ÙØ© Ø§Ù‡ØªØ²Ø§Ø² ÙÙˆØ±ÙŠ Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù†Ù‚Ø±\n          HapticFeedback.lightImpact();\n          \n          debugPrint('ğŸ–±ï¸ ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚');\n          \n          // Ø¥Ù„ØºØ§Ø¡ Ø£ÙŠ ÙˆØ¶Ø¹ Ù†Ø´Ø·\n          if (controller.isBrandModeActive.value) {\n            controller.deactivateBrandModeAndClearMemory(); // Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…Ù† Ø§Ù„Ø°Ø§ÙƒØ±Ø©\n          }\n          if (barcodeController.isBarcodeSearchActive.value) {\n            barcodeController.deactivateBarcodeSearch();\n          }\n        },\n        borderRadius: BorderRadius.circular(11.r),\n        splashColor: theme.primaryColor.withValues(alpha: 0.3),\n        highlightColor: theme.primaryColor.withValues(alpha: 0.1),\n        child: AnimatedContainer(\n          duration: const Duration(milliseconds: 400),\n          curve: Curves.easeInOutCubic,\n          height: 48.h, // Ù…Ù‚Ù„Ù„ Ø¨Ù†Ø³Ø¨Ø© 40% Ù…Ù† 80\n          padding: EdgeInsets.symmetric(horizontal: 10.w, vertical: 7.h),\n          decoration: BoxDecoration(\n            borderRadius: BorderRadius.circular(11.r),\n            gradient: LinearGradient(\n              colors: [\n                Colors.white,\n                Colors.grey.shade50,\n              ],\n              begin: Alignment.topLeft,\n              end: Alignment.bottomRight,\n            ),\n            border: Border.all(\n              color: theme.primaryColor.withValues(alpha: 0.4),\n              width: 0.9.w,\n            ),\n            boxShadow: [\n              BoxShadow(\n                color: theme.primaryColor.withValues(alpha: 0.2),\n                blurRadius: 7.r,\n                offset: Offset(0, 4.h),\n                spreadRadius: 0.6.r,\n              ),\n              BoxShadow(\n                color: Colors.grey.withValues(alpha: 0.15),\n                blurRadius: 4.r,\n                offset: Offset(0, 2.h),\n              ),\n            ],\n          ),\n          child: Column(\n            mainAxisAlignment: MainAxisAlignment.center,\n            children: [\n              AnimatedContainer(\n                duration: const Duration(milliseconds: 200),\n                width: 14.w, // Ù…Ù‚Ù„Ù„ Ø¨Ù†Ø³Ø¨Ø© 40% Ù…Ù† 24.w\n                height: 14.h, // Ù…Ù‚Ù„Ù„ Ø¨Ù†Ø³Ø¨Ø© 40% Ù…Ù† 24.h\n                padding: EdgeInsets.all(3.r),\n                decoration: BoxDecoration(\n                  color: theme.primaryColor.withValues(alpha: 0.15),\n                  borderRadius: BorderRadius.circular(4.r),\n                  border: Border.all(\n                    color: theme.primaryColor.withValues(alpha: 0.3),\n                    width: 0.4.w,\n                  ),\n                  boxShadow: [\n                    BoxShadow(\n                      color: theme.primaryColor.withValues(alpha: 0.1),\n                      blurRadius: 1.5.r,\n                      offset: Offset(0, 0.8.h),\n                    ),\n                  ],\n                ),\n                child: Icon(\n                  Icons.close,\n                  color: theme.primaryColor,\n                  size: 7.sp, // Ù…Ù‚Ù„Ù„ Ø¨Ù†Ø³Ø¨Ø© 40% Ù…Ù† 12sp\n                ),\n              ),\n              SizedBox(height: 1.h),\n              Text(\n                'Ø¥ØºÙ„Ø§Ù‚',\n                style: TextStyle(\n                  color: theme.primaryColor,\n                  fontSize: 3.6.sp, // Ù…Ù‚Ù„Ù„ Ø¨Ù†Ø³Ø¨Ø© 40% Ù…Ù† 6sp\n                  fontWeight: FontWeight.w600,\n                  shadows: [\n                    Shadow(\n                      color: Colors.black.withValues(alpha: 0.1),\n                      offset: Offset(0, 0.4.h),\n                      blurRadius: 0.8.r,\n                    ),\n                  ],\n                ),\n              ),\n            ],\n          ),\n        ),\n      ),\n    );\n  }\n\n  /// Ù…Ø­ØªÙˆÙ‰ ÙÙ„ØªØ± Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯\n  Widget _buildBrandFilterContent(BrandFilterController controller, ThemeData theme) {\n    return FadeTransition(\n      opacity: controller.fadeAnimation,\n      child: SlideTransition(\n        position: Tween<Offset>(\n          begin: const Offset(0, 0.3),\n          end: Offset.zero,\n        ).animate(controller.slideAnimation),\n        child: ScaleTransition(\n          scale: controller.scaleAnimation,\n          child: Column(\n            crossAxisAlignment: CrossAxisAlignment.start,\n            children: [\n              // Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø´Ø±ÙƒØ§Øª\n              _buildSectionTitle('Ø§Ù„Ø´Ø±ÙƒØ§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©', theme),\n              const SizedBox(height: 12),\n              \n              // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø´Ø±ÙƒØ§Øª\n              _buildCompaniesGrid(controller, theme),\n              \n              // Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ÙØ±Ø¹ÙŠØ© Ù„Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©\n              Obx(() => controller.selectedCompany.value != null\n                  ? Column(\n                      crossAxisAlignment: CrossAxisAlignment.start,\n                      children: [\n                        const SizedBox(height: 20),\n                        _buildSectionTitle(\n                          'Ù…Ù†ØªØ¬Ø§Øª ${controller.selectedCompany.value!.nameAr}', \n                          theme\n                        ),\n                        const SizedBox(height: 12),\n                        _buildCompanyProductsGrid(controller, theme),\n                      ],\n                    )\n                  : const SizedBox.shrink()),\n            ],\n          ),\n        ),\n      ),\n    );\n  }\n\n  /// Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‚Ø³Ù…\n  Widget _buildSectionTitle(String title, ThemeData theme) {\n    return Text(\n      title,\n      style: TextStyle(\n        fontSize: 18,\n        fontWeight: FontWeight.bold,\n        color: theme.primaryColor,\n        shadows: [\n          Shadow(\n            color: Colors.black.withValues(alpha: 0.1),\n            offset: const Offset(0, 1),\n            blurRadius: 2,\n          ),\n        ],\n      ),\n    );\n  }\n\n  /// Ø´Ø¨ÙƒØ© Ø§Ù„Ø´Ø±ÙƒØ§Øª\n  Widget _buildCompaniesGrid(BrandFilterController controller, ThemeData theme) {\n    return Obx(() {\n      if (controller.isLoading.value) {\n        return SizedBox(\n          height: 100,\n          child: const Center(child: CircularProgressIndicator()),\n        );\n      }\n\n      if (controller.companies.isEmpty) {\n        return SizedBox(\n          height: 100,\n          child: const Center(\n            child: Text(\n              'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø´Ø±ÙƒØ§Øª Ù…ØªØ§Ø­Ø©',\n              style: TextStyle(color: Colors.grey, fontSize: 16),\n            ),\n          ),\n        );\n      }\n\n      return SizedBox(\n        height: 170,\n        child: ListView.builder(\n          scrollDirection: Axis.horizontal,\n          itemCount: controller.companies.length,\n          itemBuilder: (context, index) {\n            final company = controller.companies[index];\n            final isSelected = controller.selectedCompany.value?.id == company.id;\n            \n            return _buildCompanyCard(controller, company, isSelected, theme);\n          },\n        ),\n      );\n    });\n  }\n\n  /// Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø´Ø±ÙƒØ© Ù…Ø¹ Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø¨ØµØ±ÙŠØ©\n  Widget _buildCompanyCard(\n    BrandFilterController controller,\n    CompanyModel company,\n    bool isSelected,\n    ThemeData theme,\n  ) {\n    return _CompanyCardTappable(\n      key: ValueKey(company.id), // Ù…ÙØªØ§Ø­ Ù„Ø¶Ù…Ø§Ù† Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„ØµØ­ÙŠØ­Ø©\n      company: company,\n      isSelected: isSelected,\n      theme: theme,\n      onTap: () {\n        controller.selectCompany(company);\n      },\n    );\n  }\n\n  /// Ù…Ø­ØªÙˆÙ‰ ÙƒÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª\n  Widget _buildAllProductsButton(BrandFilterController controller, BarcodeFilterController barcodeController, ThemeData theme) {\n    return const SizedBox.shrink();\n  }\n\n  /// Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯\n  Widget _buildBarcodeSearchContent(BarcodeFilterController barcodeController, ThemeData theme) {\n    return FadeTransition(\n      opacity: AlwaysStoppedAnimation(1.0),\n      child: BarcodeSearchWidget(\n        controller: barcodeController,\n        theme: theme,\n      ),\n    );\n  }\n\n\n\n\n  /// Ø´Ø¨ÙƒØ© Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ©\n  Widget _buildCompanyProductsGrid(BrandFilterController controller, ThemeData theme) {\n    return Obx(() {\n      if (controller.selectedCompanyProducts.isEmpty) {\n        return SizedBox(\n          height: 80,\n          child: const Center(\n            child: Text(\n              'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø´Ø±ÙƒØ©',\n              style: TextStyle(color: Colors.grey, fontSize: 14),\n            ),\n          ),\n        );\n      }\n\n      return SizedBox(\n        height: 140,\n        child: ListView.builder(\n          scrollDirection: Axis.horizontal,\n          itemCount: controller.selectedCompanyProducts.length,\n          itemBuilder: (context, index) {\n            final product = controller.selectedCompanyProducts[index];\n            final isSelected = controller.selectedCompanyProduct.value?.id == product.id;\n            \n            return _buildCompanyProductCard(controller, product, isSelected, theme);\n          },\n        ),\n      );\n    });\n  }\n\n  /// Ø¨Ø·Ø§Ù‚Ø© Ù…Ù†ØªØ¬ Ø§Ù„Ø´Ø±ÙƒØ© Ù…Ø¹ Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø¨ØµØ±ÙŠØ©\n  Widget _buildCompanyProductCard(\n    BrandFilterController controller,\n    CompanyProductModel product,\n    bool isSelected,\n    ThemeData theme,\n  ) {\n    return _ProductCardTappable(\n      key: ValueKey(product.id),\n      product: product,\n      isSelected: isSelected,\n      theme: theme,\n      onTap: () {\n        controller.selectCompanyProduct(product);\n      },\n    );\n  }\n}\n\n/// ÙˆÙŠØ¯Ø¬Øª Ù…Ø®ØµØµ Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø´Ø±ÙƒØ© Ù…Ø¹ ØªØ£Ø«ÙŠØ±Ø§Øª Ø¨ØµØ±ÙŠØ© Ù…Ø­Ø³Ù†Ø©\nclass _CompanyCardTappable extends StatefulWidget {\n  final CompanyModel company;\n  final bool isSelected;\n  final ThemeData theme;\n  final VoidCallback onTap;\n\n  const _CompanyCardTappable({\n    super.key,\n    required this.company,\n    required this.isSelected,\n    required this.theme,\n    required this.onTap,\n  });\n\n  @override\n  State<_CompanyCardTappable> createState() => _CompanyCardTappableState();\n}\n\nclass _CompanyCardTappableState extends State<_CompanyCardTappable> {\n  @override\n  Widget build(BuildContext context) {\n    final bool showAsSelected = widget.isSelected;\n\n    return GestureDetector(\n      onTap: () {\n        HapticFeedback.mediumImpact();\n        debugPrint('ğŸ–±ï¸ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙƒØ©: ${widget.company.nameAr}');\n        widget.onTap();\n      },\n      child: AnimatedContainer(\n        duration: const Duration(milliseconds: 300),\n        curve: Curves.easeInOutBack,\n        width: 130,\n        height: 160,\n        margin: const EdgeInsets.only(right: 16),\n        decoration: BoxDecoration(\n          borderRadius: BorderRadius.circular(25),\n          boxShadow: showAsSelected\n              ? [\n                  BoxShadow(\n                    color: widget.theme.primaryColor.withValues(alpha: 0.4),\n                    blurRadius: 25,\n                    offset: const Offset(0, 15),\n                    spreadRadius: 5,\n                  ),\n                  BoxShadow(\n                    color: widget.theme.primaryColor.withValues(alpha: 0.2),\n                    blurRadius: 15,\n                    offset: const Offset(0, 8),\n                  ),\n                ]\n              : [\n                  BoxShadow(\n                    color: Colors.grey.withValues(alpha: 0.3),\n                    blurRadius: 15,\n                    offset: const Offset(0, 8),\n                  ),\n                  BoxShadow(\n                    color: Colors.grey.withValues(alpha: 0.1),\n                    blurRadius: 8,\n                    offset: const Offset(0, 4),\n                  ),\n                ],\n        ),\n        child: Material(\n          elevation: 0,\n          borderRadius: BorderRadius.circular(25),\n          color: Colors.transparent,\n          child: Stack(\n            children: [\n              // Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù…Ø¹ Ø§Ù„ØµÙˆØ±Ø©\n              Positioned.fill(\n                child: ClipRRect(\n                  borderRadius: BorderRadius.circular(25),\n                  child: widget.company.logoUrl != null && widget.company.logoUrl!.isNotEmpty\n                      ? CachedNetworkImage(\n                          imageUrl: widget.company.logoUrl!,\n                          fit: BoxFit.cover,\n                          placeholder: (context, url) => Container(\n                            decoration: BoxDecoration(\n                              gradient: LinearGradient(\n                                colors: [\n                                  Colors.grey.shade300,\n                                  Colors.grey.shade500,\n                                ],\n                                begin: Alignment.topLeft,\n                                end: Alignment.bottomRight,\n                              ),\n                            ),\n                            child: const Center(\n                              child: Icon(Icons.business, color: Colors.white, size: 40),\n                            ),\n                          ),\n                          errorWidget: (context, url, error) => Container(\n                            decoration: BoxDecoration(\n                              gradient: LinearGradient(\n                                colors: [\n                                  Colors.grey.shade300,\n                                  Colors.grey.shade500,\n                                ],\n                                begin: Alignment.topLeft,\n                                end: Alignment.bottomRight,\n                              ),\n                            ),\n                            child: const Center(\n                              child: Icon(Icons.business, color: Colors.white, size: 40),\n                            ),\n                          ),\n                        )\n                      : Container(\n                          decoration: BoxDecoration(\n                            gradient: LinearGradient(\n                              colors: [\n                                Colors.grey.shade300,\n                                Colors.grey.shade500,\n                              ],\n                              begin: Alignment.topLeft,\n                              end: Alignment.bottomRight,\n                            ),\n                          ),\n                          child: const Center(\n                            child: Icon(Icons.business, color: Colors.white, size: 40),\n                          ),\n                        ),\n                ),\n              ),\n              \n              // Ø·Ø¨Ù‚Ø© Ø§Ù„ØªØ¯Ø±Ø¬ Ù„Ù„Ù†Øµ\n              Positioned.fill(\n                child: Container(\n                  decoration: BoxDecoration(\n                    borderRadius: BorderRadius.circular(25),\n                    gradient: LinearGradient(\n                      colors: [\n                        Colors.transparent,\n                        Colors.transparent,\n                        Colors.black.withValues(alpha: 0.7),\n                        Colors.black.withValues(alpha: 0.9),\n                      ],\n                      begin: Alignment.topCenter,\n                      end: Alignment.bottomCenter,\n                      stops: const [0.0, 0.4, 0.8, 1.0],\n                    ),\n                  ),\n                ),\n              ),\n              \n              // Ø¥Ø·Ø§Ø± Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±\n              if (showAsSelected)\n                Positioned.fill(\n                  child: Container(\n                    decoration: BoxDecoration(\n                      borderRadius: BorderRadius.circular(25),\n                      border: Border.all(\n                        color: widget.theme.primaryColor,\n                        width: 4,\n                      ),\n                    ),\n                  ),\n                ),\n              \n              // Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±\n              if (showAsSelected)\n                Positioned(\n                  top: 8,\n                  right: 8,\n                  child: AnimatedScale(\n                    duration: const Duration(milliseconds: 300),\n                    scale: showAsSelected ? 1.0 : 0.0,\n                    child: Container(\n                      padding: const EdgeInsets.all(4),\n                      decoration: const BoxDecoration(\n                        color: Colors.white,\n                        shape: BoxShape.circle,\n                      ),\n                      child: Container(\n                        width: 28,\n                        height: 28,\n                        decoration: BoxDecoration(\n                          color: widget.theme.primaryColor,\n                          shape: BoxShape.circle,\n                        ),\n                        child: const Icon(\n                          Icons.check,\n                          color: Colors.white,\n                          size: 18,\n                        ),\n                      ),\n                    ),\n                  ),\n                ),\n              \n              // Ø§Ù„Ù†Øµ ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„\n              Positioned(\n                bottom: 0,\n                left: 0,\n                right: 0,\n                child: Container(\n                  padding: const EdgeInsets.all(16),\n                  child: Text(\n                    widget.company.nameAr,\n                    style: TextStyle(\n                      fontSize: 16,\n                      fontWeight: FontWeight.bold,\n                      color: Colors.white,\n                      shadows: [\n                        Shadow(\n                          color: Colors.black.withValues(alpha: 0.8),\n                          offset: const Offset(1, 1),\n                          blurRadius: 4,\n                        ),\n                      ],\n                    ),\n                    textAlign: TextAlign.center,\n                    maxLines: 2,\n                    overflow: TextOverflow.ellipsis,\n                  ),\n                ),\n              ),\n              \n              // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±\n              if (showAsSelected)\n                Positioned.fill(\n                  child: Container(\n                    decoration: BoxDecoration(\n                      borderRadius: BorderRadius.circular(25),\n                      gradient: RadialGradient(\n                        center: Alignment.center,\n                        colors: [\n                          widget.theme.primaryColor.withValues(alpha: 0.2),\n                          widget.theme.primaryColor.withValues(alpha: 0.1),\n                          Colors.transparent,\n                        ],\n                      ),\n                    ),\n                  ),\n                ),\n            ],\n          ),\n        ),\n      ),\n    );\n  }\n}\n\n/// ÙˆÙŠØ¯Ø¬Øª Ù…Ø®ØµØµ Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ø¹ ØªØ£Ø«ÙŠØ±Ø§Øª Ø¨ØµØ±ÙŠØ© Ù…Ø­Ø³Ù†Ø©\nclass _ProductCardTappable extends StatefulWidget {\n  final CompanyProductModel product;\n  final bool isSelected;\n  final ThemeData theme;\n  final VoidCallback onTap;\n\n  const _ProductCardTappable({\n    super.key,\n    required this.product,\n    required this.isSelected,\n    required this.theme,\n    required this.onTap,\n  });\n\n  @override\n  State<_ProductCardTappable> createState() => _ProductCardTappableState();\n}\n\nclass _ProductCardTappableState extends State<_ProductCardTappable> {\n  @override\n  Widget build(BuildContext context) {\n    final bool showAsSelected = widget.isSelected;\n\n    return GestureDetector(\n      onTap: () {\n        HapticFeedback.lightImpact();\n        debugPrint('ğŸ–±ï¸ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØªØ¬: ${widget.product.nameAr}');\n        widget.onTap();\n      },\n      child: AnimatedContainer(\n        duration: const Duration(milliseconds: 300),\n        curve: Curves.easeInOutBack,\n        width: 110,\n        height: 130,\n        margin: const EdgeInsets.only(right: 12),\n        decoration: BoxDecoration(\n          borderRadius: BorderRadius.circular(20),\n          boxShadow: showAsSelected\n              ? [\n                  BoxShadow(\n                    color: widget.theme.primaryColor.withValues(alpha: 0.4),\n                    blurRadius: 20,\n                    offset: const Offset(0, 12),\n                    spreadRadius: 3,\n                  ),\n                  BoxShadow(\n                    color: widget.theme.primaryColor.withValues(alpha: 0.2),\n                    blurRadius: 12,\n                    offset: const Offset(0, 6),\n                  ),\n                ]\n              : [\n                  BoxShadow(\n                    color: Colors.grey.withValues(alpha: 0.2),\n                    blurRadius: 12,\n                    offset: const Offset(0, 6),\n                  ),\n                  BoxShadow(\n                    color: Colors.grey.withValues(alpha: 0.1),\n                    blurRadius: 6,\n                    offset: const Offset(0, 3),\n                  ),\n                ],\n        ),\n        child: Material(\n          elevation: 0,\n          borderRadius: BorderRadius.circular(20),\n          color: Colors.transparent,\n          child: Stack(\n            children: [\n              // Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù…Ø¹ Ø§Ù„ØµÙˆØ±Ø©\n              Positioned.fill(\n                child: ClipRRect(\n                  borderRadius: BorderRadius.circular(20),\n                  child: widget.product.imageUrl != null && widget.product.imageUrl!.isNotEmpty\n                      ? CachedNetworkImage(\n                          imageUrl: widget.product.imageUrl!,\n                          fit: BoxFit.cover,\n                          placeholder: (context, url) => Container(\n                            decoration: BoxDecoration(\n                              gradient: LinearGradient(\n                                colors: [\n                                  Colors.grey.shade300,\n                                  Colors.grey.shade400,\n                                ],\n                                begin: Alignment.topLeft,\n                                end: Alignment.bottomRight,\n                              ),\n                            ),\n                            child: const Center(\n                              child: Icon(Icons.inventory_2, color: Colors.white, size: 30),\n                            ),\n                          ),\n                          errorWidget: (context, url, error) => Container(\n                            decoration: BoxDecoration(\n                              gradient: LinearGradient(\n                                colors: [\n                                  Colors.grey.shade300,\n                                  Colors.grey.shade400,\n                                ],\n                                begin: Alignment.topLeft,\n                                end: Alignment.bottomRight,\n                              ),\n                            ),\n                            child: const Center(\n                              child: Icon(Icons.inventory_2, color: Colors.white, size: 30),\n                            ),\n                          ),\n                        )\n                      : Container(\n                          decoration: BoxDecoration(\n                            gradient: LinearGradient(\n                              colors: [\n                                Colors.grey.shade300,\n                                Colors.grey.shade400,\n                              ],\n                              begin: Alignment.topLeft,\n                              end: Alignment.bottomRight,\n                            ),\n                          ),\n                          child: const Center(\n                            child: Icon(Icons.inventory_2, color: Colors.white, size: 30),\n                          ),\n                        ),\n                ),\n              ),\n              \n              // Ø·Ø¨Ù‚Ø© Ø§Ù„ØªØ¯Ø±Ø¬ Ù„Ù„Ù†Øµ\n              Positioned.fill(\n                child: Container(\n                  decoration: BoxDecoration(\n                    borderRadius: BorderRadius.circular(20),\n                    gradient: LinearGradient(\n                      colors: [\n                        Colors.transparent,\n                        Colors.transparent,\n                        Colors.black.withValues(alpha: 0.6),\n                        Colors.black.withValues(alpha: 0.85),\n                      ],\n                      begin: Alignment.topCenter,\n                      end: Alignment.bottomCenter,\n                      stops: const [0.0, 0.5, 0.8, 1.0],\n                    ),\n                  ),\n                ),\n              ),\n              \n              // Ø¥Ø·Ø§Ø± Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±\n              if (showAsSelected)\n                Positioned.fill(\n                  child: Container(\n                    decoration: BoxDecoration(\n                      borderRadius: BorderRadius.circular(20),\n                      border: Border.all(\n                        color: widget.theme.primaryColor,\n                        width: 3,\n                      ),\n                    ),\n                  ),\n                ),\n              \n              // Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±\n              if (showAsSelected)\n                Positioned(\n                  top: 6,\n                  right: 6,\n                  child: AnimatedScale(\n                    duration: const Duration(milliseconds: 300),\n                    scale: showAsSelected ? 1.0 : 0.0,\n                    child: Container(\n                      padding: const EdgeInsets.all(3),\n                      decoration: const BoxDecoration(\n                        color: Colors.white,\n                        shape: BoxShape.circle,\n                      ),\n                      child: Container(\n                        width: 24,\n                        height: 24,\n                        decoration: BoxDecoration(\n                          color: widget.theme.primaryColor,\n                          shape: BoxShape.circle,\n                        ),\n                        child: const Icon(\n                          Icons.check,\n                          color: Colors.white,\n                          size: 16,\n                        ),\n                      ),\n                    ),\n                  ),\n                ),\n              \n              // Ø§Ù„Ù†Øµ ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„\n              Positioned(\n                bottom: 0,\n                left: 0,\n                right: 0,\n                child: Container(\n                  padding: const EdgeInsets.all(12),\n                  child: Text(\n                    widget.product.nameAr,\n                    style: TextStyle(\n                      fontSize: 14,\n                      fontWeight: FontWeight.bold,\n                      color: Colors.white,\n                      shadows: [\n                        Shadow(\n                          color: Colors.black.withValues(alpha: 0.8),\n                          offset: const Offset(1, 1),\n                          blurRadius: 3,\n                        ),\n                      ],\n                    ),\n                    textAlign: TextAlign.center,\n                    maxLines: 2,\n                    overflow: TextOverflow.ellipsis,\n                  ),\n                ),\n              ),\n              \n              // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±\n              if (showAsSelected)\n                Positioned.fill(\n                  child: Container(\n                    decoration: BoxDecoration(\n                      borderRadius: BorderRadius.circular(20),\n                      gradient: RadialGradient(\n                        center: Alignment.center,\n                        colors: [\n                          widget.theme.primaryColor.withValues(alpha: 0.15),\n                          widget.theme.primaryColor.withValues(alpha: 0.08),\n                          Colors.transparent,\n                        ],\n                      ),\n                    ),\n                  ),\n                ),\n            ],\n          ),\n        ),\n      ),\n    );\n  }\n}"
        }
    ]
}