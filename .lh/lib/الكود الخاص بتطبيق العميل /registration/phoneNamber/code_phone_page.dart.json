{
    "sourceFile": "lib/الكود الخاص بتطبيق العميل /registration/phoneNamber/code_phone_page.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1752751503159,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1752752575227,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,22 +1,22 @@\n import 'package:flutter/material.dart';\n import 'package:flutter/services.dart';\n import 'package:get/get.dart';\n-import 'dart:typed_data';\n \n import 'controllers/code_phone_controller.dart';\n import 'widgets/code_input_field.dart';\n+import '../../core/error_display_manager.dart';\n \n /// صفحة إدخال رمز التحقق المحسنة\n-class CodePhonePage1 extends StatelessWidget {\n+class CodePhonePage extends StatelessWidget {\n   final String phoneNumber;\n   final Uint8List userImage;\n   final String name;\n   final String email;\n   final String password;\n   final bool hasPassword;\n \n-  const CodePhonePage1({\n+  const CodePhonePage({\n     super.key,\n     required this.phoneNumber,\n     required this.userImage,\n     required this.name,\n@@ -38,326 +38,718 @@\n       ),\n     );\n \n     return Scaffold(\n-      backgroundColor: Colors.grey.shade50,\n+      backgroundColor: Colors.transparent,\n+      extendBodyBehindAppBar: true,\n       appBar: AppBar(\n         backgroundColor: Colors.transparent,\n         elevation: 0,\n-        leading: IconButton(\n-          icon: const Icon(Icons.arrow_back_ios, color: Colors.black87),\n-          onPressed: () => Get.back(),\n+        leading: Container(\n+          margin: const EdgeInsets.all(8),\n+          decoration: BoxDecoration(\n+            color: Colors.white.withOpacity(0.9),\n+            borderRadius: BorderRadius.circular(12),\n+            boxShadow: [\n+              BoxShadow(\n+                color: Colors.black.withOpacity(0.1),\n+                blurRadius: 10,\n+                offset: const Offset(0, 2),\n+              ),\n+            ],\n+          ),\n+          child: IconButton(\n+            icon: const Icon(Icons.arrow_back_ios, color: Colors.black87),\n+            onPressed: () => _handleBackPress(),\n+          ),\n         ),\n-        title: const Text(\n-          'تأكيد رقم الهاتف',\n-          style: TextStyle(color: Colors.black87, fontWeight: FontWeight.bold),\n+        title: Container(\n+          padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),\n+          decoration: BoxDecoration(\n+            color: Colors.white.withOpacity(0.9),\n+            borderRadius: BorderRadius.circular(20),\n+            boxShadow: [\n+              BoxShadow(\n+                color: Colors.black.withOpacity(0.1),\n+                blurRadius: 10,\n+                offset: const Offset(0, 2),\n+              ),\n+            ],\n+          ),\n+          child: const Text(\n+            'تأكيد رقم الهاتف',\n+            style: TextStyle(\n+              color: Colors.black87,\n+              fontWeight: FontWeight.bold,\n+              fontSize: 18,\n+            ),\n+          ),\n         ),\n         centerTitle: true,\n       ),\n-      body: SafeArea(\n-        child: Padding(\n-          padding: const EdgeInsets.all(24.0),\n-          child: Column(\n-            children: [\n-              Expanded(\n-                child: SingleChildScrollView(\n-                  child: Column(\n-                    children: [\n-                      _buildHeader(),\n-                      const SizedBox(height: 40),\n-                      _buildCodeInputSection(controller),\n-                      const SizedBox(height: 30),\n-                      _buildResendSection(controller),\n-                      const SizedBox(height: 40),\n-                      _buildStatusSection(controller),\n-                    ],\n+      body: Container(\n+        decoration: const BoxDecoration(\n+          image: DecorationImage(\n+            image: AssetImage('assets/logo.png'),\n+            fit: BoxFit.cover,\n+            opacity: 0.1,\n+          ),\n+          gradient: LinearGradient(\n+            begin: Alignment.topLeft,\n+            end: Alignment.bottomRight,\n+            colors: [Color(0xFFF8FBFF), Color(0xFFE3F2FD), Color(0xFFF1F8FF)],\n+          ),\n+        ),\n+        child: SafeArea(\n+          child: Padding(\n+            padding: const EdgeInsets.all(24.0),\n+            child: Column(\n+              children: [\n+                Expanded(\n+                  child: SingleChildScrollView(\n+                    physics: const BouncingScrollPhysics(),\n+                    child: Column(\n+                      children: [\n+                        const SizedBox(height: 20),\n+                        _buildEnhancedHeader(),\n+                        const SizedBox(height: 40),\n+                        _buildCodeInputSection(controller),\n+                        const SizedBox(height: 30),\n+                        _buildResendSection(controller),\n+                        const SizedBox(height: 40),\n+                        _buildEnhancedStatusSection(controller),\n+                        const SizedBox(height: 20),\n+                        _buildErrorSection(controller),\n+                      ],\n+                    ),\n                   ),\n                 ),\n-              ),\n-              _buildBottomSection(controller),\n-            ],\n+                _buildEnhancedBottomSection(controller),\n+              ],\n+            ),\n           ),\n         ),\n       ),\n     );\n   }\n \n-  /// قسم العنوان والوصف\n-  Widget _buildHeader() {\n-    return Column(\n-      children: [\n-        Container(\n-          padding: const EdgeInsets.all(20),\n-          decoration: BoxDecoration(\n-            color: Colors.blue.shade100,\n-            shape: BoxShape.circle,\n+  /// معالجة الضغط على زر الرجوع مع تأكيد\n+  void _handleBackPress() {\n+    ErrorDisplayManager.showErrorDialog(\n+      title: 'تأكيد الخروج',\n+      message:\n+          'هل أنت متأكد من الرغبة في الخروج؟ ستفقد التقدم الحالي في التحقق.',\n+      onRetry: () => Get.back(),\n+      onCancel: () {}, // إلغاء الخروج\n+    );\n+  }\n+\n+  /// قسم العنوان المحسن مع صورة الخلفية\n+  Widget _buildEnhancedHeader() {\n+    return Container(\n+      padding: const EdgeInsets.all(24),\n+      decoration: BoxDecoration(\n+        color: Colors.white.withOpacity(0.95),\n+        borderRadius: BorderRadius.circular(24),\n+        boxShadow: [\n+          BoxShadow(\n+            color: Colors.blue.withOpacity(0.1),\n+            blurRadius: 20,\n+            offset: const Offset(0, 8),\n           ),\n-          child: Icon(\n-            Icons.sms_outlined,\n-            size: 60,\n-            color: Colors.blue.shade600,\n+        ],\n+        border: Border.all(color: Colors.blue.withOpacity(0.2), width: 1),\n+      ),\n+      child: Column(\n+        children: [\n+          Container(\n+            width: 80,\n+            height: 80,\n+            decoration: BoxDecoration(\n+              gradient: LinearGradient(\n+                begin: Alignment.topLeft,\n+                end: Alignment.bottomRight,\n+                colors: [Colors.blue.shade400, Colors.blue.shade600],\n+              ),\n+              shape: BoxShape.circle,\n+              boxShadow: [\n+                BoxShadow(\n+                  color: Colors.blue.withOpacity(0.3),\n+                  blurRadius: 15,\n+                  offset: const Offset(0, 5),\n+                ),\n+              ],\n+            ),\n+            child: const Icon(\n+              Icons.verified_user,\n+              size: 40,\n+              color: Colors.white,\n+            ),\n           ),\n-        ),\n-        const SizedBox(height: 24),\n-        const Text(\n-          'أدخل رمز التأكيد',\n-          style: TextStyle(\n-            fontSize: 28,\n-            fontWeight: FontWeight.bold,\n-            color: Colors.black87,\n+          const SizedBox(height: 20),\n+          const Text(\n+            'أدخل رمز التأكيد',\n+            style: TextStyle(\n+              fontSize: 28,\n+              fontWeight: FontWeight.bold,\n+              color: Colors.black87,\n+            ),\n           ),\n-        ),\n-        const SizedBox(height: 12),\n-        Text(\n-          'تم إرسال رمز مكون من 6 أرقام إلى',\n-          style: TextStyle(fontSize: 16, color: Colors.grey.shade600),\n-        ),\n-        const SizedBox(height: 8),\n-        Container(\n-          padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),\n-          decoration: BoxDecoration(\n-            color: Colors.blue.shade50,\n-            borderRadius: BorderRadius.circular(20),\n-            border: Border.all(color: Colors.blue.shade200),\n+          const SizedBox(height: 12),\n+          Text(\n+            'تم إرسال رمز مكون من 6 أرقام إلى',\n+            style: TextStyle(fontSize: 16, color: Colors.grey.shade600),\n           ),\n-          child: Directionality(\n-            textDirection: TextDirection.ltr,\n-            child: Text(\n-              phoneNumber,\n+          const SizedBox(height: 12),\n+          Container(\n+            padding: const EdgeInsets.symmetric(horizontal: 20, vertical: 12),\n+            decoration: BoxDecoration(\n+              gradient: LinearGradient(\n+                colors: [Colors.blue.shade50, Colors.blue.shade100],\n+              ),\n+              borderRadius: BorderRadius.circular(25),\n+              border: Border.all(color: Colors.blue.shade300),\n+              boxShadow: [\n+                BoxShadow(\n+                  color: Colors.blue.withOpacity(0.1),\n+                  blurRadius: 8,\n+                  offset: const Offset(0, 2),\n+                ),\n+              ],\n+            ),\n+            child: Row(\n+              mainAxisSize: MainAxisSize.min,\n+              children: [\n+                Icon(\n+                  Icons.phone_android,\n+                  color: Colors.blue.shade700,\n+                  size: 20,\n+                ),\n+                const SizedBox(width: 8),\n+                Directionality(\n+                  textDirection: TextDirection.ltr,\n+                  child: Text(\n+                    phoneNumber,\n+                    style: TextStyle(\n+                      fontSize: 18,\n+                      fontWeight: FontWeight.bold,\n+                      color: Colors.blue.shade700,\n+                    ),\n+                  ),\n+                ),\n+              ],\n+            ),\n+          ),\n+        ],\n+      ),\n+    );\n+  }\n+\n+  /// قسم إدخال الرمز مع تحسينات بصرية\n+  Widget _buildCodeInputSection(CodePhoneController controller) {\n+    return Container(\n+      padding: const EdgeInsets.all(24),\n+      decoration: BoxDecoration(\n+        color: Colors.white.withOpacity(0.95),\n+        borderRadius: BorderRadius.circular(20),\n+        boxShadow: [\n+          BoxShadow(\n+            color: Colors.black.withOpacity(0.05),\n+            blurRadius: 15,\n+            offset: const Offset(0, 5),\n+          ),\n+        ],\n+      ),\n+      child: Obx(\n+        () => Column(\n+          children: [\n+            Text(\n+              'أدخل الرمز المرسل',\n               style: TextStyle(\n                 fontSize: 18,\n-                fontWeight: FontWeight.bold,\n-                color: Colors.blue.shade700,\n+                fontWeight: FontWeight.w600,\n+                color: Colors.grey.shade700,\n               ),\n             ),\n-          ),\n+            const SizedBox(height: 20),\n+            Row(\n+              mainAxisAlignment: MainAxisAlignment.spaceEvenly,\n+              children: List.generate(\n+                6,\n+                (index) => CodeInputField(\n+                  controller: controller.codeControllers[index],\n+                  focusNode: controller.focusNodes[index],\n+                  isValid: controller.isCodeValid.value,\n+                  onComplete: () => controller.checkCodeOnComplete(),\n+                ),\n+              ),\n+            ),\n+            if (!controller.isCodeValid.value) ...[\n+              const SizedBox(height: 16),\n+              _buildErrorMessage('الرمز غير صحيح، يرجى المحاولة مرة أخرى'),\n+            ],\n+          ],\n         ),\n-      ],\n+      ),\n     );\n   }\n \n-  /// قسم إدخال الرمز\n-  Widget _buildCodeInputSection(CodePhoneController controller) {\n-    return Obx(\n-      () => Column(\n+  /// رسالة خطأ محسنة\n+  Widget _buildErrorMessage(String message) {\n+    return Container(\n+      padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 12),\n+      decoration: BoxDecoration(\n+        gradient: LinearGradient(\n+          colors: [Colors.red.shade50, Colors.red.shade100],\n+        ),\n+        borderRadius: BorderRadius.circular(12),\n+        border: Border.all(color: Colors.red.shade300),\n+        boxShadow: [\n+          BoxShadow(\n+            color: Colors.red.withOpacity(0.1),\n+            blurRadius: 8,\n+            offset: const Offset(0, 2),\n+          ),\n+        ],\n+      ),\n+      child: Row(\n         children: [\n-          Row(\n-            mainAxisAlignment: MainAxisAlignment.spaceEvenly,\n-            children: List.generate(\n-              6,\n-              (index) => CodeInputField(\n-                controller: controller.codeControllers[index],\n-                focusNode: controller.focusNodes[index],\n-                isValid: controller.isCodeValid.value,\n-                onComplete: () => controller.checkCodeOnComplete(),\n-              ),\n+          Container(\n+            padding: const EdgeInsets.all(6),\n+            decoration: BoxDecoration(\n+              color: Colors.red.shade600,\n+              shape: BoxShape.circle,\n             ),\n+            child: const Icon(\n+              Icons.error_outline,\n+              color: Colors.white,\n+              size: 16,\n+            ),\n           ),\n-          if (!controller.isCodeValid.value) ...[\n-            const SizedBox(height: 12),\n-            Container(\n-              padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),\n-              decoration: BoxDecoration(\n-                color: Colors.red.shade50,\n-                borderRadius: BorderRadius.circular(8),\n-                border: Border.all(color: Colors.red.shade200),\n+          const SizedBox(width: 12),\n+          Expanded(\n+            child: Text(\n+              message,\n+              style: TextStyle(\n+                color: Colors.red.shade700,\n+                fontSize: 14,\n+                fontWeight: FontWeight.w500,\n               ),\n-              child: Row(\n-                mainAxisSize: MainAxisSize.min,\n-                children: [\n-                  Icon(\n-                    Icons.error_outline,\n-                    color: Colors.red.shade600,\n-                    size: 20,\n-                  ),\n-                  const SizedBox(width: 8),\n-                  Text(\n-                    'الرمز غير صحيح، يرجى المحاولة مرة أخرى',\n-                    style: TextStyle(color: Colors.red.shade600, fontSize: 14),\n-                  ),\n-                ],\n-              ),\n             ),\n-          ],\n+          ),\n         ],\n       ),\n     );\n   }\n \n-  /// قسم إعادة الإرسال\n+  /// قسم إعادة الإرسال المحسن\n   Widget _buildResendSection(CodePhoneController controller) {\n-    return Obx(\n-      () => Column(\n-        children: [\n-          Text(\n-            'لم تتلق الرمز؟',\n-            style: TextStyle(fontSize: 16, color: Colors.grey.shade600),\n+    return Container(\n+      padding: const EdgeInsets.all(20),\n+      decoration: BoxDecoration(\n+        color: Colors.white.withOpacity(0.95),\n+        borderRadius: BorderRadius.circular(16),\n+        boxShadow: [\n+          BoxShadow(\n+            color: Colors.black.withOpacity(0.05),\n+            blurRadius: 10,\n+            offset: const Offset(0, 3),\n           ),\n-          const SizedBox(height: 12),\n-          if (controller.canResend.value)\n-            _buildResendButton(controller)\n-          else\n-            _buildResendTimer(controller),\n         ],\n       ),\n+      child: Obx(\n+        () => Column(\n+          children: [\n+            Text(\n+              'لم تتلق الرمز؟',\n+              style: TextStyle(\n+                fontSize: 16,\n+                color: Colors.grey.shade600,\n+                fontWeight: FontWeight.w500,\n+              ),\n+            ),\n+            const SizedBox(height: 16),\n+            if (controller.canResend.value)\n+              _buildEnhancedResendButton(controller)\n+            else\n+              _buildEnhancedResendTimer(controller),\n+          ],\n+        ),\n+      ),\n     );\n   }\n \n-  /// زر إعادة الإرسال\n-  Widget _buildResendButton(CodePhoneController controller) {\n-    return ElevatedButton.icon(\n-      onPressed: () => controller.resendCode(),\n-      icon: const Icon(Icons.refresh, size: 20),\n-      label: const Text(\n-        'إعادة إرسال الرمز',\n-        style: TextStyle(fontSize: 16, fontWeight: FontWeight.bold),\n+  /// زر إعادة الإرسال المحسن\n+  Widget _buildEnhancedResendButton(CodePhoneController controller) {\n+    return Container(\n+      decoration: BoxDecoration(\n+        gradient: LinearGradient(\n+          colors: [Colors.blue.shade500, Colors.blue.shade700],\n+        ),\n+        borderRadius: BorderRadius.circular(25),\n+        boxShadow: [\n+          BoxShadow(\n+            color: Colors.blue.withOpacity(0.3),\n+            blurRadius: 10,\n+            offset: const Offset(0, 5),\n+          ),\n+        ],\n       ),\n-      style: ElevatedButton.styleFrom(\n-        backgroundColor: Colors.blue.shade600,\n-        foregroundColor: Colors.white,\n-        padding: const EdgeInsets.symmetric(horizontal: 24, vertical: 12),\n-        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(25)),\n-        elevation: 2,\n+      child: ElevatedButton.icon(\n+        onPressed: () => controller.resendCode(),\n+        icon: const Icon(Icons.refresh, size: 22, color: Colors.white),\n+        label: const Text(\n+          'إعادة إرسال الرمز',\n+          style: TextStyle(\n+            fontSize: 16,\n+            fontWeight: FontWeight.bold,\n+            color: Colors.white,\n+          ),\n+        ),\n+        style: ElevatedButton.styleFrom(\n+          backgroundColor: Colors.transparent,\n+          shadowColor: Colors.transparent,\n+          padding: const EdgeInsets.symmetric(horizontal: 28, vertical: 14),\n+          shape: RoundedRectangleBorder(\n+            borderRadius: BorderRadius.circular(25),\n+          ),\n+        ),\n       ),\n     );\n   }\n \n-  /// مؤقت إعادة الإرسال\n-  Widget _buildResendTimer(CodePhoneController controller) {\n+  /// مؤقت إعادة الإرسال المحسن\n+  Widget _buildEnhancedResendTimer(CodePhoneController controller) {\n     return Container(\n-      padding: const EdgeInsets.symmetric(horizontal: 20, vertical: 12),\n+      padding: const EdgeInsets.symmetric(horizontal: 24, vertical: 16),\n       decoration: BoxDecoration(\n-        color: Colors.orange.shade50,\n+        gradient: LinearGradient(\n+          colors: [Colors.orange.shade100, Colors.orange.shade200],\n+        ),\n         borderRadius: BorderRadius.circular(20),\n-        border: Border.all(color: Colors.orange.shade200),\n+        border: Border.all(color: Colors.orange.shade300),\n+        boxShadow: [\n+          BoxShadow(\n+            color: Colors.orange.withOpacity(0.2),\n+            blurRadius: 8,\n+            offset: const Offset(0, 3),\n+          ),\n+        ],\n       ),\n       child: Row(\n         mainAxisSize: MainAxisSize.min,\n         children: [\n-          Icon(Icons.timer_outlined, color: Colors.orange.shade600, size: 20),\n-          const SizedBox(width: 8),\n-          Text(\n-            'إعادة الإرسال خلال ${controller.resendCounter.value} ثانية',\n-            style: TextStyle(\n-              color: Colors.orange.shade700,\n-              fontSize: 16,\n-              fontWeight: FontWeight.w500,\n+          Container(\n+            padding: const EdgeInsets.all(8),\n+            decoration: BoxDecoration(\n+              color: Colors.orange.shade600,\n+              shape: BoxShape.circle,\n             ),\n+            child: const Icon(Icons.timer, color: Colors.white, size: 18),\n           ),\n+          const SizedBox(width: 12),\n+          Column(\n+            crossAxisAlignment: CrossAxisAlignment.start,\n+            mainAxisSize: MainAxisSize.min,\n+            children: [\n+              Text(\n+                'إعادة الإرسال متاحة خلال',\n+                style: TextStyle(\n+                  color: Colors.orange.shade800,\n+                  fontSize: 12,\n+                  fontWeight: FontWeight.w500,\n+                ),\n+              ),\n+              Text(\n+                '${controller.resendCounter.value} ثانية',\n+                style: TextStyle(\n+                  color: Colors.orange.shade900,\n+                  fontSize: 18,\n+                  fontWeight: FontWeight.bold,\n+                ),\n+              ),\n+            ],\n+          ),\n         ],\n       ),\n     );\n   }\n \n-  /// قسم حالة العملية\n-  Widget _buildStatusSection(CodePhoneController controller) {\n+  /// قسم حالة العملية المحسن\n+  Widget _buildEnhancedStatusSection(CodePhoneController controller) {\n     return Obx(() {\n       if (!controller.isLoading.value &&\n           controller.statusMessage.value.isEmpty) {\n         return const SizedBox.shrink();\n       }\n \n-      return Column(\n-        children: [\n-          if (controller.isLoading.value) ...[\n-            Container(\n-              padding: const EdgeInsets.all(20),\n-              decoration: BoxDecoration(\n-                color: Colors.blue.shade50,\n-                borderRadius: BorderRadius.circular(16),\n-                border: Border.all(color: Colors.blue.shade200),\n+      return Container(\n+        padding: const EdgeInsets.all(24),\n+        decoration: BoxDecoration(\n+          color: Colors.white.withOpacity(0.95),\n+          borderRadius: BorderRadius.circular(20),\n+          boxShadow: [\n+            BoxShadow(\n+              color: Colors.blue.withOpacity(0.1),\n+              blurRadius: 15,\n+              offset: const Offset(0, 5),\n+            ),\n+          ],\n+        ),\n+        child: Column(\n+          children: [\n+            if (controller.isLoading.value) ...[\n+              Container(\n+                width: 60,\n+                height: 60,\n+                decoration: BoxDecoration(\n+                  gradient: LinearGradient(\n+                    colors: [Colors.blue.shade400, Colors.blue.shade600],\n+                  ),\n+                  shape: BoxShape.circle,\n+                ),\n+                child: const Center(\n+                  child: CircularProgressIndicator(\n+                    valueColor: AlwaysStoppedAnimation<Color>(Colors.white),\n+                    strokeWidth: 3,\n+                  ),\n+                ),\n               ),\n-              child: Column(\n-                children: [\n-                  CircularProgressIndicator(\n-                    valueColor: AlwaysStoppedAnimation<Color>(\n-                      Colors.blue.shade600,\n-                    ),\n+              const SizedBox(height: 20),\n+              if (controller.statusMessage.value.isNotEmpty) ...[\n+                Text(\n+                  controller.statusMessage.value,\n+                  style: TextStyle(\n+                    color: Colors.blue.shade700,\n+                    fontSize: 16,\n+                    fontWeight: FontWeight.w600,\n                   ),\n-                  if (controller.statusMessage.value.isNotEmpty) ...[\n-                    const SizedBox(height: 16),\n-                    Text(\n-                      controller.statusMessage.value,\n-                      style: TextStyle(\n-                        color: Colors.blue.shade700,\n-                        fontSize: 16,\n-                        fontWeight: FontWeight.w500,\n+                  textAlign: TextAlign.center,\n+                ),\n+                const SizedBox(height: 16),\n+              ],\n+              if (controller.progress.value > 0) ...[\n+                Container(\n+                  height: 8,\n+                  decoration: BoxDecoration(\n+                    color: Colors.blue.shade100,\n+                    borderRadius: BorderRadius.circular(4),\n+                  ),\n+                  child: FractionallySizedBox(\n+                    widthFactor: controller.progress.value,\n+                    child: Container(\n+                      decoration: BoxDecoration(\n+                        gradient: LinearGradient(\n+                          colors: [Colors.blue.shade400, Colors.blue.shade600],\n+                        ),\n+                        borderRadius: BorderRadius.circular(4),\n                       ),\n-                      textAlign: TextAlign.center,\n                     ),\n-                  ],\n-                  if (controller.progress.value > 0) ...[\n-                    const SizedBox(height: 16),\n-                    LinearProgressIndicator(\n-                      value: controller.progress.value,\n-                      backgroundColor: Colors.blue.shade100,\n-                      valueColor: AlwaysStoppedAnimation<Color>(\n-                        Colors.blue.shade600,\n-                      ),\n-                    ),\n-                    const SizedBox(height: 8),\n-                    Text(\n-                      '${(controller.progress.value * 100).toInt()}%',\n-                      style: TextStyle(\n-                        color: Colors.blue.shade600,\n-                        fontSize: 14,\n-                        fontWeight: FontWeight.bold,\n-                      ),\n-                    ),\n-                  ],\n-                ],\n-              ),\n-            ),\n+                  ),\n+                ),\n+                const SizedBox(height: 8),\n+                Text(\n+                  '${(controller.progress.value * 100).toInt()}%',\n+                  style: TextStyle(\n+                    color: Colors.blue.shade600,\n+                    fontSize: 14,\n+                    fontWeight: FontWeight.bold,\n+                  ),\n+                ),\n+              ],\n+            ],\n           ],\n-        ],\n+        ),\n       );\n     });\n   }\n \n-  /// القسم السفلي\n-  Widget _buildBottomSection(CodePhoneController controller) {\n+  /// قسم الأخطاء المتقدم\n+  Widget _buildErrorSection(CodePhoneController controller) {\n+    return Obx(() {\n+      // يمكن إضافة منطق معقد لعرض الأخطاء هنا\n+      return const SizedBox.shrink();\n+    });\n+  }\n+\n+  /// القسم السفلي المحسن\n+  Widget _buildEnhancedBottomSection(CodePhoneController controller) {\n     return Container(\n-      padding: const EdgeInsets.all(16),\n+      padding: const EdgeInsets.all(20),\n       decoration: BoxDecoration(\n-        color: Colors.white,\n-        borderRadius: const BorderRadius.vertical(top: Radius.circular(20)),\n+        color: Colors.white.withOpacity(0.98),\n+        borderRadius: const BorderRadius.vertical(top: Radius.circular(25)),\n         boxShadow: [\n           BoxShadow(\n             color: Colors.black.withOpacity(0.1),\n-            blurRadius: 10,\n-            offset: const Offset(0, -2),\n+            blurRadius: 20,\n+            offset: const Offset(0, -5),\n           ),\n         ],\n+        border: Border(\n+          top: BorderSide(color: Colors.blue.withOpacity(0.2), width: 1),\n+        ),\n       ),\n       child: Column(\n         mainAxisSize: MainAxisSize.min,\n         children: [\n-          Row(\n-            children: [\n-              Icon(Icons.security, color: Colors.green.shade600, size: 20),\n-              const SizedBox(width: 8),\n-              Expanded(\n-                child: Text(\n-                  'بياناتك محمية بأعلى معايير الأمان',\n-                  style: TextStyle(color: Colors.grey.shade600, fontSize: 14),\n+          _buildSecurityInfo(),\n+          const SizedBox(height: 16),\n+          _buildHelpInfo(),\n+          const SizedBox(height: 16),\n+          _buildTroubleShootingButton(controller),\n+        ],\n+      ),\n+    );\n+  }\n+\n+  /// معلومات الأمان\n+  Widget _buildSecurityInfo() {\n+    return Container(\n+      padding: const EdgeInsets.all(16),\n+      decoration: BoxDecoration(\n+        gradient: LinearGradient(\n+          colors: [Colors.green.shade50, Colors.green.shade100],\n+        ),\n+        borderRadius: BorderRadius.circular(12),\n+        border: Border.all(color: Colors.green.shade300),\n+      ),\n+      child: Row(\n+        children: [\n+          Container(\n+            padding: const EdgeInsets.all(8),\n+            decoration: BoxDecoration(\n+              color: Colors.green.shade600,\n+              shape: BoxShape.circle,\n+            ),\n+            child: const Icon(\n+              Icons.verified_user,\n+              color: Colors.white,\n+              size: 20,\n+            ),\n+          ),\n+          const SizedBox(width: 12),\n+          Expanded(\n+            child: Column(\n+              crossAxisAlignment: CrossAxisAlignment.start,\n+              children: [\n+                Text(\n+                  'حماية متقدمة',\n+                  style: TextStyle(\n+                    color: Colors.green.shade800,\n+                    fontSize: 14,\n+                    fontWeight: FontWeight.bold,\n+                  ),\n                 ),\n-              ),\n-            ],\n+                const SizedBox(height: 4),\n+                Text(\n+                  'بياناتك محمية بأعلى معايير الأمان العالمية',\n+                  style: TextStyle(color: Colors.green.shade700, fontSize: 12),\n+                ),\n+              ],\n+            ),\n           ),\n-          const SizedBox(height: 12),\n-          Row(\n-            children: [\n-              Icon(Icons.info_outline, color: Colors.blue.shade600, size: 20),\n-              const SizedBox(width: 8),\n-              Expanded(\n-                child: Text(\n-                  'قد يستغرق وصول الرمز عدة دقائق',\n-                  style: TextStyle(color: Colors.grey.shade600, fontSize: 14),\n+        ],\n+      ),\n+    );\n+  }\n+\n+  /// معلومات المساعدة\n+  Widget _buildHelpInfo() {\n+    return Container(\n+      padding: const EdgeInsets.all(16),\n+      decoration: BoxDecoration(\n+        gradient: LinearGradient(\n+          colors: [Colors.blue.shade50, Colors.blue.shade100],\n+        ),\n+        borderRadius: BorderRadius.circular(12),\n+        border: Border.all(color: Colors.blue.shade300),\n+      ),\n+      child: Row(\n+        children: [\n+          Container(\n+            padding: const EdgeInsets.all(8),\n+            decoration: BoxDecoration(\n+              color: Colors.blue.shade600,\n+              shape: BoxShape.circle,\n+            ),\n+            child: const Icon(\n+              Icons.info_outline,\n+              color: Colors.white,\n+              size: 20,\n+            ),\n+          ),\n+          const SizedBox(width: 12),\n+          Expanded(\n+            child: Column(\n+              crossAxisAlignment: CrossAxisAlignment.start,\n+              children: [\n+                Text(\n+                  'نصائح مفيدة',\n+                  style: TextStyle(\n+                    color: Colors.blue.shade800,\n+                    fontSize: 14,\n+                    fontWeight: FontWeight.bold,\n+                  ),\n                 ),\n-              ),\n-            ],\n+                const SizedBox(height: 4),\n+                Text(\n+                  'قد يستغرق وصول الرمز من 30 ثانية إلى 5 دقائق',\n+                  style: TextStyle(color: Colors.blue.shade700, fontSize: 12),\n+                ),\n+              ],\n+            ),\n           ),\n         ],\n       ),\n     );\n   }\n+\n+  /// زر استكشاف الأخطاء وإصلاحها\n+  Widget _buildTroubleShootingButton(CodePhoneController controller) {\n+    return OutlinedButton.icon(\n+      onPressed: () => _showTroubleshootingDialog(),\n+      icon: Icon(Icons.help_outline, color: Colors.orange.shade600, size: 20),\n+      label: Text(\n+        'مواجهة مشكلة؟ اضغط هنا للمساعدة',\n+        style: TextStyle(\n+          color: Colors.orange.shade700,\n+          fontSize: 14,\n+          fontWeight: FontWeight.w600,\n+        ),\n+      ),\n+      style: OutlinedButton.styleFrom(\n+        side: BorderSide(color: Colors.orange.shade300),\n+        backgroundColor: Colors.orange.shade50,\n+        padding: const EdgeInsets.symmetric(horizontal: 20, vertical: 12),\n+        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),\n+      ),\n+    );\n+  }\n+\n+  /// نافذة استكشاف الأخطاء وإصلاحها\n+  void _showTroubleshootingDialog() {\n+    ErrorDisplayManager.showErrorDialog(\n+      title: 'مركز المساعدة',\n+      message:\n+          'اختر نوع المشكلة التي تواجهها:\\n\\n'\n+          '• لم يصل الرمز بعد\\n'\n+          '• الرمز غير صحيح\\n'\n+          '• مشكلة في الشبكة\\n'\n+          '• مشاكل أخرى',\n+      errorCode: 'HELP_001',\n+      onRetry: () => _handleResendCode(),\n+      onCancel: () => _contactSupport(),\n+    );\n+  }\n+\n+  /// معالجة إعادة الإرسال\n+  void _handleResendCode() {\n+    final controller = Get.find<CodePhoneController>();\n+    controller.resendCode();\n+  }\n+\n+  /// الاتصال بالدعم الفني\n+  void _contactSupport() {\n+    ErrorDisplayManager.showInfo('سيتم الاتصال بفريق الدعم الفني قريباً');\n+  }\n }\n"
                },
                {
                    "date": 1752768338672,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,11 +3,10 @@\n import 'package:get/get.dart';\n \n import 'controllers/code_phone_controller.dart';\n import 'widgets/code_input_field.dart';\n-import '../../core/error_display_manager.dart';\n \n-/// صفحة إدخال رمز التحقق المحسنة\n+/// صفحة إدخال رمز التحقق المحسنة والمبسطة\n class CodePhonePage extends StatelessWidget {\n   final String phoneNumber;\n   final Uint8List userImage;\n   final String name;\n@@ -58,9 +57,9 @@\n             ],\n           ),\n           child: IconButton(\n             icon: const Icon(Icons.arrow_back_ios, color: Colors.black87),\n-            onPressed: () => _handleBackPress(),\n+            onPressed: () => Get.back(),\n           ),\n         ),\n         title: Container(\n           padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),\n@@ -100,138 +99,115 @@\n           ),\n         ),\n         child: SafeArea(\n           child: Padding(\n-            padding: const EdgeInsets.all(24.0),\n+            padding: const EdgeInsets.all(20.0),\n             child: Column(\n               children: [\n+                const SizedBox(height: 20),\n+                // Header Section\n                 Expanded(\n-                  child: SingleChildScrollView(\n-                    physics: const BouncingScrollPhysics(),\n-                    child: Column(\n-                      children: [\n-                        const SizedBox(height: 20),\n-                        _buildEnhancedHeader(),\n-                        const SizedBox(height: 40),\n-                        _buildCodeInputSection(controller),\n-                        const SizedBox(height: 30),\n-                        _buildResendSection(controller),\n-                        const SizedBox(height: 40),\n-                        _buildEnhancedStatusSection(controller),\n-                        const SizedBox(height: 20),\n-                        _buildErrorSection(controller),\n-                      ],\n-                    ),\n-                  ),\n+                  flex: 2,\n+                  child: _buildHeader(),\n                 ),\n-                _buildEnhancedBottomSection(controller),\n+                // Code Input Section\n+                Expanded(\n+                  flex: 2,\n+                  child: _buildCodeInputSection(controller),\n+                ),\n+                // Resend Section\n+                Expanded(\n+                  flex: 1,\n+                  child: _buildResendSection(controller),\n+                ),\n+                // Status Section\n+                _buildStatusSection(controller),\n+                const SizedBox(height: 20),\n               ],\n             ),\n           ),\n         ),\n       ),\n     );\n   }\n \n-  /// معالجة الضغط على زر الرجوع مع تأكيد\n-  void _handleBackPress() {\n-    ErrorDisplayManager.showErrorDialog(\n-      title: 'تأكيد الخروج',\n-      message:\n-          'هل أنت متأكد من الرغبة في الخروج؟ ستفقد التقدم الحالي في التحقق.',\n-      onRetry: () => Get.back(),\n-      onCancel: () {}, // إلغاء الخروج\n-    );\n-  }\n-\n-  /// قسم العنوان المحسن مع صورة الخلفية\n-  Widget _buildEnhancedHeader() {\n+  /// قسم العنوان المحسن\n+  Widget _buildHeader() {\n     return Container(\n-      padding: const EdgeInsets.all(24),\n+      padding: const EdgeInsets.all(20),\n       decoration: BoxDecoration(\n         color: Colors.white.withOpacity(0.95),\n-        borderRadius: BorderRadius.circular(24),\n+        borderRadius: BorderRadius.circular(20),\n         boxShadow: [\n           BoxShadow(\n             color: Colors.blue.withOpacity(0.1),\n-            blurRadius: 20,\n-            offset: const Offset(0, 8),\n+            blurRadius: 15,\n+            offset: const Offset(0, 5),\n           ),\n         ],\n-        border: Border.all(color: Colors.blue.withOpacity(0.2), width: 1),\n       ),\n       child: Column(\n+        mainAxisAlignment: MainAxisAlignment.center,\n         children: [\n           Container(\n-            width: 80,\n-            height: 80,\n+            width: 70,\n+            height: 70,\n             decoration: BoxDecoration(\n               gradient: LinearGradient(\n-                begin: Alignment.topLeft,\n-                end: Alignment.bottomRight,\n                 colors: [Colors.blue.shade400, Colors.blue.shade600],\n               ),\n               shape: BoxShape.circle,\n               boxShadow: [\n                 BoxShadow(\n                   color: Colors.blue.withOpacity(0.3),\n-                  blurRadius: 15,\n-                  offset: const Offset(0, 5),\n+                  blurRadius: 10,\n+                  offset: const Offset(0, 3),\n                 ),\n               ],\n             ),\n             child: const Icon(\n               Icons.verified_user,\n-              size: 40,\n+              size: 35,\n               color: Colors.white,\n             ),\n           ),\n-          const SizedBox(height: 20),\n+          const SizedBox(height: 16),\n           const Text(\n             'أدخل رمز التأكيد',\n             style: TextStyle(\n-              fontSize: 28,\n+              fontSize: 24,\n               fontWeight: FontWeight.bold,\n               color: Colors.black87,\n             ),\n           ),\n-          const SizedBox(height: 12),\n+          const SizedBox(height: 8),\n           Text(\n             'تم إرسال رمز مكون من 6 أرقام إلى',\n-            style: TextStyle(fontSize: 16, color: Colors.grey.shade600),\n+            style: TextStyle(fontSize: 14, color: Colors.grey.shade600),\n           ),\n-          const SizedBox(height: 12),\n+          const SizedBox(height: 8),\n           Container(\n-            padding: const EdgeInsets.symmetric(horizontal: 20, vertical: 12),\n+            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),\n             decoration: BoxDecoration(\n-              gradient: LinearGradient(\n-                colors: [Colors.blue.shade50, Colors.blue.shade100],\n-              ),\n-              borderRadius: BorderRadius.circular(25),\n-              border: Border.all(color: Colors.blue.shade300),\n-              boxShadow: [\n-                BoxShadow(\n-                  color: Colors.blue.withOpacity(0.1),\n-                  blurRadius: 8,\n-                  offset: const Offset(0, 2),\n-                ),\n-              ],\n+              color: Colors.blue.shade50,\n+              borderRadius: BorderRadius.circular(20),\n+              border: Border.all(color: Colors.blue.shade200),\n             ),\n             child: Row(\n               mainAxisSize: MainAxisSize.min,\n               children: [\n                 Icon(\n                   Icons.phone_android,\n                   color: Colors.blue.shade700,\n-                  size: 20,\n+                  size: 16,\n                 ),\n-                const SizedBox(width: 8),\n+                const SizedBox(width: 6),\n                 Directionality(\n                   textDirection: TextDirection.ltr,\n                   child: Text(\n                     phoneNumber,\n                     style: TextStyle(\n-                      fontSize: 18,\n+                      fontSize: 16,\n                       fontWeight: FontWeight.bold,\n                       color: Colors.blue.shade700,\n                     ),\n                   ),\n@@ -243,96 +219,82 @@\n       ),\n     );\n   }\n \n-  /// قسم إدخال الرمز مع تحسينات بصرية\n+  /// قسم إدخال الرمز\n   Widget _buildCodeInputSection(CodePhoneController controller) {\n     return Container(\n-      padding: const EdgeInsets.all(24),\n+      padding: const EdgeInsets.all(20),\n       decoration: BoxDecoration(\n         color: Colors.white.withOpacity(0.95),\n-        borderRadius: BorderRadius.circular(20),\n+        borderRadius: BorderRadius.circular(16),\n         boxShadow: [\n           BoxShadow(\n             color: Colors.black.withOpacity(0.05),\n-            blurRadius: 15,\n-            offset: const Offset(0, 5),\n+            blurRadius: 10,\n+            offset: const Offset(0, 3),\n           ),\n         ],\n       ),\n-      child: Obx(\n-        () => Column(\n-          children: [\n-            Text(\n-              'أدخل الرمز المرسل',\n-              style: TextStyle(\n-                fontSize: 18,\n-                fontWeight: FontWeight.w600,\n-                color: Colors.grey.shade700,\n-              ),\n+      child: Column(\n+        mainAxisAlignment: MainAxisAlignment.center,\n+        children: [\n+          Text(\n+            'أدخل الرمز المرسل',\n+            style: TextStyle(\n+              fontSize: 16,\n+              fontWeight: FontWeight.w600,\n+              color: Colors.grey.shade700,\n             ),\n-            const SizedBox(height: 20),\n-            Row(\n-              mainAxisAlignment: MainAxisAlignment.spaceEvenly,\n-              children: List.generate(\n-                6,\n-                (index) => CodeInputField(\n-                  controller: controller.codeControllers[index],\n-                  focusNode: controller.focusNodes[index],\n-                  isValid: controller.isCodeValid.value,\n-                  onComplete: () => controller.checkCodeOnComplete(),\n-                ),\n+          ),\n+          const SizedBox(height: 20),\n+          Obx(() => Row(\n+            mainAxisAlignment: MainAxisAlignment.spaceEvenly,\n+            children: List.generate(\n+              6,\n+              (index) => CodeInputField(\n+                controller: controller.codeControllers[index],\n+                focusNode: controller.focusNodes[index],\n+                isValid: controller.isCodeValid.value,\n+                onComplete: () => controller.checkCodeOnComplete(),\n               ),\n             ),\n-            if (!controller.isCodeValid.value) ...[\n-              const SizedBox(height: 16),\n-              _buildErrorMessage('الرمز غير صحيح، يرجى المحاولة مرة أخرى'),\n-            ],\n-          ],\n-        ),\n+          )),\n+          Obx(() => !controller.isCodeValid.value \n+            ? Padding(\n+                padding: const EdgeInsets.only(top: 12),\n+                child: _buildErrorMessage('الرمز غير صحيح، يرجى المحاولة مرة أخرى'),\n+              )\n+            : const SizedBox.shrink(),\n+          ),\n+        ],\n       ),\n     );\n   }\n \n   /// رسالة خطأ محسنة\n   Widget _buildErrorMessage(String message) {\n     return Container(\n-      padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 12),\n+      padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 8),\n       decoration: BoxDecoration(\n-        gradient: LinearGradient(\n-          colors: [Colors.red.shade50, Colors.red.shade100],\n-        ),\n-        borderRadius: BorderRadius.circular(12),\n-        border: Border.all(color: Colors.red.shade300),\n-        boxShadow: [\n-          BoxShadow(\n-            color: Colors.red.withOpacity(0.1),\n-            blurRadius: 8,\n-            offset: const Offset(0, 2),\n-          ),\n-        ],\n+        color: Colors.red.shade50,\n+        borderRadius: BorderRadius.circular(8),\n+        border: Border.all(color: Colors.red.shade200),\n       ),\n       child: Row(\n         children: [\n-          Container(\n-            padding: const EdgeInsets.all(6),\n-            decoration: BoxDecoration(\n-              color: Colors.red.shade600,\n-              shape: BoxShape.circle,\n-            ),\n-            child: const Icon(\n-              Icons.error_outline,\n-              color: Colors.white,\n-              size: 16,\n-            ),\n+          Icon(\n+            Icons.error_outline,\n+            color: Colors.red.shade600,\n+            size: 16,\n           ),\n-          const SizedBox(width: 12),\n+          const SizedBox(width: 8),\n           Expanded(\n             child: Text(\n               message,\n               style: TextStyle(\n                 color: Colors.red.shade700,\n-                fontSize: 14,\n+                fontSize: 12,\n                 fontWeight: FontWeight.w500,\n               ),\n             ),\n           ),\n@@ -340,168 +302,121 @@\n       ),\n     );\n   }\n \n-  /// قسم إعادة الإرسال المحسن\n+  /// قسم إعادة الإرسال\n   Widget _buildResendSection(CodePhoneController controller) {\n     return Container(\n-      padding: const EdgeInsets.all(20),\n+      padding: const EdgeInsets.all(16),\n       decoration: BoxDecoration(\n         color: Colors.white.withOpacity(0.95),\n-        borderRadius: BorderRadius.circular(16),\n+        borderRadius: BorderRadius.circular(12),\n         boxShadow: [\n           BoxShadow(\n             color: Colors.black.withOpacity(0.05),\n-            blurRadius: 10,\n-            offset: const Offset(0, 3),\n+            blurRadius: 8,\n+            offset: const Offset(0, 2),\n           ),\n         ],\n       ),\n-      child: Obx(\n-        () => Column(\n-          children: [\n-            Text(\n-              'لم تتلق الرمز؟',\n-              style: TextStyle(\n-                fontSize: 16,\n-                color: Colors.grey.shade600,\n-                fontWeight: FontWeight.w500,\n-              ),\n+      child: Column(\n+        mainAxisAlignment: MainAxisAlignment.center,\n+        children: [\n+          Text(\n+            'لم تتلق الرمز؟',\n+            style: TextStyle(\n+              fontSize: 14,\n+              color: Colors.grey.shade600,\n+              fontWeight: FontWeight.w500,\n             ),\n-            const SizedBox(height: 16),\n-            if (controller.canResend.value)\n-              _buildEnhancedResendButton(controller)\n-            else\n-              _buildEnhancedResendTimer(controller),\n-          ],\n-        ),\n+          ),\n+          const SizedBox(height: 12),\n+          Obx(() => controller.canResend.value\n+            ? _buildResendButton(controller)\n+            : _buildResendTimer(controller),\n+          ),\n+        ],\n       ),\n     );\n   }\n \n-  /// زر إعادة الإرسال المحسن\n-  Widget _buildEnhancedResendButton(CodePhoneController controller) {\n-    return Container(\n-      decoration: BoxDecoration(\n-        gradient: LinearGradient(\n-          colors: [Colors.blue.shade500, Colors.blue.shade700],\n+  /// زر إعادة الإرسال\n+  Widget _buildResendButton(CodePhoneController controller) {\n+    return ElevatedButton.icon(\n+      onPressed: () => controller.resendCode(),\n+      icon: const Icon(Icons.refresh, size: 18, color: Colors.white),\n+      label: const Text(\n+        'إعادة إرسال الرمز',\n+        style: TextStyle(\n+          fontSize: 14,\n+          fontWeight: FontWeight.bold,\n+          color: Colors.white,\n         ),\n-        borderRadius: BorderRadius.circular(25),\n-        boxShadow: [\n-          BoxShadow(\n-            color: Colors.blue.withOpacity(0.3),\n-            blurRadius: 10,\n-            offset: const Offset(0, 5),\n-          ),\n-        ],\n       ),\n-      child: ElevatedButton.icon(\n-        onPressed: () => controller.resendCode(),\n-        icon: const Icon(Icons.refresh, size: 22, color: Colors.white),\n-        label: const Text(\n-          'إعادة إرسال الرمز',\n-          style: TextStyle(\n-            fontSize: 16,\n-            fontWeight: FontWeight.bold,\n-            color: Colors.white,\n-          ),\n+      style: ElevatedButton.styleFrom(\n+        backgroundColor: Colors.blue.shade600,\n+        padding: const EdgeInsets.symmetric(horizontal: 20, vertical: 10),\n+        shape: RoundedRectangleBorder(\n+          borderRadius: BorderRadius.circular(20),\n         ),\n-        style: ElevatedButton.styleFrom(\n-          backgroundColor: Colors.transparent,\n-          shadowColor: Colors.transparent,\n-          padding: const EdgeInsets.symmetric(horizontal: 28, vertical: 14),\n-          shape: RoundedRectangleBorder(\n-            borderRadius: BorderRadius.circular(25),\n-          ),\n-        ),\n       ),\n     );\n   }\n \n-  /// مؤقت إعادة الإرسال المحسن\n-  Widget _buildEnhancedResendTimer(CodePhoneController controller) {\n+  /// مؤقت إعادة الإرسال\n+  Widget _buildResendTimer(CodePhoneController controller) {\n     return Container(\n-      padding: const EdgeInsets.symmetric(horizontal: 24, vertical: 16),\n+      padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 10),\n       decoration: BoxDecoration(\n-        gradient: LinearGradient(\n-          colors: [Colors.orange.shade100, Colors.orange.shade200],\n-        ),\n-        borderRadius: BorderRadius.circular(20),\n-        border: Border.all(color: Colors.orange.shade300),\n-        boxShadow: [\n-          BoxShadow(\n-            color: Colors.orange.withOpacity(0.2),\n-            blurRadius: 8,\n-            offset: const Offset(0, 3),\n-          ),\n-        ],\n+        color: Colors.orange.shade100,\n+        borderRadius: BorderRadius.circular(16),\n+        border: Border.all(color: Colors.orange.shade200),\n       ),\n       child: Row(\n         mainAxisSize: MainAxisSize.min,\n         children: [\n-          Container(\n-            padding: const EdgeInsets.all(8),\n-            decoration: BoxDecoration(\n-              color: Colors.orange.shade600,\n-              shape: BoxShape.circle,\n+          Icon(Icons.timer, color: Colors.orange.shade600, size: 16),\n+          const SizedBox(width: 8),\n+          Obx(() => Text(\n+            'إعادة الإرسال خلال ${controller.resendCounter.value} ثانية',\n+            style: TextStyle(\n+              color: Colors.orange.shade800,\n+              fontSize: 12,\n+              fontWeight: FontWeight.w600,\n             ),\n-            child: const Icon(Icons.timer, color: Colors.white, size: 18),\n-          ),\n-          const SizedBox(width: 12),\n-          Column(\n-            crossAxisAlignment: CrossAxisAlignment.start,\n-            mainAxisSize: MainAxisSize.min,\n-            children: [\n-              Text(\n-                'إعادة الإرسال متاحة خلال',\n-                style: TextStyle(\n-                  color: Colors.orange.shade800,\n-                  fontSize: 12,\n-                  fontWeight: FontWeight.w500,\n-                ),\n-              ),\n-              Text(\n-                '${controller.resendCounter.value} ثانية',\n-                style: TextStyle(\n-                  color: Colors.orange.shade900,\n-                  fontSize: 18,\n-                  fontWeight: FontWeight.bold,\n-                ),\n-              ),\n-            ],\n-          ),\n+          )),\n         ],\n       ),\n     );\n   }\n \n-  /// قسم حالة العملية المحسن\n-  Widget _buildEnhancedStatusSection(CodePhoneController controller) {\n+  /// قسم حالة العملية\n+  Widget _buildStatusSection(CodePhoneController controller) {\n     return Obx(() {\n       if (!controller.isLoading.value &&\n           controller.statusMessage.value.isEmpty) {\n         return const SizedBox.shrink();\n       }\n \n       return Container(\n-        padding: const EdgeInsets.all(24),\n+        padding: const EdgeInsets.all(16),\n         decoration: BoxDecoration(\n           color: Colors.white.withOpacity(0.95),\n-          borderRadius: BorderRadius.circular(20),\n+          borderRadius: BorderRadius.circular(12),\n           boxShadow: [\n             BoxShadow(\n               color: Colors.blue.withOpacity(0.1),\n-              blurRadius: 15,\n-              offset: const Offset(0, 5),\n+              blurRadius: 8,\n+              offset: const Offset(0, 2),\n             ),\n           ],\n         ),\n         child: Column(\n           children: [\n             if (controller.isLoading.value) ...[\n               Container(\n-                width: 60,\n-                height: 60,\n+                width: 40,\n+                height: 40,\n                 decoration: BoxDecoration(\n                   gradient: LinearGradient(\n                     colors: [Colors.blue.shade400, Colors.blue.shade600],\n                   ),\n@@ -509,247 +424,26 @@\n                 ),\n                 child: const Center(\n                   child: CircularProgressIndicator(\n                     valueColor: AlwaysStoppedAnimation<Color>(Colors.white),\n-                    strokeWidth: 3,\n+                    strokeWidth: 2,\n                   ),\n                 ),\n               ),\n-              const SizedBox(height: 20),\n-              if (controller.statusMessage.value.isNotEmpty) ...[\n+              const SizedBox(height: 12),\n+              if (controller.statusMessage.value.isNotEmpty)\n                 Text(\n                   controller.statusMessage.value,\n                   style: TextStyle(\n                     color: Colors.blue.shade700,\n-                    fontSize: 16,\n+                    fontSize: 14,\n                     fontWeight: FontWeight.w600,\n                   ),\n                   textAlign: TextAlign.center,\n                 ),\n-                const SizedBox(height: 16),\n-              ],\n-              if (controller.progress.value > 0) ...[\n-                Container(\n-                  height: 8,\n-                  decoration: BoxDecoration(\n-                    color: Colors.blue.shade100,\n-                    borderRadius: BorderRadius.circular(4),\n-                  ),\n-                  child: FractionallySizedBox(\n-                    widthFactor: controller.progress.value,\n-                    child: Container(\n-                      decoration: BoxDecoration(\n-                        gradient: LinearGradient(\n-                          colors: [Colors.blue.shade400, Colors.blue.shade600],\n-                        ),\n-                        borderRadius: BorderRadius.circular(4),\n-                      ),\n-                    ),\n-                  ),\n-                ),\n-                const SizedBox(height: 8),\n-                Text(\n-                  '${(controller.progress.value * 100).toInt()}%',\n-                  style: TextStyle(\n-                    color: Colors.blue.shade600,\n-                    fontSize: 14,\n-                    fontWeight: FontWeight.bold,\n-                  ),\n-                ),\n-              ],\n             ],\n           ],\n         ),\n       );\n     });\n   }\n-\n-  /// قسم الأخطاء المتقدم\n-  Widget _buildErrorSection(CodePhoneController controller) {\n-    return Obx(() {\n-      // يمكن إضافة منطق معقد لعرض الأخطاء هنا\n-      return const SizedBox.shrink();\n-    });\n-  }\n-\n-  /// القسم السفلي المحسن\n-  Widget _buildEnhancedBottomSection(CodePhoneController controller) {\n-    return Container(\n-      padding: const EdgeInsets.all(20),\n-      decoration: BoxDecoration(\n-        color: Colors.white.withOpacity(0.98),\n-        borderRadius: const BorderRadius.vertical(top: Radius.circular(25)),\n-        boxShadow: [\n-          BoxShadow(\n-            color: Colors.black.withOpacity(0.1),\n-            blurRadius: 20,\n-            offset: const Offset(0, -5),\n-          ),\n-        ],\n-        border: Border(\n-          top: BorderSide(color: Colors.blue.withOpacity(0.2), width: 1),\n-        ),\n-      ),\n-      child: Column(\n-        mainAxisSize: MainAxisSize.min,\n-        children: [\n-          _buildSecurityInfo(),\n-          const SizedBox(height: 16),\n-          _buildHelpInfo(),\n-          const SizedBox(height: 16),\n-          _buildTroubleShootingButton(controller),\n-        ],\n-      ),\n-    );\n-  }\n-\n-  /// معلومات الأمان\n-  Widget _buildSecurityInfo() {\n-    return Container(\n-      padding: const EdgeInsets.all(16),\n-      decoration: BoxDecoration(\n-        gradient: LinearGradient(\n-          colors: [Colors.green.shade50, Colors.green.shade100],\n-        ),\n-        borderRadius: BorderRadius.circular(12),\n-        border: Border.all(color: Colors.green.shade300),\n-      ),\n-      child: Row(\n-        children: [\n-          Container(\n-            padding: const EdgeInsets.all(8),\n-            decoration: BoxDecoration(\n-              color: Colors.green.shade600,\n-              shape: BoxShape.circle,\n-            ),\n-            child: const Icon(\n-              Icons.verified_user,\n-              color: Colors.white,\n-              size: 20,\n-            ),\n-          ),\n-          const SizedBox(width: 12),\n-          Expanded(\n-            child: Column(\n-              crossAxisAlignment: CrossAxisAlignment.start,\n-              children: [\n-                Text(\n-                  'حماية متقدمة',\n-                  style: TextStyle(\n-                    color: Colors.green.shade800,\n-                    fontSize: 14,\n-                    fontWeight: FontWeight.bold,\n-                  ),\n-                ),\n-                const SizedBox(height: 4),\n-                Text(\n-                  'بياناتك محمية بأعلى معايير الأمان العالمية',\n-                  style: TextStyle(color: Colors.green.shade700, fontSize: 12),\n-                ),\n-              ],\n-            ),\n-          ),\n-        ],\n-      ),\n-    );\n-  }\n-\n-  /// معلومات المساعدة\n-  Widget _buildHelpInfo() {\n-    return Container(\n-      padding: const EdgeInsets.all(16),\n-      decoration: BoxDecoration(\n-        gradient: LinearGradient(\n-          colors: [Colors.blue.shade50, Colors.blue.shade100],\n-        ),\n-        borderRadius: BorderRadius.circular(12),\n-        border: Border.all(color: Colors.blue.shade300),\n-      ),\n-      child: Row(\n-        children: [\n-          Container(\n-            padding: const EdgeInsets.all(8),\n-            decoration: BoxDecoration(\n-              color: Colors.blue.shade600,\n-              shape: BoxShape.circle,\n-            ),\n-            child: const Icon(\n-              Icons.info_outline,\n-              color: Colors.white,\n-              size: 20,\n-            ),\n-          ),\n-          const SizedBox(width: 12),\n-          Expanded(\n-            child: Column(\n-              crossAxisAlignment: CrossAxisAlignment.start,\n-              children: [\n-                Text(\n-                  'نصائح مفيدة',\n-                  style: TextStyle(\n-                    color: Colors.blue.shade800,\n-                    fontSize: 14,\n-                    fontWeight: FontWeight.bold,\n-                  ),\n-                ),\n-                const SizedBox(height: 4),\n-                Text(\n-                  'قد يستغرق وصول الرمز من 30 ثانية إلى 5 دقائق',\n-                  style: TextStyle(color: Colors.blue.shade700, fontSize: 12),\n-                ),\n-              ],\n-            ),\n-          ),\n-        ],\n-      ),\n-    );\n-  }\n-\n-  /// زر استكشاف الأخطاء وإصلاحها\n-  Widget _buildTroubleShootingButton(CodePhoneController controller) {\n-    return OutlinedButton.icon(\n-      onPressed: () => _showTroubleshootingDialog(),\n-      icon: Icon(Icons.help_outline, color: Colors.orange.shade600, size: 20),\n-      label: Text(\n-        'مواجهة مشكلة؟ اضغط هنا للمساعدة',\n-        style: TextStyle(\n-          color: Colors.orange.shade700,\n-          fontSize: 14,\n-          fontWeight: FontWeight.w600,\n-        ),\n-      ),\n-      style: OutlinedButton.styleFrom(\n-        side: BorderSide(color: Colors.orange.shade300),\n-        backgroundColor: Colors.orange.shade50,\n-        padding: const EdgeInsets.symmetric(horizontal: 20, vertical: 12),\n-        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),\n-      ),\n-    );\n-  }\n-\n-  /// نافذة استكشاف الأخطاء وإصلاحها\n-  void _showTroubleshootingDialog() {\n-    ErrorDisplayManager.showErrorDialog(\n-      title: 'مركز المساعدة',\n-      message:\n-          'اختر نوع المشكلة التي تواجهها:\\n\\n'\n-          '• لم يصل الرمز بعد\\n'\n-          '• الرمز غير صحيح\\n'\n-          '• مشكلة في الشبكة\\n'\n-          '• مشاكل أخرى',\n-      errorCode: 'HELP_001',\n-      onRetry: () => _handleResendCode(),\n-      onCancel: () => _contactSupport(),\n-    );\n-  }\n-\n-  /// معالجة إعادة الإرسال\n-  void _handleResendCode() {\n-    final controller = Get.find<CodePhoneController>();\n-    controller.resendCode();\n-  }\n-\n-  /// الاتصال بالدعم الفني\n-  void _contactSupport() {\n-    ErrorDisplayManager.showInfo('سيتم الاتصال بفريق الدعم الفني قريباً');\n-  }\n }\n"
                },
                {
                    "date": 1752798050005,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,12 +1,15 @@\n import 'package:flutter/material.dart';\n import 'package:flutter/services.dart';\n import 'package:get/get.dart';\n+import 'package:flutter_screenutil/flutter_screenutil.dart';\n+import 'package:flutter_animate/flutter_animate.dart';\n \n import 'controllers/code_phone_controller.dart';\n-import 'widgets/code_input_field.dart';\n+import 'widgets/pinput_code_field.dart';\n \n-/// صفحة إدخال رمز التحقق المحسنة والمبسطة\n+/// صفحة إدخال رمز التحقق المحسنة والمتطورة\n+/// تتضمن رسوم متحركة وتجربة مستخدم متقدمة ومعالجة أخطاء ذكية\n class CodePhonePage extends StatelessWidget {\n   final String phoneNumber;\n   final Uint8List userImage;\n   final String name;\n@@ -32,182 +35,297 @@\n         userImage: userImage,\n         name: name,\n         email: email,\n         password: password,\n-        hasPassword: hasPassword,\n       ),\n     );\n \n-    return Scaffold(\n-      backgroundColor: Colors.transparent,\n-      extendBodyBehindAppBar: true,\n-      appBar: AppBar(\n+    return WillPopScope(\n+      onWillPop: () async {\n+        // تأكيد قبل الخروج\n+        return await _showExitConfirmation(context);\n+      },\n+      child: Scaffold(\n+        resizeToAvoidBottomInset: true,\n         backgroundColor: Colors.transparent,\n-        elevation: 0,\n-        leading: Container(\n-          margin: const EdgeInsets.all(8),\n-          decoration: BoxDecoration(\n-            color: Colors.white.withOpacity(0.9),\n-            borderRadius: BorderRadius.circular(12),\n-            boxShadow: [\n-              BoxShadow(\n-                color: Colors.black.withOpacity(0.1),\n-                blurRadius: 10,\n-                offset: const Offset(0, 2),\n-              ),\n-            ],\n+        extendBodyBehindAppBar: true,\n+        appBar: _buildSmartAppBar(controller),\n+        body: _buildResponsiveBody(context, controller),\n+      ),\n+    );\n+  }\n+\n+  /// تأكيد الخروج\n+  Future<bool> _showExitConfirmation(BuildContext context) async {\n+    final result = await Get.dialog<bool>(\n+      AlertDialog(\n+        title: const Text('تأكيد الخروج'),\n+        content: const Text('هل تريد الخروج؟ ستحتاج لإعادة إرسال رمز التحقق.'),\n+        actions: [\n+          TextButton(\n+            onPressed: () => Get.back(result: false),\n+            child: const Text('إلغاء'),\n           ),\n-          child: IconButton(\n-            icon: const Icon(Icons.arrow_back_ios, color: Colors.black87),\n-            onPressed: () => Get.back(),\n+          TextButton(\n+            onPressed: () => Get.back(result: true),\n+            child: const Text('خروج'),\n           ),\n-        ),\n-        title: Container(\n-          padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),\n-          decoration: BoxDecoration(\n-            color: Colors.white.withOpacity(0.9),\n-            borderRadius: BorderRadius.circular(20),\n-            boxShadow: [\n-              BoxShadow(\n-                color: Colors.black.withOpacity(0.1),\n-                blurRadius: 10,\n-                offset: const Offset(0, 2),\n-              ),\n-            ],\n+        ],\n+      ),\n+    );\n+    return result ?? false;\n+  }\n+\n+  /// بناء شريط التطبيق الذكي\n+  PreferredSizeWidget _buildSmartAppBar(CodePhoneController controller) {\n+    return AppBar(\n+      backgroundColor: Colors.transparent,\n+      elevation: 0,\n+      leading: _buildBackButton(),\n+      title: _buildAnimatedTitle(),\n+      centerTitle: true,\n+      actions: [_buildNetworkStatusIndicator(controller)],\n+    );\n+  }\n+\n+  /// زر الرجوع المحسن\n+  Widget _buildBackButton() {\n+    return Container(\n+      margin: EdgeInsets.all(8.w),\n+      decoration: BoxDecoration(\n+        color: Colors.white.withOpacity(0.9),\n+        borderRadius: BorderRadius.circular(12.r),\n+        boxShadow: [\n+          BoxShadow(\n+            color: Colors.black.withOpacity(0.1),\n+            blurRadius: 10.r,\n+            offset: Offset(0, 2.h),\n           ),\n-          child: const Text(\n-            'تأكيد رقم الهاتف',\n-            style: TextStyle(\n-              color: Colors.black87,\n-              fontWeight: FontWeight.bold,\n-              fontSize: 18,\n-            ),\n+        ],\n+      ),\n+      child: IconButton(\n+        icon: Icon(Icons.arrow_back_ios, color: Colors.black87, size: 20.sp),\n+        onPressed: () async {\n+          if (await _showExitConfirmation(Get.context!)) {\n+            Get.back();\n+          }\n+        },\n+      ),\n+    ).animate().slideX(begin: -1, duration: 600.ms).fadeIn();\n+  }\n+\n+  /// العنوان المتحرك\n+  Widget _buildAnimatedTitle() {\n+    return Container(\n+      padding: EdgeInsets.symmetric(horizontal: 16.w, vertical: 8.h),\n+      decoration: BoxDecoration(\n+        color: Colors.white.withOpacity(0.9),\n+        borderRadius: BorderRadius.circular(20.r),\n+        boxShadow: [\n+          BoxShadow(\n+            color: Colors.black.withOpacity(0.1),\n+            blurRadius: 10.r,\n+            offset: Offset(0, 2.h),\n           ),\n+        ],\n+      ),\n+      child: Text(\n+        'تأكيد رقم الهاتف',\n+        style: TextStyle(\n+          color: Colors.black87,\n+          fontWeight: FontWeight.bold,\n+          fontSize: 18.sp,\n         ),\n-        centerTitle: true,\n       ),\n-      body: Container(\n-        decoration: const BoxDecoration(\n-          image: DecorationImage(\n-            image: AssetImage('assets/logo.png'),\n-            fit: BoxFit.cover,\n-            opacity: 0.1,\n-          ),\n-          gradient: LinearGradient(\n-            begin: Alignment.topLeft,\n-            end: Alignment.bottomRight,\n-            colors: [Color(0xFFF8FBFF), Color(0xFFE3F2FD), Color(0xFFF1F8FF)],\n-          ),\n+    ).animate().slideY(begin: -1, duration: 600.ms).fadeIn();\n+  }\n+\n+  /// مؤشر حالة الشبكة\n+  Widget _buildNetworkStatusIndicator(CodePhoneController controller) {\n+    return Obx(\n+      () => Container(\n+        margin: EdgeInsets.all(8.w),\n+        padding: EdgeInsets.all(8.w),\n+        decoration: BoxDecoration(\n+          color:\n+              controller.isNetworkConnected.value\n+                  ? Colors.green.withOpacity(0.1)\n+                  : Colors.red.withOpacity(0.1),\n+          borderRadius: BorderRadius.circular(8.r),\n         ),\n-        child: SafeArea(\n-          child: Padding(\n-            padding: const EdgeInsets.all(20.0),\n-            child: Column(\n-              children: [\n-                const SizedBox(height: 20),\n-                // Header Section\n-                Expanded(\n-                  flex: 2,\n-                  child: _buildHeader(),\n+        child: Icon(\n+          controller.isNetworkConnected.value ? Icons.wifi : Icons.wifi_off,\n+          color:\n+              controller.isNetworkConnected.value ? Colors.green : Colors.red,\n+          size: 20.sp,\n+        ),\n+      ).animate().scale(duration: 300.ms),\n+    );\n+  }\n+\n+  /// الجسم المتجاوب\n+  Widget _buildResponsiveBody(\n+    BuildContext context,\n+    CodePhoneController controller,\n+  ) {\n+    return Container(\n+      decoration: _buildBackgroundDecoration(),\n+      child: SafeArea(\n+        child: LayoutBuilder(\n+          builder: (context, constraints) {\n+            return SingleChildScrollView(\n+              physics: const BouncingScrollPhysics(),\n+              padding: EdgeInsets.symmetric(horizontal: 20.w),\n+              child: ConstrainedBox(\n+                constraints: BoxConstraints(minHeight: constraints.maxHeight),\n+                child: IntrinsicHeight(\n+                  child: Column(\n+                    crossAxisAlignment: CrossAxisAlignment.stretch,\n+                    children: [\n+                      SizedBox(height: 20.h),\n+\n+                      // Header Section with Animation\n+                      _buildAnimatedHeader()\n+                          .animate()\n+                          .slideY(begin: 0.3, duration: 800.ms)\n+                          .fadeIn(),\n+\n+                      SizedBox(height: 30.h),\n+\n+                      // Code Input Section with Animation\n+                      _buildEnhancedCodeInputSection(controller)\n+                          .animate(delay: 200.ms)\n+                          .slideY(begin: 0.3, duration: 800.ms)\n+                          .fadeIn(),\n+\n+                      SizedBox(height: 20.h),\n+\n+                      // Network Status Section\n+                      _buildNetworkStatusSection(controller),\n+\n+                      SizedBox(height: 20.h),\n+\n+                      // Resend Section with Animation\n+                      _buildEnhancedResendSection(controller)\n+                          .animate(delay: 400.ms)\n+                          .slideY(begin: 0.3, duration: 800.ms)\n+                          .fadeIn(),\n+\n+                      SizedBox(height: 20.h),\n+\n+                      // Progress and Status Section\n+                      _buildProgressSection(controller)\n+                          .animate(delay: 600.ms)\n+                          .slideY(begin: 0.3, duration: 800.ms)\n+                          .fadeIn(),\n+\n+                      SizedBox(height: 30.h),\n+                    ],\n+                  ),\n                 ),\n-                // Code Input Section\n-                Expanded(\n-                  flex: 2,\n-                  child: _buildCodeInputSection(controller),\n-                ),\n-                // Resend Section\n-                Expanded(\n-                  flex: 1,\n-                  child: _buildResendSection(controller),\n-                ),\n-                // Status Section\n-                _buildStatusSection(controller),\n-                const SizedBox(height: 20),\n-              ],\n-            ),\n-          ),\n+              ),\n+            );\n+          },\n         ),\n       ),\n     );\n   }\n \n-  /// قسم العنوان المحسن\n-  Widget _buildHeader() {\n+  /// بناء الخلفية المتدرجة\n+  BoxDecoration _buildBackgroundDecoration() {\n+    return const BoxDecoration(\n+      image: DecorationImage(\n+        image: AssetImage('assets/logo.png'),\n+        fit: BoxFit.cover,\n+        opacity: 0.03,\n+      ),\n+      gradient: LinearGradient(\n+        begin: Alignment.topLeft,\n+        end: Alignment.bottomRight,\n+        colors: [\n+          Color(0xFFF8FBFF),\n+          Color(0xFFE3F2FD),\n+          Color(0xFFF1F8FF),\n+          Color(0xFFE8F5E8),\n+        ],\n+        stops: [0.0, 0.3, 0.7, 1.0],\n+      ),\n+    );\n+  }\n+\n+  /// قسم العنوان المحسن والمتحرك\n+  Widget _buildAnimatedHeader() {\n     return Container(\n-      padding: const EdgeInsets.all(20),\n+      padding: EdgeInsets.all(20.w),\n       decoration: BoxDecoration(\n         color: Colors.white.withOpacity(0.95),\n-        borderRadius: BorderRadius.circular(20),\n+        borderRadius: BorderRadius.circular(20.r),\n         boxShadow: [\n           BoxShadow(\n             color: Colors.blue.withOpacity(0.1),\n-            blurRadius: 15,\n-            offset: const Offset(0, 5),\n+            blurRadius: 15.r,\n+            offset: Offset(0, 5.h),\n           ),\n         ],\n       ),\n       child: Column(\n         mainAxisAlignment: MainAxisAlignment.center,\n         children: [\n           Container(\n-            width: 70,\n-            height: 70,\n+            width: 70.w,\n+            height: 70.w,\n             decoration: BoxDecoration(\n               gradient: LinearGradient(\n                 colors: [Colors.blue.shade400, Colors.blue.shade600],\n               ),\n               shape: BoxShape.circle,\n               boxShadow: [\n                 BoxShadow(\n                   color: Colors.blue.withOpacity(0.3),\n-                  blurRadius: 10,\n-                  offset: const Offset(0, 3),\n+                  blurRadius: 10.r,\n+                  offset: Offset(0, 3.h),\n                 ),\n               ],\n             ),\n-            child: const Icon(\n-              Icons.verified_user,\n-              size: 35,\n-              color: Colors.white,\n-            ),\n+            child: Icon(Icons.verified_user, size: 35.sp, color: Colors.white),\n           ),\n-          const SizedBox(height: 16),\n-          const Text(\n+          SizedBox(height: 16.h),\n+          Text(\n             'أدخل رمز التأكيد',\n             style: TextStyle(\n-              fontSize: 24,\n+              fontSize: 24.sp,\n               fontWeight: FontWeight.bold,\n               color: Colors.black87,\n             ),\n           ),\n-          const SizedBox(height: 8),\n+          SizedBox(height: 8.h),\n           Text(\n             'تم إرسال رمز مكون من 6 أرقام إلى',\n-            style: TextStyle(fontSize: 14, color: Colors.grey.shade600),\n+            style: TextStyle(fontSize: 14.sp, color: Colors.grey.shade600),\n           ),\n-          const SizedBox(height: 8),\n+          SizedBox(height: 8.h),\n           Container(\n-            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),\n+            padding: EdgeInsets.symmetric(horizontal: 16.w, vertical: 8.h),\n             decoration: BoxDecoration(\n               color: Colors.blue.shade50,\n-              borderRadius: BorderRadius.circular(20),\n+              borderRadius: BorderRadius.circular(20.r),\n               border: Border.all(color: Colors.blue.shade200),\n             ),\n             child: Row(\n               mainAxisSize: MainAxisSize.min,\n               children: [\n                 Icon(\n                   Icons.phone_android,\n                   color: Colors.blue.shade700,\n-                  size: 16,\n+                  size: 16.sp,\n                 ),\n-                const SizedBox(width: 6),\n+                SizedBox(width: 6.w),\n                 Directionality(\n                   textDirection: TextDirection.ltr,\n                   child: Text(\n                     phoneNumber,\n                     style: TextStyle(\n-                      fontSize: 16,\n+                      fontSize: 16.sp,\n                       fontWeight: FontWeight.bold,\n                       color: Colors.blue.shade700,\n                     ),\n                   ),\n@@ -219,82 +337,233 @@\n       ),\n     );\n   }\n \n-  /// قسم إدخال الرمز\n-  Widget _buildCodeInputSection(CodePhoneController controller) {\n+  /// قسم إدخال الرمز المحسن\n+  Widget _buildEnhancedCodeInputSection(CodePhoneController controller) {\n     return Container(\n-      padding: const EdgeInsets.all(20),\n+      padding: EdgeInsets.all(20.w),\n       decoration: BoxDecoration(\n         color: Colors.white.withOpacity(0.95),\n-        borderRadius: BorderRadius.circular(16),\n+        borderRadius: BorderRadius.circular(16.r),\n         boxShadow: [\n           BoxShadow(\n             color: Colors.black.withOpacity(0.05),\n-            blurRadius: 10,\n-            offset: const Offset(0, 3),\n+            blurRadius: 10.r,\n+            offset: Offset(0, 3.h),\n           ),\n         ],\n       ),\n       child: Column(\n-        mainAxisAlignment: MainAxisAlignment.center,\n         children: [\n-          Text(\n-            'أدخل الرمز المرسل',\n-            style: TextStyle(\n-              fontSize: 16,\n-              fontWeight: FontWeight.w600,\n-              color: Colors.grey.shade700,\n-            ),\n+          Row(\n+            children: [\n+              Icon(Icons.sms, color: Colors.blue.shade600, size: 20.sp),\n+              SizedBox(width: 8.w),\n+              Text(\n+                'أدخل الرمز المرسل',\n+                style: TextStyle(\n+                  fontSize: 16.sp,\n+                  fontWeight: FontWeight.w600,\n+                  color: Colors.grey.shade700,\n+                ),\n+              ),\n+            ],\n           ),\n-          const SizedBox(height: 20),\n-          Obx(() => Row(\n-            mainAxisAlignment: MainAxisAlignment.spaceEvenly,\n-            children: List.generate(\n-              6,\n-              (index) => CodeInputField(\n-                controller: controller.codeControllers[index],\n-                focusNode: controller.focusNodes[index],\n-                isValid: controller.isCodeValid.value,\n-                onComplete: () => controller.checkCodeOnComplete(),\n+          SizedBox(height: 20.h),\n+          // حقل إدخال رمز التحقق باستخدام Pinput\n+          PinputCodeField(controller: controller),\n+          // رسائل الخطأ\n+          Obx(\n+            () =>\n+                controller.errorMessage.value.isNotEmpty\n+                    ? Padding(\n+                      padding: EdgeInsets.only(top: 12.h),\n+                      child: _buildErrorMessage(controller.errorMessage.value),\n+                    )\n+                    : const SizedBox.shrink(),\n+          ),\n+        ],\n+      ),\n+    );\n+  }\n+\n+  /// قسم حالة الشبكة\n+  Widget _buildNetworkStatusSection(CodePhoneController controller) {\n+    return Obx(() {\n+      if (!controller.isNetworkConnected.value) {\n+        return Container(\n+          padding: EdgeInsets.all(12.w),\n+          decoration: BoxDecoration(\n+            color: Colors.red.shade50,\n+            borderRadius: BorderRadius.circular(12.r),\n+            border: Border.all(color: Colors.red.shade200),\n+          ),\n+          child: Row(\n+            children: [\n+              Icon(Icons.wifi_off, color: Colors.red.shade600, size: 20.sp),\n+              SizedBox(width: 8.w),\n+              Expanded(\n+                child: Text(\n+                  'لا يوجد اتصال بالإنترنت. تحقق من اتصالك.',\n+                  style: TextStyle(\n+                    color: Colors.red.shade700,\n+                    fontSize: 14.sp,\n+                    fontWeight: FontWeight.w500,\n+                  ),\n+                ),\n               ),\n-            ),\n-          )),\n-          Obx(() => !controller.isCodeValid.value \n-            ? Padding(\n-                padding: const EdgeInsets.only(top: 12),\n-                child: _buildErrorMessage('الرمز غير صحيح، يرجى المحاولة مرة أخرى'),\n-              )\n-            : const SizedBox.shrink(),\n+            ],\n           ),\n+        ).animate().shake(duration: 800.ms);\n+      }\n+      return const SizedBox.shrink();\n+    });\n+  }\n+\n+  /// قسم إعادة الإرسال المحسن\n+  Widget _buildEnhancedResendSection(CodePhoneController controller) {\n+    return Container(\n+      padding: EdgeInsets.all(16.w),\n+      decoration: BoxDecoration(\n+        color: Colors.white.withOpacity(0.95),\n+        borderRadius: BorderRadius.circular(12.r),\n+        boxShadow: [\n+          BoxShadow(\n+            color: Colors.black.withOpacity(0.05),\n+            blurRadius: 8.r,\n+            offset: Offset(0, 2.h),\n+          ),\n         ],\n       ),\n+      child: Column(\n+        children: [\n+          Row(\n+            children: [\n+              Icon(Icons.refresh, color: Colors.orange.shade600, size: 18.sp),\n+              SizedBox(width: 8.w),\n+              Text(\n+                'لم تتلق الرمز؟',\n+                style: TextStyle(\n+                  fontSize: 14.sp,\n+                  color: Colors.grey.shade600,\n+                  fontWeight: FontWeight.w500,\n+                ),\n+              ),\n+            ],\n+          ),\n+          SizedBox(height: 12.h),\n+          Obx(\n+            () =>\n+                controller.canResend.value\n+                    ? _buildResendButton(controller)\n+                    : _buildResendTimer(controller),\n+          ),\n+          // عداد المحاولات\n+          Obx(\n+            () =>\n+                controller.resendAttempts.value > 0\n+                    ? Padding(\n+                      padding: EdgeInsets.only(top: 8.h),\n+                      child: Text(\n+                        'محاولات الإرسال: ${controller.resendAttempts.value} من 3',\n+                        style: TextStyle(\n+                          fontSize: 12.sp,\n+                          color: Colors.grey.shade500,\n+                        ),\n+                      ),\n+                    )\n+                    : const SizedBox.shrink(),\n+          ),\n+        ],\n+      ),\n     );\n   }\n \n+  /// قسم التقدم والحالة\n+  Widget _buildProgressSection(CodePhoneController controller) {\n+    return Obx(() {\n+      if (!controller.isLoading.value &&\n+          controller.statusMessage.value.isEmpty) {\n+        return const SizedBox.shrink();\n+      }\n+\n+      return Container(\n+        padding: EdgeInsets.all(16.w),\n+        decoration: BoxDecoration(\n+          color: Colors.white.withOpacity(0.95),\n+          borderRadius: BorderRadius.circular(12.r),\n+          boxShadow: [\n+            BoxShadow(\n+              color: Colors.blue.withOpacity(0.1),\n+              blurRadius: 8.r,\n+              offset: Offset(0, 2.h),\n+            ),\n+          ],\n+        ),\n+        child: Column(\n+          children: [\n+            if (controller.isLoading.value) ...[\n+              // شريط التقدم\n+              Obx(\n+                () =>\n+                    controller.progress.value > 0\n+                        ? Column(\n+                          children: [\n+                            LinearProgressIndicator(\n+                              value: controller.progress.value,\n+                              backgroundColor: Colors.grey.shade200,\n+                              valueColor: AlwaysStoppedAnimation<Color>(\n+                                Colors.blue.shade600,\n+                              ),\n+                            ),\n+                            SizedBox(height: 8.h),\n+                          ],\n+                        )\n+                        : CircularProgressIndicator(\n+                          strokeWidth: 2.w,\n+                          valueColor: AlwaysStoppedAnimation<Color>(\n+                            Colors.blue.shade600,\n+                          ),\n+                        ),\n+              ),\n+              SizedBox(height: 12.h),\n+            ],\n+            if (controller.statusMessage.value.isNotEmpty)\n+              Text(\n+                controller.statusMessage.value,\n+                style: TextStyle(\n+                  color: Colors.blue.shade700,\n+                  fontSize: 14.sp,\n+                  fontWeight: FontWeight.w600,\n+                ),\n+                textAlign: TextAlign.center,\n+              ),\n+          ],\n+        ),\n+      );\n+    });\n+  }\n+\n   /// رسالة خطأ محسنة\n   Widget _buildErrorMessage(String message) {\n     return Container(\n-      padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 8),\n+      padding: EdgeInsets.symmetric(horizontal: 12.w, vertical: 8.h),\n       decoration: BoxDecoration(\n         color: Colors.red.shade50,\n-        borderRadius: BorderRadius.circular(8),\n+        borderRadius: BorderRadius.circular(8.r),\n         border: Border.all(color: Colors.red.shade200),\n       ),\n       child: Row(\n         children: [\n-          Icon(\n-            Icons.error_outline,\n-            color: Colors.red.shade600,\n-            size: 16,\n-          ),\n-          const SizedBox(width: 8),\n+          Icon(Icons.error_outline, color: Colors.red.shade600, size: 16.sp),\n+          SizedBox(width: 8.w),\n           Expanded(\n             child: Text(\n               message,\n               style: TextStyle(\n                 color: Colors.red.shade700,\n-                fontSize: 12,\n+                fontSize: 12.sp,\n                 fontWeight: FontWeight.w500,\n               ),\n             ),\n           ),\n@@ -302,148 +571,56 @@\n       ),\n     );\n   }\n \n-  /// قسم إعادة الإرسال\n-  Widget _buildResendSection(CodePhoneController controller) {\n-    return Container(\n-      padding: const EdgeInsets.all(16),\n-      decoration: BoxDecoration(\n-        color: Colors.white.withOpacity(0.95),\n-        borderRadius: BorderRadius.circular(12),\n-        boxShadow: [\n-          BoxShadow(\n-            color: Colors.black.withOpacity(0.05),\n-            blurRadius: 8,\n-            offset: const Offset(0, 2),\n-          ),\n-        ],\n-      ),\n-      child: Column(\n-        mainAxisAlignment: MainAxisAlignment.center,\n-        children: [\n-          Text(\n-            'لم تتلق الرمز؟',\n-            style: TextStyle(\n-              fontSize: 14,\n-              color: Colors.grey.shade600,\n-              fontWeight: FontWeight.w500,\n-            ),\n-          ),\n-          const SizedBox(height: 12),\n-          Obx(() => controller.canResend.value\n-            ? _buildResendButton(controller)\n-            : _buildResendTimer(controller),\n-          ),\n-        ],\n-      ),\n-    );\n-  }\n-\n   /// زر إعادة الإرسال\n   Widget _buildResendButton(CodePhoneController controller) {\n     return ElevatedButton.icon(\n       onPressed: () => controller.resendCode(),\n-      icon: const Icon(Icons.refresh, size: 18, color: Colors.white),\n-      label: const Text(\n+      icon: Icon(Icons.refresh, size: 18.sp, color: Colors.white),\n+      label: Text(\n         'إعادة إرسال الرمز',\n         style: TextStyle(\n-          fontSize: 14,\n+          fontSize: 14.sp,\n           fontWeight: FontWeight.bold,\n           color: Colors.white,\n         ),\n       ),\n       style: ElevatedButton.styleFrom(\n         backgroundColor: Colors.blue.shade600,\n-        padding: const EdgeInsets.symmetric(horizontal: 20, vertical: 10),\n+        padding: EdgeInsets.symmetric(horizontal: 20.w, vertical: 10.h),\n         shape: RoundedRectangleBorder(\n-          borderRadius: BorderRadius.circular(20),\n+          borderRadius: BorderRadius.circular(20.r),\n         ),\n       ),\n     );\n   }\n \n   /// مؤقت إعادة الإرسال\n   Widget _buildResendTimer(CodePhoneController controller) {\n     return Container(\n-      padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 10),\n+      padding: EdgeInsets.symmetric(horizontal: 16.w, vertical: 10.h),\n       decoration: BoxDecoration(\n         color: Colors.orange.shade100,\n-        borderRadius: BorderRadius.circular(16),\n+        borderRadius: BorderRadius.circular(16.r),\n         border: Border.all(color: Colors.orange.shade200),\n       ),\n       child: Row(\n         mainAxisSize: MainAxisSize.min,\n         children: [\n-          Icon(Icons.timer, color: Colors.orange.shade600, size: 16),\n-          const SizedBox(width: 8),\n-          Obx(() => Text(\n-            'إعادة الإرسال خلال ${controller.resendCounter.value} ثانية',\n-            style: TextStyle(\n-              color: Colors.orange.shade800,\n-              fontSize: 12,\n-              fontWeight: FontWeight.w600,\n+          Icon(Icons.timer, color: Colors.orange.shade600, size: 16.sp),\n+          SizedBox(width: 8.w),\n+          Obx(\n+            () => Text(\n+              'إعادة الإرسال خلال ${controller.resendCounter.value} ثانية',\n+              style: TextStyle(\n+                color: Colors.orange.shade800,\n+                fontSize: 12.sp,\n+                fontWeight: FontWeight.w600,\n+              ),\n             ),\n-          )),\n+          ),\n         ],\n       ),\n     );\n   }\n-\n-  /// قسم حالة العملية\n-  Widget _buildStatusSection(CodePhoneController controller) {\n-    return Obx(() {\n-      if (!controller.isLoading.value &&\n-          controller.statusMessage.value.isEmpty) {\n-        return const SizedBox.shrink();\n-      }\n-\n-      return Container(\n-        padding: const EdgeInsets.all(16),\n-        decoration: BoxDecoration(\n-          color: Colors.white.withOpacity(0.95),\n-          borderRadius: BorderRadius.circular(12),\n-          boxShadow: [\n-            BoxShadow(\n-              color: Colors.blue.withOpacity(0.1),\n-              blurRadius: 8,\n-              offset: const Offset(0, 2),\n-            ),\n-          ],\n-        ),\n-        child: Column(\n-          children: [\n-            if (controller.isLoading.value) ...[\n-              Container(\n-                width: 40,\n-                height: 40,\n-                decoration: BoxDecoration(\n-                  gradient: LinearGradient(\n-                    colors: [Colors.blue.shade400, Colors.blue.shade600],\n-                  ),\n-                  shape: BoxShape.circle,\n-                ),\n-                child: const Center(\n-                  child: CircularProgressIndicator(\n-                    valueColor: AlwaysStoppedAnimation<Color>(Colors.white),\n-                    strokeWidth: 2,\n-                  ),\n-                ),\n-              ),\n-              const SizedBox(height: 12),\n-              if (controller.statusMessage.value.isNotEmpty)\n-                Text(\n-                  controller.statusMessage.value,\n-                  style: TextStyle(\n-                    color: Colors.blue.shade700,\n-                    fontSize: 14,\n-                    fontWeight: FontWeight.w600,\n-                  ),\n-                  textAlign: TextAlign.center,\n-                ),\n-            ],\n-          ],\n-        ),\n-      );\n-    });\n-  }\n }\n"
                }
            ],
            "date": 1752751503159,
            "name": "Commit-0",
            "content": "import 'package:flutter/material.dart';\nimport 'package:flutter/services.dart';\nimport 'package:get/get.dart';\nimport 'dart:typed_data';\n\nimport 'controllers/code_phone_controller.dart';\nimport 'widgets/code_input_field.dart';\n\n/// صفحة إدخال رمز التحقق المحسنة\nclass CodePhonePage1 extends StatelessWidget {\n  final String phoneNumber;\n  final Uint8List userImage;\n  final String name;\n  final String email;\n  final String password;\n  final bool hasPassword;\n\n  const CodePhonePage1({\n    super.key,\n    required this.phoneNumber,\n    required this.userImage,\n    required this.name,\n    required this.email,\n    required this.password,\n    required this.hasPassword,\n  });\n\n  @override\n  Widget build(BuildContext context) {\n    final controller = Get.put(\n      CodePhoneController(\n        phoneNumber: phoneNumber,\n        userImage: userImage,\n        name: name,\n        email: email,\n        password: password,\n        hasPassword: hasPassword,\n      ),\n    );\n\n    return Scaffold(\n      backgroundColor: Colors.grey.shade50,\n      appBar: AppBar(\n        backgroundColor: Colors.transparent,\n        elevation: 0,\n        leading: IconButton(\n          icon: const Icon(Icons.arrow_back_ios, color: Colors.black87),\n          onPressed: () => Get.back(),\n        ),\n        title: const Text(\n          'تأكيد رقم الهاتف',\n          style: TextStyle(color: Colors.black87, fontWeight: FontWeight.bold),\n        ),\n        centerTitle: true,\n      ),\n      body: SafeArea(\n        child: Padding(\n          padding: const EdgeInsets.all(24.0),\n          child: Column(\n            children: [\n              Expanded(\n                child: SingleChildScrollView(\n                  child: Column(\n                    children: [\n                      _buildHeader(),\n                      const SizedBox(height: 40),\n                      _buildCodeInputSection(controller),\n                      const SizedBox(height: 30),\n                      _buildResendSection(controller),\n                      const SizedBox(height: 40),\n                      _buildStatusSection(controller),\n                    ],\n                  ),\n                ),\n              ),\n              _buildBottomSection(controller),\n            ],\n          ),\n        ),\n      ),\n    );\n  }\n\n  /// قسم العنوان والوصف\n  Widget _buildHeader() {\n    return Column(\n      children: [\n        Container(\n          padding: const EdgeInsets.all(20),\n          decoration: BoxDecoration(\n            color: Colors.blue.shade100,\n            shape: BoxShape.circle,\n          ),\n          child: Icon(\n            Icons.sms_outlined,\n            size: 60,\n            color: Colors.blue.shade600,\n          ),\n        ),\n        const SizedBox(height: 24),\n        const Text(\n          'أدخل رمز التأكيد',\n          style: TextStyle(\n            fontSize: 28,\n            fontWeight: FontWeight.bold,\n            color: Colors.black87,\n          ),\n        ),\n        const SizedBox(height: 12),\n        Text(\n          'تم إرسال رمز مكون من 6 أرقام إلى',\n          style: TextStyle(fontSize: 16, color: Colors.grey.shade600),\n        ),\n        const SizedBox(height: 8),\n        Container(\n          padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),\n          decoration: BoxDecoration(\n            color: Colors.blue.shade50,\n            borderRadius: BorderRadius.circular(20),\n            border: Border.all(color: Colors.blue.shade200),\n          ),\n          child: Directionality(\n            textDirection: TextDirection.ltr,\n            child: Text(\n              phoneNumber,\n              style: TextStyle(\n                fontSize: 18,\n                fontWeight: FontWeight.bold,\n                color: Colors.blue.shade700,\n              ),\n            ),\n          ),\n        ),\n      ],\n    );\n  }\n\n  /// قسم إدخال الرمز\n  Widget _buildCodeInputSection(CodePhoneController controller) {\n    return Obx(\n      () => Column(\n        children: [\n          Row(\n            mainAxisAlignment: MainAxisAlignment.spaceEvenly,\n            children: List.generate(\n              6,\n              (index) => CodeInputField(\n                controller: controller.codeControllers[index],\n                focusNode: controller.focusNodes[index],\n                isValid: controller.isCodeValid.value,\n                onComplete: () => controller.checkCodeOnComplete(),\n              ),\n            ),\n          ),\n          if (!controller.isCodeValid.value) ...[\n            const SizedBox(height: 12),\n            Container(\n              padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),\n              decoration: BoxDecoration(\n                color: Colors.red.shade50,\n                borderRadius: BorderRadius.circular(8),\n                border: Border.all(color: Colors.red.shade200),\n              ),\n              child: Row(\n                mainAxisSize: MainAxisSize.min,\n                children: [\n                  Icon(\n                    Icons.error_outline,\n                    color: Colors.red.shade600,\n                    size: 20,\n                  ),\n                  const SizedBox(width: 8),\n                  Text(\n                    'الرمز غير صحيح، يرجى المحاولة مرة أخرى',\n                    style: TextStyle(color: Colors.red.shade600, fontSize: 14),\n                  ),\n                ],\n              ),\n            ),\n          ],\n        ],\n      ),\n    );\n  }\n\n  /// قسم إعادة الإرسال\n  Widget _buildResendSection(CodePhoneController controller) {\n    return Obx(\n      () => Column(\n        children: [\n          Text(\n            'لم تتلق الرمز؟',\n            style: TextStyle(fontSize: 16, color: Colors.grey.shade600),\n          ),\n          const SizedBox(height: 12),\n          if (controller.canResend.value)\n            _buildResendButton(controller)\n          else\n            _buildResendTimer(controller),\n        ],\n      ),\n    );\n  }\n\n  /// زر إعادة الإرسال\n  Widget _buildResendButton(CodePhoneController controller) {\n    return ElevatedButton.icon(\n      onPressed: () => controller.resendCode(),\n      icon: const Icon(Icons.refresh, size: 20),\n      label: const Text(\n        'إعادة إرسال الرمز',\n        style: TextStyle(fontSize: 16, fontWeight: FontWeight.bold),\n      ),\n      style: ElevatedButton.styleFrom(\n        backgroundColor: Colors.blue.shade600,\n        foregroundColor: Colors.white,\n        padding: const EdgeInsets.symmetric(horizontal: 24, vertical: 12),\n        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(25)),\n        elevation: 2,\n      ),\n    );\n  }\n\n  /// مؤقت إعادة الإرسال\n  Widget _buildResendTimer(CodePhoneController controller) {\n    return Container(\n      padding: const EdgeInsets.symmetric(horizontal: 20, vertical: 12),\n      decoration: BoxDecoration(\n        color: Colors.orange.shade50,\n        borderRadius: BorderRadius.circular(20),\n        border: Border.all(color: Colors.orange.shade200),\n      ),\n      child: Row(\n        mainAxisSize: MainAxisSize.min,\n        children: [\n          Icon(Icons.timer_outlined, color: Colors.orange.shade600, size: 20),\n          const SizedBox(width: 8),\n          Text(\n            'إعادة الإرسال خلال ${controller.resendCounter.value} ثانية',\n            style: TextStyle(\n              color: Colors.orange.shade700,\n              fontSize: 16,\n              fontWeight: FontWeight.w500,\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n\n  /// قسم حالة العملية\n  Widget _buildStatusSection(CodePhoneController controller) {\n    return Obx(() {\n      if (!controller.isLoading.value &&\n          controller.statusMessage.value.isEmpty) {\n        return const SizedBox.shrink();\n      }\n\n      return Column(\n        children: [\n          if (controller.isLoading.value) ...[\n            Container(\n              padding: const EdgeInsets.all(20),\n              decoration: BoxDecoration(\n                color: Colors.blue.shade50,\n                borderRadius: BorderRadius.circular(16),\n                border: Border.all(color: Colors.blue.shade200),\n              ),\n              child: Column(\n                children: [\n                  CircularProgressIndicator(\n                    valueColor: AlwaysStoppedAnimation<Color>(\n                      Colors.blue.shade600,\n                    ),\n                  ),\n                  if (controller.statusMessage.value.isNotEmpty) ...[\n                    const SizedBox(height: 16),\n                    Text(\n                      controller.statusMessage.value,\n                      style: TextStyle(\n                        color: Colors.blue.shade700,\n                        fontSize: 16,\n                        fontWeight: FontWeight.w500,\n                      ),\n                      textAlign: TextAlign.center,\n                    ),\n                  ],\n                  if (controller.progress.value > 0) ...[\n                    const SizedBox(height: 16),\n                    LinearProgressIndicator(\n                      value: controller.progress.value,\n                      backgroundColor: Colors.blue.shade100,\n                      valueColor: AlwaysStoppedAnimation<Color>(\n                        Colors.blue.shade600,\n                      ),\n                    ),\n                    const SizedBox(height: 8),\n                    Text(\n                      '${(controller.progress.value * 100).toInt()}%',\n                      style: TextStyle(\n                        color: Colors.blue.shade600,\n                        fontSize: 14,\n                        fontWeight: FontWeight.bold,\n                      ),\n                    ),\n                  ],\n                ],\n              ),\n            ),\n          ],\n        ],\n      );\n    });\n  }\n\n  /// القسم السفلي\n  Widget _buildBottomSection(CodePhoneController controller) {\n    return Container(\n      padding: const EdgeInsets.all(16),\n      decoration: BoxDecoration(\n        color: Colors.white,\n        borderRadius: const BorderRadius.vertical(top: Radius.circular(20)),\n        boxShadow: [\n          BoxShadow(\n            color: Colors.black.withOpacity(0.1),\n            blurRadius: 10,\n            offset: const Offset(0, -2),\n          ),\n        ],\n      ),\n      child: Column(\n        mainAxisSize: MainAxisSize.min,\n        children: [\n          Row(\n            children: [\n              Icon(Icons.security, color: Colors.green.shade600, size: 20),\n              const SizedBox(width: 8),\n              Expanded(\n                child: Text(\n                  'بياناتك محمية بأعلى معايير الأمان',\n                  style: TextStyle(color: Colors.grey.shade600, fontSize: 14),\n                ),\n              ),\n            ],\n          ),\n          const SizedBox(height: 12),\n          Row(\n            children: [\n              Icon(Icons.info_outline, color: Colors.blue.shade600, size: 20),\n              const SizedBox(width: 8),\n              Expanded(\n                child: Text(\n                  'قد يستغرق وصول الرمز عدة دقائق',\n                  style: TextStyle(color: Colors.grey.shade600, fontSize: 14),\n                ),\n              ),\n            ],\n          ),\n        ],\n      ),\n    );\n  }\n}\n"
        }
    ]
}