{
    "sourceFile": "lib/Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø®Ø§Øµ Ø¨ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ù…ÙŠÙ„ /services/firebase_phone_helper.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1753181638899,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1753181638899,
            "name": "Commit-0",
            "content": "import 'dart:io';\nimport 'package:firebase_auth/firebase_auth.dart';\nimport 'package:flutter/foundation.dart';\n\n/// ÙƒÙ„Ø§Ø³ Ù…Ø³Ø§Ø¹Ø¯ Ù„ØªØ´Ø®ÙŠØµ ÙˆØ­Ù„ Ù…Ø´Ø§ÙƒÙ„ Firebase Phone Auth\nclass FirebasePhoneHelper {\n  static const String version = '1.0.0';\n\n  /// ØªØ´Ø®ÙŠØµ Ø´Ø§Ù…Ù„ Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase Phone Auth\n  static Future<Map<String, dynamic>> comprehensiveDiagnosis() async {\n    final diagnosis = <String, dynamic>{\n      'helper_version': version,\n      'timestamp': DateTime.now().toIso8601String(),\n    };\n\n    try {\n      // 1. Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Firebase Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©\n      final auth = FirebaseAuth.instance;\n      diagnosis['firebase'] = {\n        'app_id': auth.app.options.appId,\n        'project_id': auth.app.options.projectId,\n        'api_key': auth.app.options.apiKey.substring(0, 10) + '...',\n        'current_user': auth.currentUser?.uid ?? 'no_user',\n        'auth_domain': auth.app.options.authDomain,\n      };\n\n      // 2. Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù†ØµØ©\n      diagnosis['platform'] = {\n        'os': Platform.operatingSystem,\n        'version': Platform.operatingSystemVersion,\n        'is_android': Platform.isAndroid,\n        'is_ios': Platform.isIOS,\n        'is_debug': kDebugMode,\n      };\n\n      // 3. ÙØ­Øµ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Android\n      if (Platform.isAndroid) {\n        diagnosis['android'] = await _diagnoseAndroid(auth);\n      }\n\n      // 4. ÙØ­Øµ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª iOS\n      if (Platform.isIOS) {\n        diagnosis['ios'] = await _diagnoseiOS(auth);\n      }\n\n      // 5. Ù†ØµØ§Ø¦Ø­ Ø§Ù„ØªØ­Ø³ÙŠÙ†\n      diagnosis['optimization_tips'] = _getOptimizationTips();\n\n      debugPrint('ğŸ” ØªØ´Ø®ÙŠØµ Firebase Phone Auth Ù…ÙƒØªÙ…Ù„');\n      return diagnosis;\n    } catch (e) {\n      diagnosis['error'] = e.toString();\n      debugPrint('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ´Ø®ÙŠØµ Ø§Ù„Ø´Ø§Ù…Ù„: $e');\n      return diagnosis;\n    }\n  }\n\n  /// ØªØ´Ø®ÙŠØµ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Android\n  static Future<Map<String, dynamic>> _diagnoseAndroid(\n    FirebaseAuth auth,\n  ) async {\n    final androidDiag = <String, dynamic>{};\n\n    try {\n      // ÙØ­Øµ SHA-1 fingerprint (Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„ÙŠÙ‡ Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Flutter)\n      androidDiag['sha1_note'] =\n          'ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¶Ø§ÙØ© SHA-1 fingerprint ÙÙŠ Firebase Console';\n\n      // ÙØ­Øµ SMS permissions\n      androidDiag['sms_permissions'] = {\n        'note': 'ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¶Ø§ÙØ© Ø£Ø°ÙˆÙ†Ø§Øª SMS ÙÙŠ AndroidManifest.xml',\n        'required_permissions': [\n          'android.permission.RECEIVE_SMS',\n          'android.permission.READ_SMS',\n        ],\n      };\n\n      // Ù†ØµØ§Ø¦Ø­ Android\n      androidDiag['tips'] = [\n        'ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ø¯ÙŠØ« Google Play Services',\n        'ÙØ¹Ù„ SafetyNet ÙÙŠ Firebase Console',\n        'ØªØ£ÙƒØ¯ Ù…Ù† SHA-1 fingerprint Ù„Ù„ØªÙˆÙ‚ÙŠØ¹',\n      ];\n\n      return androidDiag;\n    } catch (e) {\n      androidDiag['error'] = e.toString();\n      return androidDiag;\n    }\n  }\n\n  /// ØªØ´Ø®ÙŠØµ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª iOS\n  static Future<Map<String, dynamic>> _diagnoseiOS(FirebaseAuth auth) async {\n    final iosDiag = <String, dynamic>{};\n\n    try {\n      // ÙØ­Øµ Bundle ID\n      iosDiag['bundle_id_note'] = 'ØªØ£ÙƒØ¯ Ù…Ù† ØªØ·Ø§Ø¨Ù‚ Bundle ID Ù…Ø¹ Firebase Console';\n\n      // ÙØ­Øµ APN\n      iosDiag['apn_setup'] = {\n        'note': 'reCAPTCHA Ù‚Ø¯ ÙŠØªØ·Ù„Ø¨ Ø¥Ø¹Ø¯Ø§Ø¯ APN ØµØ­ÙŠØ­',\n        'requirements': [\n          'APN Key ÙÙŠ Firebase Console',\n          'ØªÙØ¹ÙŠÙ„ Push Notifications ÙÙŠ Xcode',\n        ],\n      };\n\n      // Ù†ØµØ§Ø¦Ø­ iOS\n      iosDiag['tips'] = [\n        'ØªØ£ÙƒØ¯ Ù…Ù† Bundle ID ØµØ­ÙŠØ­',\n        'ÙØ¹Ù„ Push Notifications capability',\n        'ØªØ£ÙƒØ¯ Ù…Ù† APN authentication key',\n        'Ø§Ø®ØªØ¨Ø± Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø² Ø­Ù‚ÙŠÙ‚ÙŠ ÙˆÙ„ÙŠØ³ Ø§Ù„Ù…Ø­Ø§ÙƒÙŠ',\n      ];\n\n      return iosDiag;\n    } catch (e) {\n      iosDiag['error'] = e.toString();\n      return iosDiag;\n    }\n  }\n\n  /// Ù†ØµØ§Ø¦Ø­ ØªØ­Ø³ÙŠÙ† Ø¹Ø§Ù…Ø©\n  static List<String> _getOptimizationTips() {\n    return [\n      'ğŸ”§ ØªØ£ÙƒØ¯ Ù…Ù† ØªÙØ¹ÙŠÙ„ Phone Authentication ÙÙŠ Firebase Console',\n      'ğŸ“± Ø£Ø¶Ù Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ© ÙÙŠ Ù‚Ø³Ù… \"Phone numbers for testing\"',\n      'ğŸŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª reCAPTCHA Ù„Ù„Ù…Ù†ØµØ© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©',\n      'ğŸ”’ Ø§Ø³ØªØ®Ø¯Ù… HTTPS Ù„Ù„Ù€ Authorized domains',\n      'ğŸ“Š Ø±Ø§Ù‚Ø¨ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Firebase Console',\n      'ğŸ§ª Ø§Ø®ØªØ¨Ø± Ù…Ø¹ Ø£Ø±Ù‚Ø§Ù… Ø­Ù‚ÙŠÙ‚ÙŠØ© ÙˆØªØ¬Ø±ÙŠØ¨ÙŠØ©',\n      'ğŸ”„ Ø£Ø¹Ø¯ ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø¹Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª',\n    ];\n  }\n\n  /// ÙØ­Øµ ØµØ­Ø© Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ù…Ø­Ø³Ù†\n  static Map<String, dynamic> validatePhoneNumberAdvanced(String phoneNumber) {\n    final validation = <String, dynamic>{\n      'input': phoneNumber,\n      'timestamp': DateTime.now().toIso8601String(),\n    };\n\n    // 1. ÙØ­Øµ Ø£Ø³Ø§Ø³ÙŠ\n    validation['basic'] = {\n      'has_plus': phoneNumber.startsWith('+'),\n      'length': phoneNumber.length,\n      'is_numeric_only': RegExp(r'^\\+\\d+$').hasMatch(phoneNumber),\n      'contains_spaces': phoneNumber.contains(' '),\n      'contains_dashes': phoneNumber.contains('-'),\n    };\n\n    // 2. ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¯ÙˆÙ„Ø©\n    validation['country'] = _analyzeCountryCode(phoneNumber);\n\n    // 3. ØªØ­Ù„ÙŠÙ„ Ù†ÙˆØ¹ Ø§Ù„Ø±Ù‚Ù…\n    validation['type'] = _analyzePhoneType(phoneNumber);\n\n    // 4. Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø§Ù„ØªØ­Ø³ÙŠÙ†\n    validation['suggestions'] = _getSuggestions(phoneNumber);\n\n    return validation;\n  }\n\n  /// ØªØ­Ù„ÙŠÙ„ Ø±Ù…Ø² Ø§Ù„Ø¯ÙˆÙ„Ø©\n  static Map<String, dynamic> _analyzeCountryCode(String phoneNumber) {\n    final countryData = <String, dynamic>{};\n\n    if (phoneNumber.startsWith('+964')) {\n      countryData.addAll({\n        'country': 'Ø§Ù„Ø¹Ø±Ø§Ù‚',\n        'code': '+964',\n        'valid_length_range': '13-14',\n        'operators': ['Ø²ÙŠÙ†', 'Ø¢Ø³ÙŠØ§Ø³ÙŠÙ„', 'ÙƒÙˆØ±Ùƒ'],\n        'is_supported': true,\n      });\n    } else if (phoneNumber.startsWith('+966')) {\n      countryData.addAll({\n        'country': 'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',\n        'code': '+966',\n        'valid_length_range': '13',\n        'operators': ['STC', 'Mobily', 'Zain'],\n        'is_supported': true,\n      });\n    } else if (phoneNumber.startsWith('+1')) {\n      countryData.addAll({\n        'country': 'Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø¯Ø©/ÙƒÙ†Ø¯Ø§',\n        'code': '+1',\n        'valid_length_range': '12',\n        'is_supported': true,\n      });\n    } else {\n      countryData.addAll({\n        'country': 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',\n        'code':\n            phoneNumber.length > 3 ? phoneNumber.substring(0, 4) : 'ØºÙŠØ± ØµØ­ÙŠØ­',\n        'is_supported': 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ',\n      });\n    }\n\n    return countryData;\n  }\n\n  /// ØªØ­Ù„ÙŠÙ„ Ù†ÙˆØ¹ Ø§Ù„Ø±Ù‚Ù…\n  static Map<String, dynamic> _analyzePhoneType(String phoneNumber) {\n    final typeData = <String, dynamic>{};\n\n    // ÙØ­Øµ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø±Ù‚Ù…Ø§Ù‹ ØªØ¬Ø±ÙŠØ¨ÙŠØ§Ù‹\n    final testPatterns = [\n      '+1555',\n      '+15005550',\n      '+4474',\n      '+33123456',\n      '+96412345',\n      '+966123',\n    ];\n\n    bool isTestNumber = false;\n    for (final pattern in testPatterns) {\n      if (phoneNumber.startsWith(pattern)) {\n        isTestNumber = true;\n        break;\n      }\n    }\n\n    // ÙØ­Øµ Ø£Ù†Ù…Ø§Ø· ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ø£Ø®Ø±Ù‰\n    if (!isTestNumber) {\n      if (phoneNumber.contains('123456') ||\n          phoneNumber.contains('555555') ||\n          phoneNumber.contains('000000')) {\n        isTestNumber = true;\n      }\n    }\n\n    typeData['is_test_number'] = isTestNumber;\n    typeData['type'] = isTestNumber ? 'ØªØ¬Ø±ÙŠØ¨ÙŠ' : 'Ø­Ù‚ÙŠÙ‚ÙŠ';\n\n    if (isTestNumber) {\n      typeData['test_note'] =\n          'ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… ÙÙŠ Firebase Console ØªØ­Øª \"Phone numbers for testing\"';\n    }\n\n    return typeData;\n  }\n\n  /// Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø±Ù‚Ù…\n  static List<String> _getSuggestions(String phoneNumber) {\n    final suggestions = <String>[];\n\n    if (!phoneNumber.startsWith('+')) {\n      suggestions.add('Ø£Ø¶Ù Ø±Ù…Ø² Ø§Ù„Ø¯ÙˆÙ„Ø© (Ù…Ø«Ù„ +964 Ù„Ù„Ø¹Ø±Ø§Ù‚)');\n    }\n\n    if (phoneNumber.contains(' ') || phoneNumber.contains('-')) {\n      suggestions.add('Ø§Ø­Ø°Ù Ø§Ù„Ù…Ø³Ø§ÙØ§Øª ÙˆØ§Ù„Ø´Ø±Ø·Ø§Øª');\n    }\n\n    if (phoneNumber.length < 10) {\n      suggestions.add('Ø§Ù„Ø±Ù‚Ù… Ù‚ØµÙŠØ± Ø¬Ø¯Ø§Ù‹ØŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø±Ù‚Ù… ÙƒØ§Ù…Ù„Ø§Ù‹');\n    }\n\n    if (phoneNumber.length > 15) {\n      suggestions.add('Ø§Ù„Ø±Ù‚Ù… Ø·ÙˆÙŠÙ„ Ø¬Ø¯Ø§Ù‹ØŒ ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­ØªÙ‡');\n    }\n\n    if (!RegExp(r'^\\+\\d+$').hasMatch(phoneNumber)) {\n      suggestions.add('Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙˆØ±Ù…Ø² + ÙÙ‚Ø·');\n    }\n\n    if (suggestions.isEmpty) {\n      suggestions.add('Ø§Ù„Ø±Ù‚Ù… ÙŠØ¨Ø¯Ùˆ ØµØ­ÙŠØ­Ø§Ù‹');\n    }\n\n    return suggestions;\n  }\n\n  /// Ù†ØµØ§Ø¦Ø­ Ù„Ø­Ù„ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©\n  static Map<String, List<String>> getCommonSolutions() {\n    return {\n      'ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù…Ø²': [\n        'ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª',\n        'ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ',\n        'ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase Console',\n        'Ø£Ø¹Ø¯ ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚',\n        'Ø¬Ø±Ø¨ Ø±Ù‚Ù…Ø§Ù‹ ØªØ¬Ø±ÙŠØ¨ÙŠØ§Ù‹ Ø£ÙˆÙ„Ø§Ù‹',\n      ],\n      'Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ ØºÙŠØ± ØµØ­ÙŠØ­': [\n        'ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù…Ø² Ø§Ù„ØµØ­ÙŠØ­',\n        'Ù„Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©: Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø±Ù…Ø² Ù…Ù† Firebase Console',\n        'Ù„Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©: Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø±Ù…Ø² Ù…Ù† SMS',\n        'ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù†ØªÙ‡Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø±Ù…Ø²',\n      ],\n      'Ø®Ø·Ø£ internal-error': [\n        'Ø£Ø¹Ø¯ ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚',\n        'ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª reCAPTCHA',\n        'ØªØ­Ù‚Ù‚ Ù…Ù† SHA-1 fingerprint (Android)',\n        'ØªØ­Ù‚Ù‚ Ù…Ù† Bundle ID (iOS)',\n        'Ø¬Ø±Ø¨ Ø¹Ù„Ù‰ Ø´Ø¨ÙƒØ© Ù…Ø®ØªÙ„ÙØ©',\n      ],\n      'Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ø·Ù„Ø¨Ø§Øª': [\n        'Ø§Ù†ØªØ¸Ø± Ø¨Ø¶Ø¹ Ø¯Ù‚Ø§Ø¦Ù‚ Ù‚Ø¨Ù„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©',\n        'Ø§Ø³ØªØ®Ø¯Ù… Ø£Ø±Ù‚Ø§Ù…Ø§Ù‹ ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±',\n        'ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ÙˆØ¯ Firebase ÙÙŠ Console',\n      ],\n    };\n  }\n\n  /// Ø·Ø¨Ø§Ø¹Ø© ØªÙ‚Ø±ÙŠØ± Ù…ÙØµÙ„\n  static void printDetailedReport(Map<String, dynamic> diagnosis) {\n    print('\\nğŸ” ===== ØªÙ‚Ø±ÙŠØ± ØªØ´Ø®ÙŠØµ Firebase Phone Auth =====');\n    print('ğŸ“… Ø§Ù„ÙˆÙ‚Øª: ${diagnosis['timestamp']}');\n    print('ğŸ“± Ø§Ù„Ù…Ù†ØµØ©: ${diagnosis['platform']['os']}');\n    print('ğŸ”§ Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯: ${diagnosis['helper_version']}');\n\n    if (diagnosis.containsKey('firebase')) {\n      print('\\nğŸ”¥ Firebase:');\n      final firebase = diagnosis['firebase'] as Map<String, dynamic>;\n      firebase.forEach((key, value) {\n        print('   $key: $value');\n      });\n    }\n\n    if (diagnosis.containsKey('android')) {\n      print('\\nğŸ¤– Android:');\n      print('   ${diagnosis['android']}');\n    }\n\n    if (diagnosis.containsKey('ios')) {\n      print('\\nğŸ iOS:');\n      print('   ${diagnosis['ios']}');\n    }\n\n    if (diagnosis.containsKey('optimization_tips')) {\n      print('\\nğŸ’¡ Ù†ØµØ§Ø¦Ø­ Ø§Ù„ØªØ­Ø³ÙŠÙ†:');\n      for (final tip in diagnosis['optimization_tips'] as List<String>) {\n        print('   â€¢ $tip');\n      }\n    }\n\n    print('\\nğŸ”§ ===== Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØªÙ‚Ø±ÙŠØ± =====\\n');\n  }\n}\n"
        }
    ]
}