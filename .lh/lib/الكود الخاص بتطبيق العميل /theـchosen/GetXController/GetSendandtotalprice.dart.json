{
    "sourceFile": "lib/Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø®Ø§Øµ Ø¨ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ù…ÙŠÙ„ /theÙ€chosen/GetXController/GetSendandtotalprice.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1753157006802,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1753157006802,
            "name": "Commit-0",
            "content": "import 'dart:async';\nimport 'dart:ui' as ui;\nimport 'package:cloud_firestore/cloud_firestore.dart';\nimport 'package:firebase_auth/firebase_auth.dart';\nimport 'package:flutter/material.dart';\nimport 'package:flutter/services.dart';\nimport 'package:get/get.dart';\nimport 'package:geolocator/geolocator.dart';\n\nimport '../../../XXX/xxx_firebase.dart';\nimport '../../googleMap/GoogleMapOrder.dart';\n\n/// ÙŠØªØ­ÙƒÙ… Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØ­ÙƒÙ… ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© (ÙƒÙ…Ø§ ÙÙŠ Ø³ÙŠØ§Ù‚ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚).\n/// ÙŠÙ‚ÙˆÙ… Ø¨Ø§Ø³ØªÙŠØ±Ø§Ø¯ ØµÙˆØ±Ø© Ù…Ù† Ø§Ù„Ø£ØµÙˆÙ„ Ù„ØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ø¥Ù„Ù‰ Marker Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©ØŒ ÙˆÙŠØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŒ\n/// Ø«Ù… ÙŠÙ†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ø´Ø§Ø´Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ù…Ø¹ ØªÙ…Ø±ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ù„Ø±Ù…Ø² Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….\nclass GetSendAndTotalPrice extends GetxController {\n  final String uid; // Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª\n  // Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ (ÙŠÙ…ÙƒÙ† Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… RxBool)\n  RxBool isLoading = false.obs;\n\n  // Ø§Ù„Ù…ØªØºÙŠØ± Ø§Ù„Ø°ÙŠ Ø³ÙŠØ­Ù…Ù„ Ø¨ÙŠØ§Ù†Ø§Øª ØµÙˆØ±Ø© Marker Ø¨Ø´ÙƒÙ„ Uint8List Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©.\n  Uint8List? markerUser;\n\n  // Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ (ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ù„Ø§Ø­Ù‚Ø§Ù‹ Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª Ù…ØªØ§Ø¨Ø¹Ø© ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø´ÙƒÙ„ Ù…Ø³ØªÙ…Ø±)\n  late StreamSubscription<Position> positionStream;\n\n  GetSendAndTotalPrice({required this.uid});\n\n  /// Ø¯Ø§Ù„Ø© Ù…Ø­Ø³Ù†Ø© Ù„ØªØ­ÙˆÙŠÙ„ ØµÙˆØ±Ø© Ù…Ù† Ø§Ù„Ø£ØµÙˆÙ„ Ø¥Ù„Ù‰ Uint8List Ù…Ø¹ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ù„Ø£Ø®Ø·Ø§Ø¡\n  Future<Uint8List> getBytesFromAsset(String path, int width) async {\n    try {\n      debugPrint(\"ğŸ–¼ï¸ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ù…Ù†: $path\");\n\n      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„ØµÙˆØ±Ø© Ø£ÙˆÙ„Ø§Ù‹\n      ByteData? data;\n      try {\n        data = await rootBundle.load(path);\n        debugPrint(\n          \"âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­ØŒ Ø§Ù„Ø­Ø¬Ù…: ${data.lengthInBytes} bytes\",\n        );\n      } catch (e) {\n        debugPrint(\"âŒ Ø§Ù„ØµÙˆØ±Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø±: $path\");\n        debugPrint(\"ğŸ”„ Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ marker Ø§ÙØªØ±Ø§Ø¶ÙŠ...\");\n        return await _createDefaultMarkerImage(width);\n      }\n\n      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª\n      if (data.lengthInBytes == 0) {\n        debugPrint(\"âŒ Ø§Ù„ØµÙˆØ±Ø© ÙØ§Ø±ØºØ©\");\n        return await _createDefaultMarkerImage(width);\n      }\n\n      // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Uint8List\n      final Uint8List imageBytes = data.buffer.asUint8List();\n\n      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØµÙˆØ±Ø©\n      if (!_isValidImageFormat(imageBytes)) {\n        debugPrint(\"âŒ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØµÙˆØ±Ø© ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…\");\n        return await _createDefaultMarkerImage(width);\n      }\n\n      // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ù†Ø´Ø§Ø¡ Codec Ù…Ø¹ Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…Ø­Ø³Ù†Ø© Ù„Ù„Ø£Ø®Ø·Ø§Ø¡\n      ui.Codec? codec;\n      try {\n        codec = await ui.instantiateImageCodec(imageBytes, targetWidth: width);\n        debugPrint(\"âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ codec Ø¨Ù†Ø¬Ø§Ø­\");\n      } catch (codecError) {\n        debugPrint(\"âŒ ÙØ´Ù„ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ codec: $codecError\");\n        return await _createDefaultMarkerImage(width);\n      }\n\n      // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ø£ÙˆÙ„ Ù…Ù† Ø§Ù„ØµÙˆØ±Ø©\n      ui.FrameInfo? frameInfo;\n      try {\n        frameInfo = await codec.getNextFrame();\n        debugPrint(\"âœ… ØªÙ… Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ frame Ø¨Ù†Ø¬Ø§Ø­\");\n      } catch (frameError) {\n        debugPrint(\"âŒ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ frame: $frameError\");\n        codec.dispose();\n        return await _createDefaultMarkerImage(width);\n      }\n\n      // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¥Ù„Ù‰ ByteData\n      ByteData? byteData;\n      try {\n        byteData = await frameInfo.image.toByteData(\n          format: ui.ImageByteFormat.png,\n        );\n        debugPrint(\"âœ… ØªÙ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¥Ù„Ù‰ ByteData Ø¨Ù†Ø¬Ø§Ø­\");\n      } catch (conversionError) {\n        debugPrint(\"âŒ ÙØ´Ù„ ÙÙŠ ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©: $conversionError\");\n        frameInfo.image.dispose();\n        codec.dispose();\n        return await _createDefaultMarkerImage(width);\n      }\n\n      if (byteData == null) {\n        debugPrint(\"âŒ ÙØ´Ù„ ÙÙŠ ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¥Ù„Ù‰ ByteData\");\n        frameInfo.image.dispose();\n        codec.dispose();\n        return await _createDefaultMarkerImage(width);\n      }\n\n      final Uint8List result = byteData.buffer.asUint8List();\n      debugPrint(\n        \"âœ… ØªÙ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­ØŒ Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${result.length} bytes\",\n      );\n\n      // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø°Ø§ÙƒØ±Ø©\n      frameInfo.image.dispose();\n      codec.dispose();\n\n      return result;\n    } catch (e, stackTrace) {\n      debugPrint(\"âŒ Ø®Ø·Ø£ Ø¹Ø§Ù… ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ù…Ù† $path: $e\");\n      debugPrint(\"ğŸ“ Stack trace: $stackTrace\");\n      return await _createDefaultMarkerImage(width);\n    }\n  }\n\n  /// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØµÙˆØ±Ø©\n  bool _isValidImageFormat(Uint8List bytes) {\n    if (bytes.length < 4) return false;\n\n    // ÙØ­Øµ PNG signature\n    if (bytes[0] == 0x89 &&\n        bytes[1] == 0x50 &&\n        bytes[2] == 0x4E &&\n        bytes[3] == 0x47) {\n      debugPrint(\"âœ… ØªÙ… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ ØªÙ†Ø³ÙŠÙ‚ PNG\");\n      return true;\n    }\n\n    // ÙØ­Øµ JPEG signature\n    if (bytes[0] == 0xFF && bytes[1] == 0xD8) {\n      debugPrint(\"âœ… ØªÙ… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ ØªÙ†Ø³ÙŠÙ‚ JPEG\");\n      return true;\n    }\n\n    // ÙØ­Øµ WebP signature\n    if (bytes.length >= 12 &&\n        bytes[0] == 0x52 &&\n        bytes[1] == 0x49 &&\n        bytes[2] == 0x46 &&\n        bytes[3] == 0x46 &&\n        bytes[8] == 0x57 &&\n        bytes[9] == 0x45 &&\n        bytes[10] == 0x42 &&\n        bytes[11] == 0x50) {\n      debugPrint(\"âœ… ØªÙ… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ ØªÙ†Ø³ÙŠÙ‚ WebP\");\n      return true;\n    }\n\n    debugPrint(\"âŒ ØªÙ†Ø³ÙŠÙ‚ ØµÙˆØ±Ø© ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…\");\n    return false;\n  }\n\n  /// Ø¥Ù†Ø´Ø§Ø¡ ØµÙˆØ±Ø© marker Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø© ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©\n  Future<Uint8List> _createDefaultMarkerImage(int size) async {\n    try {\n      debugPrint(\"ğŸ”„ Ø¥Ù†Ø´Ø§Ø¡ ØµÙˆØ±Ø© marker Ø§ÙØªØ±Ø§Ø¶ÙŠØ©...\");\n\n      // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø·Ø­ Ø±Ø³Ù…\n      final ui.PictureRecorder recorder = ui.PictureRecorder();\n      final Canvas canvas = Canvas(recorder);\n\n      // Ø±Ø³Ù… Ø®Ù„ÙÙŠØ© Ø¨ÙŠØ¶Ø§Ø¡\n      final Paint backgroundPaint =\n          Paint()\n            ..color = Colors.white\n            ..style = PaintingStyle.fill;\n      canvas.drawRect(\n        Rect.fromLTWH(0, 0, size.toDouble(), size.toDouble()),\n        backgroundPaint,\n      );\n\n      // Ø±Ø³Ù… Ø¯Ø§Ø¦Ø±Ø© Ù…Ù„ÙˆÙ†Ø© ÙƒÙ€ marker\n      final Paint circlePaint =\n          Paint()\n            ..color = const Color(0xFF667EEA)\n            ..style = PaintingStyle.fill;\n\n      canvas.drawCircle(Offset(size / 2, size / 2), size / 3, circlePaint);\n\n      // Ø±Ø³Ù… Ù†Ù‚Ø·Ø© Ø¨ÙŠØ¶Ø§Ø¡ ÙÙŠ Ø§Ù„Ù…Ù†ØªØµÙ\n      final Paint centerPaint =\n          Paint()\n            ..color = Colors.white\n            ..style = PaintingStyle.fill;\n\n      canvas.drawCircle(Offset(size / 2, size / 2), size / 6, centerPaint);\n\n      // Ø±Ø³Ù… Ø­Ø¯ÙˆØ¯\n      final Paint borderPaint =\n          Paint()\n            ..color = Colors.grey.shade300\n            ..style = PaintingStyle.stroke\n            ..strokeWidth = 1.0;\n\n      canvas.drawCircle(Offset(size / 2, size / 2), size / 3, borderPaint);\n\n      // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø±Ø³Ù… Ø¥Ù„Ù‰ ØµÙˆØ±Ø©\n      final ui.Picture picture = recorder.endRecording();\n      final ui.Image image = await picture.toImage(size, size);\n      final ByteData? byteData = await image.toByteData(\n        format: ui.ImageByteFormat.png,\n      );\n\n      // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø°Ø§ÙƒØ±Ø©\n      picture.dispose();\n      image.dispose();\n\n      if (byteData != null) {\n        debugPrint(\"âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­\");\n        return byteData.buffer.asUint8List();\n      } else {\n        throw Exception(\"ÙØ´Ù„ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©\");\n      }\n    } catch (e) {\n      debugPrint(\"âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©: $e\");\n\n      // Ø¥Ø±Ø¬Ø§Ø¹ Ø£Ø¨Ø³Ø· marker Ù…Ù…ÙƒÙ† - ØµÙˆØ±Ø© PNG Ø¨Ø³ÙŠØ·Ø© Ù…ÙƒØªÙˆØ¨Ø© ÙŠØ¯ÙˆÙŠØ§Ù‹\n      return _createMinimalMarker();\n    }\n  }\n\n  /// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø¨Ø³Ø· marker Ù…Ù…ÙƒÙ† ÙƒÙ€ fallback Ù†Ù‡Ø§Ø¦ÙŠ\n  Uint8List _createMinimalMarker() {\n    // PNG ØµØºÙŠØ± Ø£Ø­Ù…Ø± Ø¨Ø³ÙŠØ· (16x16 pixels) - Ù…ÙÙˆÙ„Ù‘Ø¯ ÙŠØ¯ÙˆÙŠØ§Ù‹\n    return Uint8List.fromList([\n      0x89,\n      0x50,\n      0x4E,\n      0x47,\n      0x0D,\n      0x0A,\n      0x1A,\n      0x0A,\n      0x00,\n      0x00,\n      0x00,\n      0x0D,\n      0x49,\n      0x48,\n      0x44,\n      0x52,\n      0x00,\n      0x00,\n      0x00,\n      0x10,\n      0x00,\n      0x00,\n      0x00,\n      0x10,\n      0x08,\n      0x02,\n      0x00,\n      0x00,\n      0x00,\n      0x90,\n      0x91,\n      0x68,\n      0x36,\n      0x00,\n      0x00,\n      0x00,\n      0x3C,\n      0x49,\n      0x44,\n      0x41,\n      0x54,\n      0x28,\n      0xCF,\n      0x63,\n      0xF8,\n      0x0F,\n      0x00,\n      0x01,\n      0x01,\n      0x01,\n      0x00,\n      0x18,\n      0xDD,\n      0x8D,\n      0xB4,\n      0x1C,\n      0x00,\n      0x00,\n      0x00,\n      0x00,\n      0x49,\n      0x45,\n      0x4E,\n      0x44,\n      0xAE,\n      0x42,\n      0x60,\n      0x82,\n    ]);\n  }\n\n  /// Ø¯Ø§Ù„Ø© placeholder (Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±) Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…Ù†Ø·Ù‚ Ø¹Ø±Ø¶ Ø£ÙŠÙ‚ÙˆÙ†Ø© (marker) Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©.\n  Future<void> iconMarket() async {\n    // TODO: ØªÙ†ÙÙŠØ° Ù…Ù†Ø·Ù‚ ØªØ­Ø¯ÙŠØ¯ ÙˆØ¹Ø±Ø¶ Marker Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø¥Ø°Ø§ ØªØ·Ù„Ø¨ Ø§Ù„Ø£Ù…Ø±.\n  }\n\n  /// Ø¯Ø§Ù„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨:\n  /// - ØªØªØ­Ù‚Ù‚ Ø£ÙˆÙ„Ø§Ù‹ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„Ø³Ù„Ø©.\n  /// - ØªÙ‚ÙˆÙ… Ø¨ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø© Ø§Ù„Ù…Ø§Ø±ÙƒØ± (Marker) Ù…Ù† Ø§Ù„Ø£ØµÙˆÙ„.\n  /// - ØªØªØ­Ù‚Ù‚ Ù…Ù† ØªÙØ¹ÙŠÙ„ Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØµÙ„Ø§Ø­ÙŠØ§ØªÙ‡.\n  /// - ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù….\n  /// - ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø±Ù…Ø² Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (token) Ù…Ù† Firestore.\n  /// - ØªÙ†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ø´Ø§Ø´Ø© GoogleMapOrder Ù…Ø¹ ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§ØªØŒ Ø§Ù„Ù…Ø§Ø±ÙƒØ±ØŒ ÙˆØ±Ù…Ø² Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….\n  Future<void> send() async {\n    try {\n      // Ø¨Ø¯Ø¡ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„\n      isLoading.value = true;\n      update();\n\n      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø§Ø±ÙƒØ± Ù…Ù† Ø§Ù„Ø£ØµÙˆÙ„ (ÙŠØ³ØªØ®Ø¯Ù… ImageX.ImageHome Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹)\n      markerUser = await getBytesFromAsset(ImageX.ImageHome, 60);\n      update();\n\n      // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ù„Ø© Ù…Ù† Firestore (the-chosen)\n      QuerySnapshot chosenSnapshot =\n          await FirebaseFirestore.instance\n              .collection('the-chosen')\n              .doc(FirebaseAuth.instance.currentUser!.uid)\n              .collection(FirebaseX.appName)\n              .get();\n\n      // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¹Ù†Ø§ØµØ± ÙÙŠ Ø§Ù„Ø³Ù„Ø©\n      if (chosenSnapshot.docs.isNotEmpty) {\n        double? longitude;\n        double? latitude;\n\n        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙØ¹ÙŠÙ„ Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù‡Ø§Ø²\n        bool serviceEnabled = await Geolocator.isLocationServiceEnabled();\n        if (!serviceEnabled) {\n          // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ØªÙ†Ø¨ÙŠÙ‡ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…ÙØ¹Ù„Ø©\n          Get.defaultDialog(\n            title: 'Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹',\n            middleText: 'Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªÙØ¹ÙŠÙ„ Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹',\n            textCancel: 'Ø±Ø¬ÙˆØ¹',\n          );\n          isLoading.value = false;\n          update();\n          return;\n        }\n\n        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ø°ÙˆÙ†Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹\n        LocationPermission permission = await Geolocator.checkPermission();\n        if (permission == LocationPermission.denied) {\n          permission = await Geolocator.requestPermission();\n          if (permission == LocationPermission.denied) {\n            Get.defaultDialog(\n              title: 'Ø£Ø°ÙˆÙ†Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹',\n              middleText: 'ØªÙ… Ø±ÙØ¶ Ø£Ø°ÙˆÙ†Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹',\n              textCancel: 'Ø±Ø¬ÙˆØ¹',\n            );\n            isLoading.value = false;\n            update();\n            return;\n          }\n        }\n        if (permission == LocationPermission.deniedForever) {\n          Get.defaultDialog(\n            title: 'Ø£Ø°ÙˆÙ†Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹',\n            middleText:\n                'ØªÙ… Ø±ÙØ¶ Ø£Ø°ÙˆÙ†Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø´ÙƒÙ„ Ø¯Ø§Ø¦Ù…. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª.',\n            textCancel: 'Ø±Ø¬ÙˆØ¹',\n          );\n          isLoading.value = false;\n          update();\n          return;\n        }\n\n        // Ø¬Ù„Ø¨ Ø±Ù…Ø² Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (token) Ù…Ù† Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙÙŠ Firestore\n        DocumentSnapshot tokenSnapshot =\n            await FirebaseFirestore.instance\n                .collection(FirebaseX.collectionApp)\n                .doc(uid)\n                .get();\n\n        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…\n        Position position = await Geolocator.getCurrentPosition();\n        latitude = position.latitude;\n        longitude = position.longitude;\n        update();\n\n        // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø´Ø§Ø´Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ù…Ø¹ ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:\n        // - Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª: latitude Ùˆ longitude\n        // - ØµÙˆØ±Ø© Ø§Ù„Ù…Ø§Ø±ÙƒØ± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…\n        // - Ø±Ù…Ø² Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (token)\n        Get.to(\n          () => GoogleMapOrder(\n            initialLongitude: longitude!,\n            initialLatitude: latitude!,\n            markerIconBytes: markerUser!,\n            tokenUser: tokenSnapshot.get('token'),\n          ),\n        );\n      } else {\n        // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ© (Ø£ÙŠ Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø£ÙŠ Ù…Ù†ØªØ¬)ØŒ ÙŠØªÙ… Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù….\n        Get.defaultDialog(\n          title: \"ØªÙ†Ø¨ÙŠÙ‡\",\n          titleStyle: TextStyle(\n            fontWeight: FontWeight.bold,\n            fontSize: 20,\n            color: Colors.redAccent,\n          ),\n          middleText: \"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù†ØªØ¬ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø£ÙˆÙ„Ø§Ù‹.\",\n          middleTextStyle: TextStyle(fontSize: 16, color: Colors.black87),\n          textCancel: \"Ø±Ø¬ÙˆØ¹\",\n          cancelTextColor: Colors.black54,\n          barrierDismissible: false,\n          radius: 12,\n          backgroundColor: Colors.white,\n          buttonColor: Colors.redAccent,\n          // ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© callback Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø¥Ø°Ø§ Ø±ØºØ¨Øª\n          onCancel: () {\n            // ØªÙ†ÙÙŠØ° Ø£ÙŠ Ø¥Ø¬Ø±Ø§Ø¡ Ø¹Ù†Ø¯ Ø¥Ù„ØºØ§Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡\n          },\n          // ÙŠÙ…ÙƒÙ† Ø£ÙŠØ¶Ø§Ù‹ Ø¥Ø¶Ø§ÙØ© Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø£Ùˆ Ø¹Ù†Ø§ØµØ± Ø¥Ø¶Ø§ÙÙŠØ© Ø¥Ø°Ø§ Ø±ØºØ¨Øª:\n          // titlePadding: EdgeInsets.only(top: 16, bottom: 8),\n          // contentPadding: EdgeInsets.symmetric(horizontal: 16, vertical: 8),\n        );\n      }\n    } catch (e) {\n      // Ø§Ù„ØªÙ‚Ø§Ø· Ø£ÙŠ Ø£Ø®Ø·Ø§Ø¡ ØªØ­Ø¯Ø« Ø£Ø«Ù†Ø§Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ ÙˆØ¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ØªÙ†Ø¨ÙŠÙ‡ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…\n      Get.snackbar(\n        'Ø­Ø¯Ø« Ø®Ø·Ø£',\n        'ØªØ¹Ø°Ø± Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.\\nØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£: $e',\n        icon: const Icon(Icons.error_outline, color: Colors.white),\n        backgroundColor: Colors.red.shade700,\n        colorText: Colors.white,\n        snackPosition: SnackPosition.BOTTOM,\n        margin: const EdgeInsets.all(16),\n        borderRadius: 10,\n        duration: const Duration(seconds: 4),\n      );\n    } finally {\n      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©\n      isLoading.value = false;\n      update();\n    }\n  }\n}\n"
        }
    ]
}